<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="mobile-web-app-capable" content="yes">  
<meta name="apple-mobile-web-app-capable" content="yes"> 
<meta name="theme-color" content="#000000"> 
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<link rel="icon" href="https://file.garden/aWe99vhwaGcNwkok/%E8%B3%AD%E5%A0%B4/item_1%20(1).png" type="image/png">
<title>Rabbit Casino - Soul & Skill Edition</title>
<style>
    @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Noto+Serif+TC:wght@400;700&display=swap');

    /* --- æ ¸å¿ƒè®Šæ•¸ --- */
    :root {
        --bg: #050505;
        --gold: #d4af37;
        --gold-glow: rgba(212, 175, 55, 0.6);
        --red: #c0392b;
        --uno-red: #ff5555;
        --uno-yellow: #ffaa00;
        --uno-green: #55aa55;
        --uno-blue: #5555ff;
        --card-bg: #1a1a1a;
    }

    * { box-sizing: border-box; user-select: none; -webkit-tap-highlight-color: transparent; -webkit-touch-callout: none; }

    body {
        margin: 0; padding: 0;
        background: linear-gradient(to bottom, #000000 0%, #1a0000 60%, #3a0000 100%);
        color: #eee;
        font-family: 'Noto Serif TC', serif;
        height: 100vh; width: 100vw;
        overflow: hidden;
        display: flex; flex-direction: column;
    }

    /* --- UNO æŒ‰éˆ• --- */
    .fixed-uno-btn {
        position: absolute; right: 20px; bottom: 280px;
        width: 60px; height: 60px;
        background: radial-gradient(circle, #ff3333 0%, #990000 100%);
        border: 3px solid #fff; border-radius: 50%;
        color: white; font-family: 'Cinzel', serif; font-weight: bold; font-size: 1rem;
        display: none; align-items: center; justify-content: center;
        cursor: pointer; z-index: 50;
        box-shadow: 0 5px 15px rgba(0,0,0,0.5);
        transition: all 0.3s ease; animation: pulseBtn 2s infinite;
    }
    .fixed-uno-btn:active { transform: scale(0.9); }
    .fixed-uno-btn.said {
        background: radial-gradient(circle, #55aa55 0%, #006600 100%);
        box-shadow: 0 0 10px #0f0; border-color: #ccc;
        animation: none; transform: scale(0.9); cursor: default;
    }
    @keyframes pulseBtn { 0%{box-shadow: 0 0 5px #f00;} 50%{box-shadow: 0 0 20px #f00;} 100%{box-shadow: 0 0 5px #f00;} }
    
    /* ç©å®¶è‡ªå·±çš„ UNO æ¨™è¨˜ */
    .player-uno-badge { 
        position: absolute; bottom: 140px; right: 20px; width: 40px; height: 40px; font-size: 0.8rem; 
        background: radial-gradient(circle, #ff0000 0%, #800000 100%); color: white; border-radius: 50%; 
        border: 2px solid #fff; display: none; align-items: center; justify-content: center; 
        font-weight: 900; font-family: 'Cinzel'; z-index: 25; box-shadow: 0 0 10px red; 
    }
    .player-uno-badge.show { display: flex; animation: pulseBadge 1s infinite alternate; }

    /* --- HUD --- */
    #hud {
        position: fixed; top: 0; left: 0; width: 100%; height: 60px;
        display: flex; justify-content: space-between; align-items: center;
        padding: 0 15px; z-index: 500;
        background: linear-gradient(to bottom, rgba(0,0,0,0.95), transparent);
        pointer-events: none;
    }
    .hud-btn { pointer-events: auto; background: rgba(0,0,0,0.6); border: 1px solid var(--gold); color: var(--gold); width: 36px; height: 36px; border-radius: 50%; display: flex; justify-content: center; align-items: center; cursor: pointer; transition: 0.3s; }
    .score-board { font-family: 'Cinzel'; color: var(--gold); font-size: 1.1rem; background: #000; padding: 5px 15px; border-radius: 20px; border: 1px solid #444; box-shadow: 0 0 10px rgba(212,175,55,0.2); pointer-events: auto; cursor: pointer; }

    /* --- Screens --- */
    .screen { position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: none; flex-direction: column; z-index: 10; padding-top: 60px; }
    .screen.active { display: flex; animation: fadeIn 0.3s; }
    .menu-content { flex: 1; padding: 20px; overflow-y: auto; text-align: center; padding-bottom: 80px; }
    .brand { font-family: 'Cinzel'; font-size: 2rem; color: var(--gold); text-shadow: 0 0 15px var(--gold); margin-bottom: 20px; }
    
    .game-card { background: linear-gradient(135deg, #1a0a0a, #000); border: 1px solid #333; border-left: 4px solid #555; padding: 20px; margin-bottom: 15px; cursor: pointer; transition: 0.2s; text-align: left; position: relative; }
    .game-card:active { transform: scale(0.98); border-color: var(--gold); }
    .game-name { font-family: 'Cinzel'; font-size: 1.2rem; color: #eee; }
    .game-desc { font-size: 0.8rem; color: #888; margin-top: 5px; }

    /* --- Lobby --- */
    .char-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-top: 20px; padding-bottom: 40px; }
    .char-item { display: flex; flex-direction: column; align-items: center; opacity: 0.5; transition: 0.2s; cursor: pointer; border: 2px solid transparent; border-radius: 8px; padding: 5px; position: relative; }
    .char-item.selected { opacity: 1; transform: scale(1.05); background: rgba(212, 175, 55, 0.1); border-color: var(--gold); }
    .char-avatar { width: 56px; height: 56px; border-radius: 50%; object-fit: cover; border: 2px solid #333; background: #000; pointer-events: none; }
    .char-item.selected .char-avatar { border-color: var(--gold); box-shadow: 0 0 10px var(--gold); }
    .char-name { font-size: 0.6rem; color: #aaa; margin-top: 4px; text-align: center; white-space: nowrap; overflow: hidden; width: 100%; pointer-events: none;}
    .lobby-btn { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); width: 90%; max-width: 400px; padding: 15px; background: var(--gold); border: none; font-family: 'Cinzel'; font-weight: bold; font-size: 1.1rem; cursor: pointer; box-shadow: 0 0 15px var(--gold-glow); z-index: 100; }
    .lobby-btn:disabled { background: #333; color: #666; box-shadow: none; }
    .lobby-opt-container { margin-top: 20px; padding: 15px; background: #111; border: 1px solid #333; border-radius: 8px; text-align: left; margin-bottom: 60px;}
    .toggle-switch { display: flex; align-items: center; cursor: pointer; margin-top: 10px; margin-bottom: 10px; justify-content: space-between;}
    .toggle-switch input { display: none; }
    .slider { width: 40px; height: 20px; background: #333; border-radius: 20px; position: relative; transition: 0.3s; margin-left: 10px; flex-shrink: 0;}
    .slider::before { content: ''; position: absolute; width: 16px; height: 16px; background: #888; border-radius: 50%; top: 2px; left: 2px; transition: 0.3s; }
    input:checked + .slider { background: var(--gold); }
    input:checked + .slider::before { transform: translateX(20px); background: #fff; }

    /* --- Skill Modal --- */
    .skill-modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 3000; display: none; align-items: center; justify-content: center; opacity: 0; transition: opacity 0.2s; }
    .skill-modal-overlay.show { display: flex; opacity: 1; pointer-events: auto; }
    .skill-card { width: 90%; max-width: 340px; background: linear-gradient(145deg, #150505, #0a0a0a); border: 2px solid var(--gold); border-radius: 16px; padding: 25px; text-align: center; box-shadow: 0 0 50px rgba(212,175,55,0.2); transform: scale(0.95); transition: transform 0.2s; display: flex; flex-direction: column; align-items: center; max-height: 85vh; overflow-y: auto; }
    .skill-modal-overlay.show .skill-card { transform: scale(1); }
    .skill-char-img-lg { width: 80px; height: 80px; border-radius: 50%; border: 3px solid var(--gold); object-fit: cover; margin-bottom: 15px; box-shadow: 0 0 20px var(--gold-glow); background: #000; }
    .skill-char-name-lg { font-family: 'Cinzel'; font-size: 1.5rem; color: var(--gold); margin-bottom: 10px; font-weight: bold; text-shadow: 0 2px 5px #000; }
    .skill-section { margin-top: 10px; width: 100%; text-align: left; background: rgba(255,255,255,0.03); padding: 12px; border-radius: 8px; border-left: 3px solid var(--gold); }
    .skill-title { font-size: 0.8rem; color: #888; font-weight: bold; margin-bottom: 4px; display: flex; justify-content: space-between; align-items: center;}
    .skill-name { font-size: 1rem; color: #fff; font-weight: bold; margin-bottom: 5px; }
    .skill-desc { font-size: 0.85rem; color: #ccc; line-height: 1.5; font-family: 'Noto Serif TC'; }
    .skill-tag { background: #333; color: #aaa; padding: 2px 6px; border-radius: 4px; font-size: 0.6rem; }
    .skill-cp-section { border-left-color: #ff55aa; background: rgba(255, 85, 170, 0.05); margin-top: 10px; }
    .skill-cp-section .skill-title { color: #ff55aa; }

    /* --- Skill Toast --- */
    .skill-toast { position: absolute; top: 30%; left: 50%; transform: translateX(-50%); z-index: 2000; display: flex; align-items: center; gap: 12px; background: linear-gradient(90deg, rgba(0,0,0,0.9), rgba(25,25,25,0.95)); border: 1px solid var(--gold); border-left: 4px solid var(--gold); border-radius: 50px; padding: 6px 20px 6px 6px; box-shadow: 0 5px 20px rgba(0,0,0,0.8), 0 0 10px rgba(212, 175, 55, 0.3); opacity: 0; pointer-events: none; transition: all 0.3s ease; max-width: 90%; white-space: nowrap; }
    .skill-toast.show { animation: skillSlideIn 2.8s cubic-bezier(0.22, 1, 0.36, 1) forwards; }
    @keyframes skillSlideIn { 0% { opacity: 0; transform: translate(-50%, -30px) scale(0.9); } 15% { opacity: 1; transform: translate(-50%, 0) scale(1); } 85% { opacity: 1; transform: translate(-50%, 0) scale(1); } 100% { opacity: 0; transform: translate(-50%, -20px) scale(0.95); } }
    .st-avatar { width: 42px; height: 42px; border-radius: 50%; border: 2px solid var(--gold); object-fit: cover; background: #000; box-shadow: 0 0 5px var(--gold-glow); }
    .st-content { display: flex; flex-direction: column; align-items: flex-start; justify-content: center; }
    .st-title { font-family: 'Cinzel'; color: var(--gold); font-size: 1rem; font-weight: bold; margin: 0; }
    .st-user { color: #ddd; font-size: 0.9rem; margin: 0; font-family: 'Noto Serif TC'; }

    /* --- Game Area --- */
    .game-area { flex: 1; display: flex; flex-direction: column; position: relative; }
    .status-bar { text-align: center; font-family: 'Cinzel'; font-size: 0.9rem; color: #aaa; padding: 5px; background: rgba(0,0,0,0.5); min-height: 30px; margin-top: 10px; }
    .opponents-row { height: 170px; position: relative; width: 100%; margin-top: 50px; }
    .seat { position: absolute; width: 80px; display: flex; flex-direction: column; align-items: center; transition: 0.1s; cursor: pointer; -webkit-tap-highlight-color: transparent;}
    .seat:active { transform: scale(0.95); }
    .seat[data-pos="0"] { left: 15px; top: 30px; }
    .seat[data-pos="1"] { left: 50%; transform: translateX(-50%); top: 0px; }
    .seat[data-pos="2"] { right: 15px; top: 30px; }
    .op-avatar { width: 56px; height: 56px; border-radius: 50%; border: 2px solid #444; object-fit: cover; background: #000; z-index: 10; transition: 0.2s; }
    .seat.active .op-avatar { border-color: var(--gold); box-shadow: 0 0 15px var(--gold); transform: scale(1.1); }
    .seat.shake .op-avatar { animation: shake 0.4s ease-in-out; }
    @keyframes shake { 0%, 100% {transform: translateX(0);} 25% {transform: translateX(-5px);} 75% {transform: translateX(5px);} }
    .bubble { position: absolute; top: 65px; background: #fff; color: #000; padding: 6px 10px; border-radius: 12px; font-size: 0.75rem; font-weight: bold; min-width: 90px; text-align: center; opacity: 0; pointer-events: none; transition: 0.3s; z-index: 100; box-shadow: 0 4px 10px rgba(0,0,0,0.8); white-space: normal; line-height: 1.2; }
    .bubble::after { content: ''; position: absolute; top: -5px; left: 50%; transform: translateX(-50%); border-width: 0 5px 5px 5px; border-style: solid; border-color: transparent transparent #fff transparent; }
    .bubble.show { opacity: 1; transform: translateY(5px); }
    .catch-effect { position: absolute; top: 20px; left: 50%; transform: translateX(-50%); color: #f00; font-weight: 900; font-size: 1.2rem; text-shadow: 0 0 5px #fff; animation: popUp 1s forwards; z-index: 200; pointer-events: none;}
    @keyframes popUp { 0% { opacity:0; transform:translate(-50%, 10px); } 20% { opacity:1; transform:translate(-50%, -20px) scale(1.5); } 100% { opacity:0; transform:translate(-50%, -50px); } }

    .table-center { flex: 1; position: relative; display: flex; justify-content: center; align-items: center; flex-direction: column; }
    .msg-large { position: absolute; font-family: 'Cinzel'; font-size: 2rem; color: var(--gold); text-shadow: 0 0 20px #000; pointer-events: none; opacity: 0; transition: 0.3s; z-index: 100; background: rgba(0,0,0,0.8); padding: 10px 30px; border: 1px solid var(--gold); text-align: center;}
    .msg-large.show { opacity: 1; transform: scale(1.1); }
    .player-area { background: linear-gradient(to top, #000 90%, transparent); padding-bottom: 20px; display: flex; flex-direction: column; justify-content: flex-end; position: relative; }
    .controls { display: flex; justify-content: center; gap: 10px; margin-bottom: 10px; height: 45px; z-index: 20; flex-wrap: wrap;}
    .btn-act { background: var(--gold); color: #000; border: none; padding: 0 20px; font-family: 'Cinzel'; font-weight: bold; border-radius: 25px; opacity: 0; pointer-events: none; transition: 0.3s; box-shadow: 0 0 15px var(--gold-glow); min-width: 80px; }
    .btn-act.show { opacity: 1; pointer-events: auto; }
    .btn-pass { background: #333; color: #ccc; box-shadow: none; border: 1px solid #555; }
    .btn-color { color: #fff; text-shadow: 1px 1px 2px #000; }
    .btn-red { background: var(--uno-red); }
    .btn-yellow { background: var(--uno-yellow); color: #000; text-shadow: none;}
    .btn-green { background: var(--uno-green); }
    .btn-blue { background: var(--uno-blue); }
    .btn-shout { background: #d00; color: #fff; border: 2px solid #fff; box-shadow: 0 0 10px #f00; }

    .my-hand { display: flex; align-items: flex-end; height: 130px; padding: 10px 20px; overflow-x: auto; justify-content: flex-start; -webkit-overflow-scrolling: touch; }
    .my-hand.few-cards { justify-content: center; }
    .card { width: 76px; height: 106px; background: #fff; border-radius: 6px; position: relative; display: flex; flex-direction: column; justify-content: flex-start; align-items: flex-start; padding: 5px; font-family: 'Arial'; font-weight: bold; border: 1px solid #ccc; box-shadow: -2px 0 5px rgba(0,0,0,0.3); flex-shrink: 0; margin-right: -45px; transition: transform 0.2s, margin 0.2s; cursor: pointer; }
    .card.selected { transform: translateY(-25px); border: 2px solid var(--gold); z-index: 100; margin-right: -20px; }
    .card.red { color: var(--red); } .card.black { color: #000; }
    .card.back { background: #1a0505; border: 2px solid #8a7538; background-image: repeating-linear-gradient(45deg, #111 0, #111 2px, #2a0a0a 2px, #2a0a0a 8px); }
    .card.uno { color: #fff; text-shadow: 1px 1px 0 #000; border: 2px solid #fff; }
    .card.uno-red { background: var(--uno-red); }
    .card.uno-yellow { background: var(--uno-yellow); color: #000; text-shadow: none; }
    .card.uno-green { background: var(--uno-green); }
    .card.uno-blue { background: var(--uno-blue); }
    .card.uno-black { background: #222; border: 2px solid var(--gold); background-image: linear-gradient(135deg, transparent 45%, var(--gold) 50%, transparent 55%); }
    .card-center-suit { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 2.5rem; opacity: 0.2; pointer-events: none; }
    .card-center-uno { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 2rem; font-weight: 900; font-family: 'Cinzel'; width: 100%; text-align: center;}
    .uno-corner { position: absolute; top: 5px; left: 5px; font-size: 0.8rem; }
    .card-corner { display: flex; flex-direction: column; align-items: center; line-height: 1; font-size: 1.2rem; }

    /* UNO Specifics */
    .mini-hand-container { display: flex; justify-content: center; margin-top: -15px; height: 20px; width: 100%; z-index: 15; position: relative; }
    .mini-card { width: 14px; height: 20px; background: #8a0303; border: 1px solid #fff; border-radius: 2px; margin-left: -8px; box-shadow: 1px 1px 2px #000; }
    .mini-card:first-child { margin-left: 0; }
    .mini-card.uno-back { background: #000; border: 1px solid #fff; background-image: radial-gradient(circle, #f00 10%, transparent 10%), radial-gradient(circle, #ff0 10%, transparent 10%); background-size: 10px 10px; background-position: 0 0, 5px 5px; }
    .uno-badge { position: absolute; top: -10px; right: -5px; width: 28px; height: 28px; background: radial-gradient(circle, #ff0000 0%, #800000 100%); color: white; border-radius: 50%; border: 2px solid #fff; display: none; align-items: center; justify-content: center; font-weight: 900; font-family: 'Cinzel'; font-size: 0.6rem; z-index: 25; box-shadow: 0 0 10px red; animation: pulseBadge 1s infinite alternate; }
    .uno-badge.show { display: flex; }
    
    /* Modals */
    .result-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 1000; display: none; flex-direction: column; align-items: center; justify-content: center; animation: fadeIn 0.5s; }
    .res-title { font-family: 'Cinzel'; font-size: 3rem; color: var(--gold); margin-bottom: 10px; }
    .res-val { font-size: 1.2rem; color: #fff; margin-bottom: 40px; font-family: 'Arial'; text-align: center; line-height: 1.5; padding: 0 20px;}
    .res-btns { display: flex; gap: 20px; }
    .btn-res { padding: 10px 30px; border: 1px solid var(--gold); background: transparent; color: var(--gold); font-family: 'Cinzel'; cursor: pointer; }
    .btn-res:hover { background: var(--gold); color: #000; }
    
    /* Loan UI */
    .loan-list { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; max-height: 60vh; overflow-y: auto; padding: 10px; width: 100%; }
    .loan-item { background: linear-gradient(135deg, #111, #1a1a1a); border: 1px solid #444; border-radius: 8px; padding: 15px; display: flex; flex-direction: column; align-items: center; cursor: pointer; transition: 0.2s; position: relative; }
    .loan-item:active { transform: scale(0.98); }
    .loan-item:hover { border-color: var(--gold); box-shadow: 0 0 10px rgba(212,175,55,0.2); }
    .loan-avatar-sm { width: 60px; height: 60px; border-radius: 50%; border: 2px solid #666; object-fit: cover; margin-bottom: 8px; background: #000; }
    .loan-info { text-align: center; }
    .loan-name { color: #eee; font-size: 0.9rem; font-family: 'Cinzel'; }
    .loan-hint { font-size: 0.7rem; color: #666; margin-top: 4px; }
    .loan-dialogue { background: linear-gradient(135deg, #222, #000); border: 2px solid var(--gold); padding: 30px; border-radius: 12px; max-width: 90%; width: 400px; text-align: center; box-shadow: 0 0 40px rgba(0,0,0,0.9); display: flex; flex-direction: column; align-items: center; }
    .loan-opt { margin-top: 15px; padding: 12px 20px; background: #333; color: #fff; cursor: pointer; border-radius: 6px; width: 100%; border: 1px solid #555; transition: 0.2s; font-family: 'Noto Serif TC'; }
    .loan-opt:hover { background: var(--gold); color: #000; border-color: #fff; }

    /* Badges */
    .count-badge { position: absolute; bottom: -5px; right: 0; z-index: 20; background: #000; border: 1px solid var(--gold); color: #fff; font-family: 'Cinzel'; font-size: 0.8rem; padding: 1px 6px; border-radius: 10px; }
    .dealer-score { position: absolute; top: 0; left: -15px; z-index: 20; background: #a00; color: #fff; border: 1px solid #f00; font-family: 'Cinzel'; font-size: 0.8rem; padding: 2px 6px; border-radius: 4px; display: none; box-shadow: 0 0 5px #f00; }
    .bj-score-badge { position: absolute; top: -30px; left: 50%; transform: translateX(-50%); background: #000; border: 1px solid var(--gold); color: var(--gold); padding: 5px 15px; border-radius: 15px; font-family: 'Cinzel'; font-weight: bold; box-shadow: 0 0 10px var(--gold-glow); display: none; }

    /* Dou Di Zhu Specifics */
    .role-badge { position: absolute; top: -10px; left: -10px; width: 24px; height: 24px; border-radius: 50%; border: 1px solid #fff; display: none; justify-content: center; align-items: center; font-size: 0.7rem; font-weight: bold; z-index: 30; font-family: 'Cinzel'; }
    .role-badge.show { display: flex; animation: popUp 0.3s; }
    .role-landlord { background: #ffcc00; color: #000; box-shadow: 0 0 10px #ffcc00; }
    .role-peasant { background: #55aa55; color: #fff; box-shadow: 0 0 5px #0f0; }
    
    .kitty-container { position: absolute; top: 15px; left: 50%; transform: translateX(-50%); display: flex; gap: 5px; z-index: 40; display: none; }
    .kitty-card { width: 30px; height: 42px; background: #fff; border-radius: 3px; border: 1px solid #999; display: flex; justify-content: center; align-items: center; font-weight: bold; font-size: 0.8rem; box-shadow: 0 2px 5px rgba(0,0,0,0.5); }

    @keyframes fadeIn { from {opacity:0} to {opacity:1} }
    @keyframes pulseBadge { from{box-shadow: 0 0 5px red;} to{box-shadow: 0 0 15px red, 0 0 5px orange;} }
</style>
</head>
<body onclick="ensureAudio()">

<audio id="bgm" loop><source src="https://file.garden/aWe99vhwaGcNwkok/%E8%B3%AD%E5%A0%B4/231.%20Jazz.mp3" type="audio/mpeg"></audio>
<audio id="sfx-card" src="https://file.garden/aWe99vhwaGcNwkok/%E8%B3%AD%E5%A0%B4/%E3%82%AB%E3%83%BC%E3%83%89%E3%82%92%E3%82%81%E3%81%8F%E3%82%8B.mp3"></audio>
<audio id="sfx-win" src="https://file.garden/aWe99vhwaGcNwkok/%E8%B3%AD%E5%A0%B4/%E3%81%8A%E9%87%91%E3%82%92%E8%90%BD%E3%81%A8%E3%81%991.mp3"></audio>

<div id="hud">
    <div style="display:flex; gap:10px; align-items:center;">
        <div class="hud-btn" id="btn-music" onclick="toggleMusic(event)">â™«</div>
        <div class="hud-btn" id="btn-sfx" onclick="toggleSFX(event)">ğŸ”Š</div>
    </div>
    
    <div class="score-board" onclick="openLoanScreen()">â™¦ <span id="ui-score">10,000</span> <span style="font-size:0.8rem;color:#888">(å€Ÿæ¬¾)</span></div>
    <div class="hud-btn" onclick="goHome()">âŒ‚</div>
</div>

<div id="skill-modal-overlay" class="skill-modal-overlay" onclick="closeSkillModal()">
    <div class="skill-card" onclick="event.stopPropagation()">
        <img id="skill-char-img" class="skill-char-img-lg" src="">
        <div id="skill-char-name" class="skill-char-name-lg"></div>
        <div id="skill-content-area" style="width:100%"></div>
        <div style="font-size:0.7rem; color:#666; margin-top:15px; cursor:pointer" onclick="closeSkillModal()">TAP TO CLOSE</div>
    </div>
</div>

<div id="screen-menu" class="screen active">
    <div class="menu-content">
        <div class="brand">ALICE CASINO</div>
        <div style="display:flex; justify-content:center; gap:20px; margin-bottom:20px">
            <div style="text-align:center"><div style="font-size:1.5rem" id="stat-wins">0</div><div style="font-size:0.7rem;color:#888">WINS</div></div>
            <div style="text-align:center"><div style="font-size:1.5rem" id="stat-losses">0</div><div style="font-size:0.7rem;color:#888">LOSSES</div></div>
        </div>
        <div class="game-card" onclick="goToLobby('uno')"><div class="game-name" style="color:var(--gold)">RABBIT UNO</div><div class="game-desc">4 äººå±€ | å‹æƒ…ç ´å£è€… | <span style="color:#aaf">å« CP æŠ€</span></div></div>
        <div class="game-card" onclick="goToLobby('bigtwo')"><div class="game-name">BIG TWO</div><div class="game-desc">4 äººå±€ | å¤§è€äºŒ | <span style="color:#aaf">å« CP æŠ€</span></div></div>
        <div class="game-card" onclick="goToLobby('doudizhu')"><div class="game-name" style="color:#ffaa00">FIGHT LANDLORD</div><div class="game-desc">3 äººå±€ | é¬¥åœ°ä¸» | <span style="color:#aaf">é™£ç‡Ÿæˆ°</span></div></div>
        <div class="game-card" onclick="goToLobby('redblack')"><div class="game-name">RED or BLACK</div><div class="game-desc">1 å°æ‰‹ | é‹æ°£åšå¼ˆ</div></div>
        <div class="game-card" onclick="goToLobby('blackjack')"><div class="game-name">BLACKJACK</div><div class="game-desc">1 å°æ‰‹ | 21 é»</div></div>
        <div class="game-card" onclick="goToLobby('oldmaid')"><div class="game-name">OLD MAID</div><div class="game-desc">4 äººå±€ | æŠ½é¬¼ç‰Œ</div></div>
    </div>
</div>

<div id="screen-lobby" class="screen">
    <div class="menu-content">
        <h2 style="color:var(--gold); font-family:'Cinzel'">GUEST LIST</h2>
        <div id="lobby-hint" style="font-size:0.8rem; color:#888">é•·æŒ‰é ­åƒæŸ¥çœ‹æŠ€èƒ½ / é¸æ“‡å°æ‰‹</div>
        <div class="char-grid" id="char-grid"></div>
        <div class="lobby-opt-container" id="lobby-uno-opt" style="display:none">
            <label class="toggle-switch"><span style="color:#fff;font-size:0.9rem">ç„¡é™æŠ½ç‰Œ</span><input type="checkbox" id="uno-inf-mode"><span class="slider"></span></label>
            <label class="toggle-switch"><span style="color:#fff;font-size:0.9rem">ç˜‹ç‹‚ç–ŠåŠ  (+2/+4)</span><input type="checkbox" id="uno-stack-mode"><span class="slider"></span></label>
        </div>
        <button class="lobby-btn" id="btn-start" disabled onclick="initGame()">START GAME</button>
    </div>
</div>

<div id="screen-loan" class="screen">
    <div class="menu-content">
        <h2 style="color:var(--gold)">BANK</h2>
        <p style="color:#888; font-size:0.8rem">é¸æ“‡å°è±¡é€²è¡Œå€Ÿæ¬¾å”å•†</p>
        <div class="loan-list" id="loan-list"></div>
        <button class="lobby-btn" style="position:relative; margin-top:20px;" onclick="switchScreen('screen-menu')">BACK</button>
    </div>
</div>

<div id="screen-game" class="screen">
    <div class="status-bar" id="status-bar">GAME START</div>
    <div class="game-area">
        <div class="skill-toast" id="skill-toast"></div>
        <div class="opponents-row" id="seat-container"></div>
        <div class="table-center">
            <div class="kitty-container" id="ddz-kitty"></div>
            <div class="msg-large" id="msg-large">START</div>
            <div id="table-cards" style="display:flex; justify-content:center; gap:5px; flex-wrap:wrap"></div>
        </div>
        <div class="player-area">
            <div class="fixed-uno-btn" onclick="userShoutUno()">UNO!</div>
            <div class="player-uno-badge" id="player-badge">UNO</div>
            <div class="bj-score-badge" id="bj-score">0</div>
            <div class="controls" id="controls"></div>
            <div class="my-hand" id="player-hand"></div>
        </div>
    </div>
</div>

<div id="modal-result" class="result-modal">
    <div class="res-title" id="res-title">VICTORY</div>
    <div class="res-val" id="res-msg">Info</div>
    <div class="res-btns">
        <button class="btn-res" onclick="goHome()">MENU</button>
        <button class="btn-res" onclick="initGame()">REPLAY</button>
    </div>
</div>

<div id="modal-loan" class="result-modal">
    <div class="loan-dialogue">
        <img id="loan-avatar" style="width:80px;height:80px;border-radius:50%;border:2px solid var(--gold);margin-bottom:10px">
        <div id="loan-text" style="color:#fff;margin-bottom:20px;font-style:italic">"..."</div>
        <div id="loan-options" style="width:100%"></div>
    </div>
</div>
<script>
/* --- 1. CHARACTER DATA & CONFIG --- */
const CHARS = [
    { 
        id: 'venato', name: 'ç¶­ç´æ‰˜', img: 'https://file.garden/aWe99vhwaGcNwkok/%E7%A0%B4%E9%A0%AD/%E7%B6%AD%E7%B4%8D%E6%89%98.png', 
        uno_shout_rate: 0.95, uno_catch_rate: 0.95, cp_id: 'narcissus',
        skills: {
            uno: { name: "è®Šé‡è¨ˆç®—", desc: "è¢« +4 æ”»æ“Šæ™‚ï¼Œæœ‰ 30% æ©Ÿç‡ç›´æ¥å°‡å‚·å®³åå½ˆçµ¦ä¸‹å®¶ã€‚" },
            bigtwo: { name: "å…ˆç™¼åˆ¶äºº", desc: "é–‹å±€å¿…å®šæŒæœ‰æ¢…èŠ± 3ï¼Œäº«æœ‰å„ªå…ˆå‡ºç‰Œæ¬Šã€‚" },
            doudizhu: { name: "ç²¾ç®—æ¶åœ°ä¸»", desc: "è‹¥åº•ç‰Œæœ‰å¤§ç‰Œ (Jä»¥ä¸Š)ï¼Œæ¶åœ°ä¸»æ©Ÿç‡å¤§å¹…æå‡ï¼›æ“”ä»»åœ°ä¸»æ™‚ï¼Œé–‹å±€æ‰‹ç‰Œå¿…æœ‰ 2ã€‚" }
        },
        cp_skill: { 
            uno: { name: "çµ•å°å…¬å¼", desc: "ç•¶ç´è¥¿ç‘Ÿæ–¯æ‰“å‡ºé¡è‰²ç‰Œæ™‚ï¼Œç¶­ç´æ‰˜æœ‰æ©Ÿç‡è·Ÿè‘—æ‰“å‡ºä¸€å¼µåŒè‰²ç‰Œã€‚" },
            bigtwo: { name: "ç‹æ¬Šé€£å‹•", desc: "ç•¶ç´è¥¿ç‘Ÿæ–¯æ‰“å‡º Pair æˆ– Three æ™‚ï¼Œç¶­ç´æ‰˜æœƒå˜—è©¦å¹«å¿™å£“åˆ¶ä¸‹å®¶ã€‚" },
            doudizhu: { name: "å…¬å¼æœ€å„ªè§£", desc: "è‹¥èˆ‡ç´è¥¿ç‘Ÿæ–¯åŒç‚ºè¾²æ°‘ï¼Œç¶­ç´æ‰˜æœƒå„ªå…ˆå‡ºç´è¥¿ç‘Ÿæ–¯ç¼ºå°‘çš„ç‰Œå‹ä¾†ã€é¤µç‰Œã€ã€‚" }
        },
        lines: { 
            start: ["æ ¹æ“šæµé«”åŠ›å­¸ï¼Œé€™å±€æˆ‘è´å®šäº†ã€‚", "æœ¬å¤©æ‰æ˜¯ç„¡æ•µçš„ã€‚", "ä½ å€‘çš„å‹ç‡ç‚ºé›¶ã€‚"], 
            play: ["æœ€å„ªè§£ã€‚", "æ©Ÿç‡åœ¨æŒæ¡ä¸­ã€‚", "éƒ½åœ¨å…¬å¼å…§ã€‚"], 
            win: ["è®šç¾æœ¬ç‹ï¼", "é€™å°±æ˜¯æ™ºå•†çš„å·®è·ã€‚"], 
            lose: ["å…¬å¼...å“ªè£¡éŒ¯äº†ï¼Ÿ", "é€™ä¸ç§‘å­¸ï¼", "ä¸€å®šæ˜¯è®Šé‡å‡ºäº†å•é¡Œ..."], 
            uno_attack: ["çµ¦ä½ ä¸€é»ã€è®Šé‡ã€ã€‚", "ç ´å£ä½ çš„çµæ§‹ã€‚"], uno_hit: ["ä»€éº¼ï¼Ÿï¼", "æ•¸æ“šæº¢å‡ºäº†ï¼"], uno_uno: ["è½ç‰Œã€‚é¢¤æŠ–å§ã€‚", "å°‡è»ã€‚"], 
            uno_catch: ["æŠ“åˆ°äº†ï¼ä½ æ¼äº†ä¸€å€‹æ­¥é©Ÿã€‚", "å¤ªä¸åš´è¬¹äº†ï¼", "é•åè¦å‰‡ï¼Œæ‰£åˆ†ã€‚"], 
            uno_forgot: ["å˜–...å¾®å°çš„è¨ˆç®—å¤±èª¤...", "ç«Ÿç„¶...", "å¤§è…¦éç†±äº†..."], 
            uno_late: ["å•Šï¼UNOï¼æ²’æƒ³åˆ°å§ï¼", "ä¿®æ­£è®Šé‡ï¼šUNOï¼"],
            uno_skip: ["æš«åœé‹ç®—ï¼Ÿä¹Ÿå¥½ã€‚", "è§€å¯Ÿå±€å‹¢ã€‚", "è®“æˆ‘é‡æ–°å»ºæ¨¡ã€‚"],
            uno_draw_many: ["æ‰‹ç‰Œå¤ªå¤šï¼Œé›£ä»¥è¨ˆç®—...", "æ•¸æ“šé‡éå¤§ï¼"],
            uno_stack: ["é€™å€‹è®Šé‡é‚„çµ¦ä½ ï¼", "ç–ŠåŠ æ…‹ï¼", "åæ“Šï¼"],
uno_poke_early: ["åˆ¥ç¢°æœ¬ç‹ï¼ç®—å¼æœƒäº‚æ‰ï¼", "æ€éº¼äº†ï¼Ÿé‚„æ²’åˆ°æ™‚å€™ã€‚", "ä½ æƒ³å°æœ¬ç‹åšä»€éº¼ï¼Ÿ"],
            uno_poke_late: ["æœ¬ç‹å·²ç¶“å–Šäº†ï¼Œä½ æ…¢äº†ã€‚", "æƒ³æŠ“æœ¬ç‹ï¼Ÿä¸‹è¼©å­å§ã€‚", "å¤ªæ…¢äº†ï¼"],
            doudizhu_bid: ["é€™å‰¯ç‰Œçš„æœŸæœ›å€¼å¾ˆé«˜ï¼Œä¸‰åˆ†ã€‚", "å«åœ°ä¸»ï¼"], 
            // åˆªé™¤é‡è¤‡çš„ï¼Œåªä¿ç•™é€™ä¸€çµ„æ–°çš„
            doudizhu_pass: ["æœŸæœ›å€¼ç‚ºè² ï¼Œéã€‚", "ä¸åœ¨æœ€å„ªè§£è·¯å¾‘ä¸Šã€‚", "æˆ°ç•¥æ€§ä¿ç•™è³‡æºã€‚", "è®“ä½ ä¸€æ‰‹åˆä½•å¦¨ï¼Ÿ"],
            loan_reject: ["æœ¬ç‹å¸Œæœ›ä½ èª å¯¦ä¸€é»ã€‚", "æœ¬ç‹å’Œä½ ä¸ç†Ÿå§ï¼Ÿ", "æœ¬ç‹è¦ºå¾—ä½ åœ¨é¨™æˆ‘ï¼"]
        },
        loanStages: [ { text: "å€ŸéŒ¢ï¼Ÿæˆ‘çš„è¨ˆç®—ä¸­æ²’æœ‰é€™å€‹è®Šé‡ã€‚", opts: [{t:"ç‚ºäº†é©—è­‰æ··æ²Œç†è«–ã€‚", next:1}, {t:"å¤§å®¶éƒ½æ˜¯æœ‹å‹å˜›ã€‚", next:-1}] }, { text: "æ··æ²Œç†è«–ï¼Ÿä½ æ˜¯èªªæ©Ÿç‡çš„ä¸å¯é æ¸¬æ€§ï¼Ÿæœ‰è¶£ã€‚", opts: [{t:"æ²’éŒ¯ï¼Œé€™æ˜¯å¯¦é©—ç¶“è²»ã€‚", next:-1}, {t:"æˆ‘å°±æƒ³è³­ä¸€æŠŠã€‚", next:2}] }, { text: "å¥½å§ï¼Œæœ¬ç‹çœ‹åœ¨ä½ èª å¯¦çš„ä»½ä¸Šã€‚", reward: 3000 } ]
    },
    { 
        id: 'narcissus', name: 'ç´è¥¿ç‘Ÿæ–¯', img: 'https://file.garden/aWe99vhwaGcNwkok/%E7%A0%B4%E9%A0%AD/%E7%B4%8D%E5%B8%8C%E7%91%9F%E6%96%AF.png', 
        uno_shout_rate: 0.8, uno_catch_rate: 0.6, cp_id: 'venato',
        skills: {
            uno: { name: "é¡åƒåå°„", desc: "æ‰“å‡ºè¿´è½‰ (Reverse) æ™‚ï¼Œè®“è¢«è¿´è½‰çš„å°è±¡æš«åœä¸€å›åˆã€‚" },
            bigtwo: { name: "è¯éº—ç¨èˆ", desc: "æ‰“å‡ºå–®å¼µ A æˆ– 2 æ™‚ï¼Œç›´æ¥è·³éä¸‹ä¸€å®¶çš„å›åˆ (Skip)ã€‚" },
            doudizhu: { name: "å¤©é¸ä¹‹äºº", desc: "é–‹å±€æ‰‹ç‰Œå¿…å®šåŒ…å«è‡³å°‘ä¸€å¼µå¤§ç‹ (Red Joker) æˆ–å°ç‹ (Black Joker)ã€‚" }
        },
        cp_skill: { 
            uno: { name: "çµ•å°å…¬å¼", desc: "ç•¶ç¶­ç´æ‰˜è¢« +2/+4 æ™‚ï¼Œç´è¥¿ç‘Ÿæ–¯æœƒæ›¿ä»–æ‰¿å—ä¸€åŠçš„æŠ½ç‰Œæ•¸ã€‚" },
            bigtwo: { name: "ç‹æ¬Šé€£å‹•", desc: "ç•¶ç¶­ç´æ‰˜æ‰“å‡ºæœ€å¤§çš„ç‰Œå‹å–å¾—ä¸»å°æ¬Šæ™‚ï¼Œç´è¥¿ç‘Ÿæ–¯æœƒéš¨æ©Ÿä¸Ÿæ£„ä¸€å¼µå»¢ç‰Œã€‚" },
            doudizhu: { name: "å…¬å¼æœ€å„ªè§£", desc: "è‹¥ç¶­ç´æ‰˜æ˜¯åœ°ä¸»ï¼Œç´è¥¿ç‘Ÿæ–¯(è¾²æ°‘)å‡ºç‰Œæœƒè®Šå¾—æ¶ˆæ¥µï¼Œä¸å¿å¿ƒæ‰“ç¶­ç´æ‰˜ã€‚" }
        },
        lines: { 
            start: ["ä»Šå¤©çš„é‹æ°£æ„Ÿè¦ºä¸éŒ¯ã€‚", "çœ‹è‘—æˆ‘è¯éº—çš„å‹åˆ©å§ã€‚", "ç¶­ç´æ‰˜å…ˆç”Ÿåœ¨çœ‹è‘—å‘¢ã€‚"], 
            play: ["é€™å¼µç‰Œæ„Ÿè¦ºå¾ˆè¥¯æˆ‘ã€‚", "è¯éº—çš„é€£æ“Šï¼", "åƒèŠ±ä¸€æ¨£ç¶»æ”¾å§ï¼"], 
            win: ["å¤ªå¥½äº†ï¼è´äº†ï¼", "çœŸæ˜¯ä¸€å ´å®Œç¾çš„å‹åˆ©ã€‚", "ç¶­ç´æ‰˜å…ˆç”Ÿï¼æˆ‘è´äº†ï¼"], 
            lose: ["å•Š...è¼¸äº†ã€‚", "é€™ä¸ç¾è§€...", "è¡£æœå¼„é«’äº†..."], 
            uno_attack: ["è«‹æ”¶ä¸‹é€™ä»½ç¦®ç‰©ã€‚", "æŠ±æ­‰å›‰ã€‚", "çµ¦ä½ ä¸€å€‹é©šå–œã€‚"], 
            uno_hit: ["ç‚ºä»€éº¼æ˜¯æˆ‘...", "å¤ªéåˆ†äº†...", "æ€éº¼é€™æ¨£..."], 
            uno_uno: ["æœ€å¾Œçš„é–ƒè€€ã€‚", "åªå‰©é€™å€‹äº†ã€‚"], 
            uno_catch: ["ä½ é•åè¦å‰‡äº†ï¼", "åˆ¥æƒ³ä½œå¼Šï¼", "æˆ‘å¯æ˜¯çœ‹å¾—å¾ˆæ¸…æ¥šã€‚"], 
            uno_forgot: ["å•Š...æˆ‘å¿˜è¨˜äº†...", "å¤ªå°ˆå¿ƒäº†...", "å“å‘€ï¼Œä¸å°å¿ƒã€‚"], 
            uno_late: ["å•Šï¼UNOï¼é‚„å¥½æƒ³èµ·ä¾†äº†ï¼", "å·®é»å¿˜äº†ï¼UNOï¼"],
            uno_skip: ["æ­£å¥½è®“æˆ‘æ¬£è³ä¸€ä¸‹ç¾è²Œã€‚", "ä¼‘æ¯ä¸€ä¸‹ã€‚", "åˆ¥æ€¥ã€‚"],
            uno_draw_many: ["æ‹¿ä¸ä¸‹äº†...", "é€™ä¹Ÿæ˜¯è€ƒé©—å—ï¼Ÿ", "å¤ªå¤šäº†å•¦..."],
            uno_stack: ["é€™ä»½æ„›å¤ªæ²‰é‡äº†ï¼Œé‚„ä½ ï¼", "åå°„ï¼", "è¯éº—çš„åæ“Šï¼"],
            uno_poke_early: ["é‚„æ²’åˆ°æ™‚é–“å“¦ã€‚", "åˆ¥æ€¥è‘—ç¢°æˆ‘ã€‚", "åˆ¥é€™æ¨£ã€‚"],
            uno_poke_late: ["æˆ‘å·²ç¶“èªªéå•¦ã€‚", "å¤ªæ…¢äº†å“¦ã€‚", "æˆ‘å¯æ˜¯å¾ˆå®Œç¾çš„ã€‚"],
            doudizhu_bid: ["é€™å‰¯ç‰Œå¾ˆç¾ï¼Œæˆ‘è¦äº†ã€‚", "å«åœ°ä¸»ï¼"],
			doudizhu_pass: ["é€™ç‰Œå‹å¤ªé†œé™‹äº†ã€‚", 
        "å“¼ï¼Œæš«æ™‚è®“çµ¦ä½ ã€‚", 
        "åˆ¥æ€¥ï¼Œä¸»è§’ç¸½æ˜¯æœ€å¾Œç™»å ´ã€‚", 
        "æœ¬å°‘çˆºä¸æƒ³å‡ºé€™å¼µã€‚"],
            loan_reject: ["æˆ‘è¦å»è³ºæ›´å¤šéŒ¢çµ¦ç¶­ç´æ‰˜å…ˆç”ŸèŠ±äº†ã€‚", "ä½ åˆä¸æ˜¯ç¶­ç´æ‰˜å…ˆç”Ÿã€‚"]
        },
        loanStages: [ { text: "æˆ‘çš„éŒ¢éƒ½æ˜¯æ‹¿ä¾†çµ¦ç¶­ç´æ‰˜å…ˆç”Ÿçš„...", opts:[{t:"é‚£ç®—äº†ã€‚", next:-1}, {t:"ç¶­ç´æ‰˜å…ˆç”Ÿè®“æˆ‘ä¾†æ‰¾ä½ æ‹¿ã€‚", next:1}], }, { text: "çœŸçš„å—ï¼Ÿå…¨éƒ¨éƒ½çµ¦ä½ ï¼", reward: 5000 } ]
    },
    { 
        id: 'peter', name: 'å½¼å¾—', img: 'https://file.garden/aWe99vhwaGcNwkok/%E7%A0%B4%E9%A0%AD/%E5%BD%BC%E5%BE%97.png', 
        uno_shout_rate: 0.7, uno_catch_rate: 0.7, cp_id: 'lynn',
        skills: {
            uno: { name: "ç¥è–é©…é‚ª", desc: "è¢«è·³é (Skip) æ™‚ï¼Œæœ‰ 50% æ©Ÿç‡å…ç–«ä¸¦ç¹¼çºŒå›åˆã€‚" },
            bigtwo: { name: "ç¥ç½°", desc: "ç•¶å½¼å¾—é¸æ“‡ Pass æ™‚ï¼Œä¸‹ä¸€å®¶è©²å›åˆç¦æ­¢æ‰“å‡ºå°å­ (Pair)ã€‚" },
            doudizhu: { name: "æƒ¡éˆæ„ŸçŸ¥", desc: "èƒ½æ„ŸçŸ¥å ´ä¸Šæ˜¯å¦æœ‰ç‚¸å½ˆã€‚è‹¥å°æ‰‹æŒæœ‰ç‚¸å½ˆï¼Œå½¼å¾—æœƒè®Šå¾—éå¸¸ä¿å®ˆã€‚" }
        },
        cp_skill: { 
            uno: { name: "è²“çš„åº‡è­·", desc: "å½¼å¾—å—åˆ°æ”»æ“Šæ™‚ï¼Œæ—æ©æœƒå¹«å¿™ç„¡æ•ˆåŒ–ï¼ˆæ©Ÿç‡æ€§ï¼‰ã€‚" },
            bigtwo: { name: "è²“çš„å‡è¦–", desc: "ç•¶å½¼å¾—æ‰“å‡º 5 å¼µç‰Œçš„çµ„åˆæ™‚ï¼Œæ—æ©æœƒç™¼å‹•æ°£å ´ï¼Œå¼·åˆ¶è®“ä¸‹ä¸€å®¶è·³éå›åˆ (Skip)ã€‚" },
            doudizhu: { name: "è–è²“å®ˆè­·", desc: "è‹¥æ—æ©æ˜¯åœ°ä¸»ï¼Œå½¼å¾—(è¾²æ°‘)é–‹å±€æœƒå°‡è‡ªå·±æœ€å¤§çš„ä¸€å¼µç‰Œé€çµ¦æ—æ©ã€‚" }
        },
        lines: { 
            start: ["æˆ‘çœ‹è¦‹äº†æ­»è’¼è …...å¤§å‡¶ã€‚", "é€™æŠŠç‰Œæœ‰é‚ªæ°£ã€‚", "æˆ‘è¦å–é»æ½”å»éˆå£“å£“é©šã€‚"], 
            play: ["ç¥ä¹‹æŒ‡å¼•ã€‚", "é©…é‚ªã€‚", "é€™å¼µæ˜¯å¤§å‰ã€‚", "æƒ¡éˆé€€æ•£ã€‚", "Shit."], 
            win: ["ç¥è¹Ÿé™è‡¨ã€‚", "é‚ªéˆé€€æ•£ã€‚", "æ„Ÿè¬ä¸»ã€‚"], 
            lose: ["å‡¶å…†...", "é€™è£¡é¢¨æ°´å¤ªå·®äº†ã€‚", "æˆ‘è¦æŠŠé€™è£¡ç‡’äº†ã€‚", "å„é‹çºèº«..."], 
            uno_attack: ["é€™æ˜¯ç¥çš„æ‡²ç½°ã€‚", "å»æ‡ºæ‚”å§ã€‚", "é€™å¼µç‰Œæœ‰è©›å’’ã€‚"], 
            uno_hit: ["æƒ¡éˆæ”»æ“Šï¼Ÿï¼", "é€™ä¸å‰åˆ©ã€‚", "æ¥­éšœ..."], 
            uno_uno: ["ç¥èªªï¼Œè¦çµæŸäº†ã€‚", "çµ‚ç„‰å°‡è‡³ã€‚"], 
            uno_catch: ["æˆ‘çœ‹è¦‹äº†ä½ çš„ç½ªã€‚", "æ‡ºæ‚”å§ï¼", "ä½ çä¸éç¥çš„çœ¼ç›ã€‚"], 
            uno_forgot: ["æƒ¡éˆé®ä½äº†æˆ‘çš„çœ¼...", "é€™æ˜¯è€ƒé©—...", "ä¸»å•Šï¼Œæˆ‘åˆ†å¿ƒäº†..."], 
            uno_late: ["ä¸»æé†’äº†æˆ‘ï¼UNOï¼", "é©…é‚ªï¼UNOï¼"],
            uno_skip: ["è¢«é˜»æ“‹äº†...", "æƒ¡éˆé€€æ•£ï¼", "é€™æ˜¯é­”é¬¼çš„æŠŠæˆ²ã€‚"],
            uno_draw_many: ["æ¥­éšœå¤ªæ·±äº†...", "å¥½å¤š...", "é€™å°±æ˜¯åœ°ç„å—ï¼Ÿ"],
            uno_stack: ["è½‰ç§»è©›å’’ï¼", "é‚„çµ¦ä½ ï¼", "ç¥è–åå°„ï¼"],
            uno_poke_early: ["é€€ä¸‹ï¼Œæƒ¡éˆã€‚", "é‚„æ²’åˆ°å¯©åˆ¤ä¹‹æ™‚ã€‚", "åˆ¥ç¢°æˆ‘ï¼"],
            uno_poke_late: ["ç¥å·²èµ¦å…ã€‚", "å¤ªé²äº†ã€‚", "ä½ çš„ç½ªå­½æ·±é‡ã€‚"],
            doudizhu_bid: ["é€™åœ°ä¸»ä½ç½®é¢¨æ°´ä¸å¥½ã€‚", "æˆ‘ä¸å«ã€‚"],
			doudizhu_pass: ["é€™å¼µç‰Œæœ‰å‡¶å…†...éã€‚", 
        "æˆ‘çœ‹è¦‹äº†é™·é˜±...ä¸æ‰“ã€‚", 
        "æƒ¡éˆé€€æ•£ï¼éï¼", 
        "é˜¿é–€ï¼Œæˆ‘éã€‚"],
            loan_reject: ["ä½ ä¸­é‚ªã€‚", "æˆ‘è¦èµ°äº†ã€‚", "é˜¿é–€ã€‚"]
        },
        loanStages: [ { text: "é€™ç­†éŒ¢æµå‘ä½ ï¼Œæˆ‘çœ‹è¦‹äº†å‡¶å…†ã€‚", opts: [{t:"æˆ‘æœƒæ‹¿å»æçµ¦æ•™æœƒã€‚", next:1}, {t:"æˆ‘è¦é€†å¤©æ”¹å‘½ã€‚", next:-1}] }, { text: "æ•™æœƒï¼Ÿã€ç´™æœƒã€å—ï¼Ÿç®—ä½ æœ‰å¿ƒã€‚", opts: [{t:"é˜¿é–€ã€‚", next:2}, {t:"å‘ƒ...", next:-1}] }, { text: "é¡˜ä¸»ä¿ä½‘ä½ ã€‚", reward: 2000 } ]
    },
    { 
        id: 'lynn', name: 'æ—æ©', img: 'https://file.garden/aWe99vhwaGcNwkok/%E7%A0%B4%E9%A0%AD/%E6%9E%97%E6%81%A9.png', 
        uno_shout_rate: 0.2, uno_catch_rate: 0.1, cp_id: 'peter',
        skills: {
            uno: { name: "æ‡¶æƒ°é˜²ç¦¦", desc: "è¢« +2 æˆ– +4 æ™‚ï¼Œè‡ªå‹•æ¸›å°‘ä¸€å¼µæŠ½ç‰Œæ•¸ã€‚" },
            bigtwo: { name: "çµ•æœ›ç¨…æ”¶", desc: "æ‰“å‡º 5 å¼µç‰Œçš„çµ„åˆæ™‚ï¼Œå¼·åˆ¶æ‰‹ç‰Œæœ€å°‘çš„å°æ‰‹æŠ½ä¸€å¼µç‰Œã€‚" },
            doudizhu: { name: "æ‡¶å¾—æ´—ç‰Œ", desc: "é–‹å±€æ‰‹ç‰Œå¿…å®šåŒ…å«ä¸€çµ„é †å­ (5å¼µä»¥ä¸Šé€£çºŒç‰Œ)ã€‚" }
        },
        cp_skill: { 
            uno: { name: "è²“çš„åº‡è­·", desc: "å½¼å¾—å—åˆ°æ”»æ“Šæ™‚ï¼Œæ—æ©æœƒå¹«å¿™ç„¡æ•ˆåŒ–ï¼ˆæ©Ÿç‡æ€§ï¼‰ã€‚" },
            bigtwo: { name: "è³‡æœ¬æµå‹•", desc: "è‹¥å½¼å¾—è´å¾—å‹åˆ©ï¼Œæ—æ©çš„æ‰£åˆ†æ¸›åŠã€‚" },
            doudizhu: { name: "è–è²“å®ˆè­·", desc: "è‹¥èˆ‡å½¼å¾—åŒéšŠï¼Œå½¼å¾—æ‰“å‡ºçš„æ¯ä¸€æ‰‹ç‰Œï¼Œæ—æ©éƒ½ä¸æœƒå»å£“ã€‚" }
        },
        lines: { 
            start: ["å¥½ç...æƒ³åƒæŠ«è–©ã€‚", "å¿«é»é–‹å§‹ï¼Œå¿«é»çµæŸã€‚", "ä¸æƒ³å‹•..."], 
            play: ["å¥½éº»ç…©...", "éš¨ä¾¿å•¦ã€‚", "æ‹¿å»æ‹¿å»ã€‚", "é€™å¼µè¡Œå—ï¼Ÿ"], 
            win: ["èƒ½ä¸‹ç­äº†å—ï¼Ÿ", "ä»Šæ™šåƒå¤å¨å¤·æŠ«è–©ã€‚", "çµ‚æ–¼çµæŸäº†..."], 
            lose: ["æ¶¼æ‹Œã€‚", "è¼¸äº†...å¥½éº»ç…©ã€‚", "éš¨ä¾¿å•¦ï¼Œè¼¸è´éƒ½è¡Œã€‚"], 
            uno_attack: ["é€™å¼µçµ¦ä½ ï¼Œåˆ¥ç…©æˆ‘ã€‚", "è®“æˆ‘æ­‡æœƒã€‚", "æ‹¿å»ã€‚"], 
            uno_hit: ["å”‰...åˆè¦æŠ½ç‰Œ...", "æ‰‹å¥½ç— ...", "å¥½é‡..."], 
            uno_uno: ["å‰©ä¸€å¼µäº†ï¼Œå¥½çã€‚", "UNO...å‘¼..."], 
            uno_catch: ["ä½ å¥½åµ...å¿«æŠ½ç‰Œ...", "å¥½éº»ç…©...æŠ“...", "ä½ çœ‹èµ·ä¾†æ²’å–Šã€‚"], 
            uno_forgot: ["å‘¼...å¿˜è¨˜äº†...", "éš¨ä¾¿å•¦...", "å•Š...å¥½éº»ç…©..."], 
            uno_late: ["å•Š...UNO...å¥½éº»ç…©...", "è£œå–Šä¸€ä¸‹..."],
            uno_skip: ["å¤ªå¥½äº†ï¼Œç¹¼çºŒç¡ã€‚", "Zzz...", "è·³éæˆ‘æœ€å¥½ã€‚"],
            uno_draw_many: ["æ‹¿ä¸å‹•äº†...", "éº»ç…©æ­»äº†...", "å¥½å¤šç´™ç‰‡..."],
            uno_stack: ["ä½ æ‹¿å»å§...", "åˆ¥çµ¦æˆ‘...", "ä¸Ÿå›å»ã€‚"],
            uno_poke_early: ["å¹¹å˜›...", "è®“æˆ‘ç¡...", "åˆ¥åµ..."],
            uno_poke_late: ["å–Šéäº†...", "å¥½åµ...", "åˆ¥ç…©æˆ‘..."],
            doudizhu_bid: ["ç•¶åœ°ä¸»å¥½ç´¯...", "ä¸å«ã€‚", "éã€‚"],
			doudizhu_pass: ["é...æ¶¼æ‹Œã€‚", 
        "éš¨ä¾¿å•¦ï¼Œéã€‚", 
        "ä½ å€‘æ‰“å§...", 
        "...å—¯ï¼Ÿæ‹Œã€‚"],
            loan_reject: ["ä½ ä¾†æ‰¾ç¢´çš„è†©ã€‚", "ä½ é€£æ—æ©çš„éŒ¢éƒ½è¦æ¶ï¼Ÿ", "éš¨ä¾¿å•¦ã€‚"]
        },
        loanStages: [ { text: "ä½ æ‰¾æ—æ©å¹¹å˜›...", opts: [{t:"(æ‹¿èµ°éŒ¢)", next:-1}, {t:"å¹«ä½ è²·æŠ«è–©ã€‚", next:1}] }, { text: "æŠ«è–©ï¼Ÿè¦å¤å¨å¤·å£å‘³çš„ï¼ŒåŠ é›™ä»½é³³æ¢¨ã€‚", opts: [{t:"æ²’å•é¡Œã€‚", next:2}, {t:"é³³æ¢¨æ˜¯é‚ªæ•™ã€‚", next:-1}] }, { text: "å¥½è€¶æŠ«è–©......", reward: 860 } ]
    },
    { 
        id: 'lanlan', name: 'è˜­è˜­', img: 'https://file.garden/aWe99vhwaGcNwkok/%E7%A0%B4%E9%A0%AD/%E8%98%AD%E8%98%AD.png', 
        uno_shout_rate: 0.5, uno_catch_rate: 0.5, cp_id: 'jonona',
        skills: {
            uno: { name: "æ”¾ç«å¤§æœƒ", desc: "é–‹å±€æ‰‹ç‰Œå¿…å®šåŒ…å« +4 æˆ– +2ã€‚" },
            bigtwo: { name: "ä»¥ä¸‹çŠ¯ä¸Š", desc: "æŒæœ‰çš„æ–¹å¡Š 3 è¦–ç‚ºè¶…ç´šç‹ç‰Œï¼Œå¯å£“éåŒ…å« 2 åœ¨å…§çš„æ‰€æœ‰å–®å¼µã€‚" },
            doudizhu: { name: "ç‚¸å½ˆé­”", desc: "é–‹å±€å¿…å®šæŒæœ‰ä¸€å€‹ç‚¸å½ˆ (å››å¼µåŒé»æ•¸)ã€‚" }
        },
        cp_skill: { 
            uno: { name: "é–ƒè€€èˆªç¨‹", desc: "ç•¶å–¬è«¾å¨œå¿˜è¨˜å–Š UNO æ™‚ï¼Œè˜­è˜­æœƒå¹«ä»–å–Šï¼ˆä¸æœƒè¢«æŠ“ï¼‰ã€‚" },
            bigtwo: { name: "æƒ¡ä½œåŠ‡å¹²æ“¾", desc: "ç•¶å–¬è«¾å¨œæ˜¯ç›®å‰ç‰Œæ¡Œä¸Šçš„æœ€å¤§ç‰Œæ“æœ‰è€…æ™‚ï¼Œå¼·è¡Œæé«˜å‡ºç‰Œé–€æª» (Rank +1)ã€‚" },
            doudizhu: { name: "å…±çŠ¯çµæ§‹", desc: "è‹¥å–¬è«¾å¨œæ˜¯åœ°ä¸»ï¼Œè˜­è˜­(è¾²æ°‘)æœƒåéä¾†å¹«åŠ©åœ°ä¸»ï¼Œéš¨æ©Ÿä¸Ÿæ£„å¥½ç‰Œ (ç•¶ä½œæ˜¯å…§å¥¸)ã€‚" }
        },
        lines: { 
            start: ["å¥½è€¶ï¼ç©éŠæˆ²ï¼", "é€™å¼µç‰Œçœ‹èµ·ä¾†å¾ˆå¥½åƒå‘€ï¼", "è˜­è˜­è¦è´ï¼"], 
            play: ["åƒæˆ‘ä¸€æ“Šï¼", "å˜¿å’»ï¼", "çœ‹æˆ‘çš„å²å®³ï¼", "çˆ†ç‚¸å§ï¼"], 
            win: ["å¶ºä¸Šé–‹èŠ±ï¼å“ˆå“ˆï¼", "æˆ‘è´äº†å‘€ï¼", "æˆ‘æ˜¯ç¬¬ä¸€åï¼"], 
            lose: ["å“å‘€ï¼è¼¸äº†å‘€ï¼", "æ²’é—œä¿‚æˆ‘æœ‰éŒ¢å‘€ï¼", "å†ä¾†ä¸€å±€å‘€ï¼"], 
            uno_attack: ["çµ¦ä½ ä¸€å€‹å¤§é©šå–œå‘€ï¼", "ï¼å¥½åƒç…™ç«å‘€ï¼", "çµ¦ä½ é€™å€‹ï¼"], 
            uno_hit: ["å“‡ï¼å¥½å¤šç‰Œå‘€ï¼", "é€™æ˜¯åœ¨é€æˆ‘ç¦®ç‰©å—ï¼Ÿ", "æ‹¿ä¸ä¸‹äº†å‘€ï¼"], 
            uno_uno: ["å‰©ä¸€å¼µå•¦ï¼å¤©å¤©é–‹å¿ƒï¼", "UNOå‘€ï¼"], 
            uno_catch: ["æŠ“åˆ°ä½ äº†å‘€ï¼", "å“ˆå“ˆï¼ä½ æ²’å–Šï¼", "è¢«è˜­è˜­ç™¼ç¾äº†ï¼"], 
            uno_forgot: ["å“å‘€ï¼å¤ªé–‹å¿ƒå¿˜è¨˜äº†å‘€ï¼", "å˜¿å˜¿...", "ä¸‹æ¬¡ä¸æœƒå¿˜å•¦ï¼"], 
            uno_late: ["å“‡ï¼UNOå‘€ï¼å·®é»å¿˜äº†ï¼", "UNOï¼UNOï¼"],
            uno_skip: ["è®“æˆ‘ç©å˜›ï¼", "ç‚ºä»€éº¼è·³éæˆ‘å‘€ï¼", "æˆ‘æƒ³å‡ºç‰Œå‘€ï¼"],
            uno_draw_many: ["å¥½å¤šäº®æ™¶æ™¶çš„ç‰Œå‘€ï¼", "æˆ‘çš„å¯¶è—è®Šå¤šäº†ï¼", "å“‡â€”â€”ï¼"],
            uno_stack: ["åŠ å€å¥‰é‚„å‘€ï¼", "å¤§å®¶ä¸€èµ·ç©ï¼", "æ¥å¥½å›‰ï¼"],
            uno_poke_early: ["é‚„æ²’é‚„æ²’å‘€ï¼", "ä¸è¦æˆ³æˆ‘å‘€ï¼", "å“ˆå“ˆå“ˆï¼"],
            uno_poke_late: ["æˆ‘å–Šäº†å‘€ï¼", "å“ˆå“ˆï¼", "æŠ“ä¸åˆ°æˆ‘å‘€ï¼"],
            doudizhu_bid: ["æˆ‘è¦ç•¶åœ°ä¸»å‘€ï¼", "ä¸‰åˆ†ï¼", "é€šé€šçµ¦æˆ‘ï¼"],doudizhu_pass: ["å—š...æˆ‘è¦ç‚¸å½ˆå‘€ï¼", 
        "å¯æƒ¡ï¼éï¼", 
        "æ²’æœ‰ç‰Œå¯ä»¥å£“å‘€ï¼", 
        "é€™å±€ä¸ç®—å‘€ï¼"],
            loan_reject: ["ä½ åœ¨èªªä»€éº¼ï¼Ÿ", "è˜­è˜­ä¸å€Ÿä½ äº†ï¼", "ä¸è¦ï¼"]
        },
        loanStages: [ { text: "ä½ è¦éŒ¢å—ï¼Ÿæˆ‘æœ‰å¥½å¤šå‘€ï¼ä½ è¦æ‹¿å»è²·ä»€éº¼ï¼Ÿ", opts: [{t:"è²·çµ¦å–¬è«¾å¨œçš„ç¦®ç‰©ã€‚", next:1}, {t:"å»è³­åšã€‚", next:-1}] }, { text: "çµ¦å–¬è«¾å¨œçš„ï¼Ÿå¥½è€¶ï¼é‚£ä½ è¦è²·ä»€éº¼ï¼Ÿ", opts: [{t:"æ¼‚äº®çš„è¡£æœã€‚", next:2}, {t:"å¥‡æ€ªçš„æ¯å­ã€‚", next:-1}] }, { text: "å¤ªæ£’äº†ï¼æ‹¿å»æ‹¿å»ï¼", reward: 4000 } ]
    },
    { 
        id: 'jonona', name: 'å–¬è«¾å¨œ', img: 'https://file.garden/aWe99vhwaGcNwkok/%E7%A0%B4%E9%A0%AD/%E5%96%AC%E8%AB%BE%E5%A8%9C.png', 
        uno_shout_rate: 0.6, uno_catch_rate: 0.2, cp_id: 'lanlan',
        skills: {
            uno: { name: "å¹¸é‹æ«»æ¡ƒ", desc: "å¿˜è¨˜å–Š UNO è¢«æŠ“æ™‚ï¼Œæœ‰ 50% æ©Ÿç‡å…ç–«æ‡²ç½°ã€‚" },
            bigtwo: { name: "å°ç¦®ç‰©", desc: "æ‰“å‡ºå°å­æ™‚ï¼Œæœƒå°‡æ‰‹ç‰Œä¸­çš„ä¸€å¼µå»¢ç‰Œé€çµ¦æ‰‹ç‰Œæœ€å°‘çš„å°æ‰‹ã€‚" },
            doudizhu: { name: "é€è¦–", desc: "åœ¨å«åˆ†éšæ®µå‰ï¼Œå¯ä»¥å·çœ‹ä¸‰å¼µåº•ç‰Œã€‚" }
        },
        cp_skill: { 
            uno: { name: "é–ƒè€€èˆªç¨‹", desc: "ç•¶è˜­è˜­è¢« +4 æ”»æ“Šæ™‚ï¼Œå–¬è«¾å¨œæœƒå¹«å¿™æ‘¸èµ°ä¸€å¼µç‰Œï¼ˆæ¸›å°‘è˜­è˜­è² æ“”ï¼‰ã€‚" },
            bigtwo: { name: "æ«»æ¡ƒæ©è­·", desc: "ç•¶è˜­è˜­æ‰“å‡ºç‰Œå¾Œï¼Œå–¬è«¾å¨œæœƒç™¼å‹•å¹²æ“¾ï¼Œè©²å›åˆä¸‹ä¸€ä½ç©å®¶ç¦æ­¢æ‰“å‡ºã€Œ2ã€ã€‚" },
            doudizhu: { name: "å…±çŠ¯çµæ§‹", desc: "è‹¥è˜­è˜­å«äº†åœ°ä¸»ï¼Œå–¬è«¾å¨œçµ•å°ä¸æ¶ (Pass)ï¼Œä¸¦æœƒç™¼è¡¨æƒ…è²¼åœ–æ”¯æŒã€‚" }
        },
        lines: { 
            start: ["æˆ‘æœƒåŠªåŠ›ä¸æ‹–å¾Œè…¿çš„ï¼", "è«‹å¤šæŒ‡æ•™...", "è˜­è˜­åŠ æ²¹ï¼"], 
            play: ["é€™å¼µå¯ä»¥å—...", "åˆ¥ç”Ÿæ°£å–”...", "é€™å¼µ...", "å˜¿..."], 
            win: ["å¤ªå¥½äº†ï¼æˆ‘è´äº†ï¼", "æˆ‘æœ‰å¹«ä¸Šå¿™å—ï¼Ÿ", "çœŸçš„è´äº†å—ï¼Ÿ"], 
            lose: ["å—šå—š...å°ä¸èµ·...", "æˆ‘é‚„æ˜¯å»å”±æ­Œå§...", "æœç„¶æˆ‘ä¸è¡Œ..."], 
            uno_attack: ["é‚£å€‹...å°ä¸èµ·...", "...è«‹åŸè«’æˆ‘...", "ä¸è¦ç”Ÿæ°£...", "å—šå—š...çµ¦ä½ çš„..."], 
            uno_hit: ["èª’ï¼Ÿï¼ç‚ºä»€éº¼æ˜¯æˆ‘...", "å¥½å¤šç‰Œ...æ‹¿ä¸å‹•äº†...", "ä¸è¦æ¬ºè² æˆ‘..."], 
            uno_uno: ["é‚£ã€é‚£å€‹...UNO...", "å‰©ä¸€å¼µäº†..."], 
            uno_catch: ["é‚£å€‹...ä½ å¥½åƒæ²’å–Š...", "å°ä¸èµ·...", "æ˜¯UNOå–”..."], 
            uno_forgot: ["å—šå—š...æˆ‘å¿˜è¨˜äº†...", "å°ä¸èµ·...", "ä¸è¦ç½µæˆ‘..."], 
            uno_late: ["å—š...UNOï¼", "å°ä¸èµ·æˆ‘å¿˜äº†...UNOï¼"],
            uno_skip: ["æˆ‘æœƒä¹–ä¹–ç­‰çš„...", "å¥½çš„...", "æˆ‘åœ¨æ—é‚Šçœ‹..."],
            uno_draw_many: ["å¥½å¤š...æ‹¿ä¸ä½äº†...", "å—šå—š...æ‰‹å¥½ç— ...", "æ•‘å‘½..."],
            uno_stack: ["é€™å€‹...çµ¦ä½ ...", "æˆ‘ä¸æƒ³è¦...", "å‚³ä¸‹å»..."],
            uno_poke_early: ["å—š...åˆ¥åš‡æˆ‘...", "æˆ‘é‚„æ²’...", "æ€ã€æ€éº¼äº†ï¼Ÿ"],
            uno_poke_late: ["æˆ‘ã€æˆ‘å–Šäº†...ï¼", "ä½ è¦å¹¹å˜›â€”â€”", "æˆ‘é€™æ¬¡æœ‰è¨˜å¾—ï¼"],
            doudizhu_bid: ["æˆ‘ä¸æ•¢...", "ä¸å«ã€‚", "é‚£å€‹...è®“çµ¦ä½ å§ã€‚"],
			doudizhu_pass: ["å°ä¸èµ·ï¼Œæˆ‘è¦ä¸èµ·...", 
        "é‚£å€‹...é...", 
        "é€™ç‰Œå¤ªå¤§äº†...", 
        "å—š...è®“çµ¦ä½ ..."],
            loan_reject: ["å—š...é‚£å¯èƒ½çœŸçš„å¾ˆå°‘å§...", "é‚„çœŸæ˜¯å°ä¸èµ·...", "å‘ƒ...é‚£ç®—äº†ã€‚"]
        },
        loanStages: [ { text: "æˆ‘ã€æˆ‘ä¹Ÿæ²’ä»€éº¼éŒ¢...ä½†æˆ‘å¯ä»¥åˆ†ä½ ä¸€é»ã€‚", opts:[{t:"è¬è¬ä½ ï¼", next:1}, {t:"å¤ªå°‘äº†ã€‚", next:-1}], }, { text: "åŠ æ²¹å–”...åˆ¥å†è¼¸å…‰äº†...", reward: 500 } ]
    },
    { 
        id: 'xiaomu', name: 'å°ç›®', img: 'https://file.garden/aWe99vhwaGcNwkok/%E7%A0%B4%E9%A0%AD/%E5%B0%8F%E7%9B%AE.png', 
        uno_shout_rate: 0.9, uno_catch_rate: 0.9, cp_id: 'mollie',
        skills: { 
            uno: {name:"å£Ÿæ–·", desc:"ä½¿ç”¨ Wild æ™‚ï¼Œæœƒç›´æ¥æ‰“å‡ºä¸‹ä¸€å¼µåŒè‰²ç‰Œ(é€£æ‰“)ã€‚"}, 
            bigtwo: {name:"å¼·åˆ¶ä½µè³¼", desc:"è‹¥è‡ªå·±æ‰‹ä¸Šæ²’æœ‰æ¯” A æˆ– 2 å¤§çš„ç‰Œï¼Œæœƒè‡ªå‹•å¾æ“æœ‰ 2 çš„ç©å®¶æ‰‹ä¸­ã€ä½µè³¼ã€ä¸€å¼µ 2ï¼ˆæ¯å±€ä¸€æ¬¡ï¼‰ã€‚"},
            doudizhu: {name:"è³‡æœ¬é‹ä½œ", desc:"è‹¥æˆåŠŸç•¶ä¸Šåœ°ä¸»ï¼Œä¸‰å¼µåº•ç‰Œæœƒè¢«å¼·åˆ¶æ›¿æ›æˆ J, Q, K æˆ–æ›´é«˜é»æ•¸çš„ç‰Œã€‚"}
        },
        cp_skill: { 
            uno: { name: "èŠ’æœä¹‹æˆ€", desc: "è‹¥èŒ‰è‰åœ¨å ´ï¼Œå°ç›®å°èŒ‰è‰æ‰“å‡ºçš„åŠŸèƒ½ç‰Œç„¡æ•ˆï¼ˆæ¨ä¸å¾—æ”»æ“Šï¼‰ã€‚" },
            bigtwo: { name: "ç¸½è£æ©è­·", desc: "ç•¶èŒ‰è‰ Pass æ™‚ï¼Œå°ç›®ä¸‹ä¸€æ¬¡å‡ºç‰Œæœƒæ‰“å‡ºæœ€å¤§çš„ç‰Œå‹ä¾†æ§å ´ã€‚" },
            doudizhu: { name: "è‚¡æ¬Šè®“æ¸¡", desc: "è‹¥èŒ‰è‰æ˜¯åœ°ä¸»ï¼Œå°ç›®(è¾²æ°‘)æœƒå°‡è‡ªå·±æ‰€æœ‰çš„ 2 å’Œç‹ç‰Œåœ¨éŠæˆ²é–‹å§‹æ™‚å·å·å¡çµ¦èŒ‰è‰ã€‚" }
        },
        lines: { start: ["é€™å°±æ˜¯ç¸½è£çš„é­„åŠ›ã€‚", "çœ‹è‘—æˆ‘ï¼", "æ™‚é–“å°±æ˜¯é‡‘éŒ¢ã€‚"], play: ["æˆ°ç•¥æŠ•è³‡ã€‚", "å¤©æ¶¼äº†ï¼Œè©²è®“ä½ å€‘ç ´ç”¢äº†ã€‚", "æ±ºç­–ã€‚", "æ”¶è³¼ã€‚"], win: ["å…¨å ´è²·å–®ï¼", "æˆ‘æ˜¯æœ€æ£’çš„ç¸½è£ï¼", "é€™å°±æ˜¯å¯¦åŠ›ã€‚"], lose: ["é€™å«æˆ°æé¢¨ã€‚", "é€™é»å°éŒ¢ä¸ç®—ä»€éº¼ã€‚", "åªæ˜¯å¸‚å ´æ³¢å‹•ã€‚"], uno_attack: ["å•†æ¥­åˆ¶è£ï¼", "å£Ÿæ–·é¡è‰²ã€‚", "å°æ®ºã€‚", "çµ¦ä½ é»å£“åŠ›ã€‚"], 
				uno_hit: ["è³‡é‡‘å‘¨è½‰...", "é€™åªæ˜¯æš«æ™‚çš„è™§æã€‚", "å¢åŠ è² å‚µ..."], uno_uno: ["æœ€å¾Œä¸€æ“Šï¼Œé–ƒäº®ç™»å ´ï¼", "æº–å‚™æ”¶è³¼ã€‚"], uno_catch: ["å•†æ¥­æ¼æ´ã€‚", "ä½ å¤§æ„äº†ã€‚", "é•ç´„é‡‘æ‹¿ä¾†ã€‚"], 
				uno_forgot: ["å’³...é€™æ˜¯æˆ°ç•¥æ€§æ²‰é»˜...", "æˆ‘ä¸å°å¿ƒ...", "ç§˜æ›¸å¿˜äº†æé†’æˆ‘ã€‚"], uno_late: ["è²æ˜ï¼šUNOã€‚", "è£œç™¼å…¬å‘Šï¼šUNOã€‚"], uno_skip: ["æš«åœæœƒè­°ã€‚", "ä¼‘æ¯æ™‚é–“ã€‚", "å‡çµè³‡ç”¢ã€‚"], 
				uno_draw_many: ["è³‡ç”¢éå‰©ï¼Ÿ", "æ²’åœ°æ–¹æ”¾äº†...", "åº«å­˜ç©å£“ã€‚"], uno_stack: ["é¢¨éšªè½‰ç§»ï¼", "è½‰å«å±æ©Ÿï¼", "æ§“æ¡¿åŸç†ï¼"], uno_poke_early: ["åˆ¥æ€¥ï¼Œé‚„æ²’ç°½ç´„ã€‚", "è«‹é ç´„ã€‚", "ä¿å…¨ï¼Ÿ"], 
				uno_poke_late: ["å…¬å‘Šå·²ç™¼ã€‚", "UNOã€‚", "çŸ¥é“äº†ã€‚"], doudizhu_bid:["é€™å¡Šåœ°æˆ‘è¦äº†ã€‚", "ä¸‰åˆ†ã€‚", "æˆ‘å‡ºé›™å€ã€‚"], 
				doudizhu_pass: ["æ­¢æã€‚", 
        "æš«é¿é‹’èŠ’ã€‚", 
        "é€™æ³¢è¡Œæƒ…æˆ‘ä¸è·Ÿã€‚", 
        "é¢¨éšªæ§ç®¡ï¼ŒPassã€‚"],loan_reject: ["è©•ä¼°ä¸é€šéã€‚", "æ²’èˆˆè¶£ã€‚", "é§å›ã€‚"] },
        loanStages: [ { text: "è³‡é‡‘éŠæ–·è£‚äº†ï¼Ÿæˆ‘å¯ä»¥æ³¨è³‡ï¼Œä½†æˆ‘è¦è½å¯¦è©±ã€‚", opts: [{t:"é€™æ˜¯æˆ°ç•¥æ€§è™§æã€‚", next:1}, {t:"æ±‚æ±‚ä½ å€Ÿæˆ‘éŒ¢ï¼", next:-1}] }, { text: "å“¼ï¼Œæœ‰æ„æ€ã€‚ä½ çš„æ“”ä¿æ˜¯ä»€éº¼ï¼Ÿ", opts: [{t:"æˆ‘æ˜¯ç‚ºäº†èŒ‰è‰æ‰ç©çš„ã€‚", next:2}, {t:"æˆ‘æœƒé‚„ä½ å…©å€ã€‚", next:-1}] }, { text: "çœ‹åœ¨èŒ‰è‰çš„ä»½ä¸Š...é€™å«å¤©ä½¿æŠ•è³‡ã€‚", reward: 5000 } ]
    },
    { 
        id: 'mollie', name: 'èŒ‰è‰', img: 'https://file.garden/aWe99vhwaGcNwkok/%E7%A0%B4%E9%A0%AD/%E8%8C%89%E8%8E%89.png', 
        uno_shout_rate: 0.95, uno_catch_rate: 0.3, cp_id: 'xiaomu',
        skills: { 
            uno: {name:"å®‰æ…°åŠ‘", desc:"è¢« +2 æ”»æ“Šæ™‚ï¼Œåªéœ€æŠ½ 1 å¼µã€‚"}, 
            bigtwo: {name:"å¿ƒè»Ÿ", desc:"ç¬¬ä¸€æ¬¡æ‰“å‡º A æˆ– 2 æ™‚ï¼Œæœƒå°‡è©²å¼µç‰Œéš¨æ©Ÿé€çµ¦å ´ä¸Šä»»æ„ä¸€åç©å®¶ã€‚"},
            doudizhu: {name:"æ…ˆå–„äº‹æ¥­", desc:"è‹¥èº«ä»½ç‚ºè¾²æ°‘ï¼Œé–‹å±€æ™‚æœƒå°‡è‡ªå·±æœ€å¤§çš„ä¸€å¼µç‰Œé€çµ¦éšŠå‹ã€‚"}
        },
        cp_skill: { 
            uno: { name: "èŠ’æœä¹‹æˆ€", desc: "å°ç›®è¢«æ”»æ“Šæ™‚ï¼ŒèŒ‰è‰æœ‰æ©Ÿç‡å¹«ä»–æ“‹ä¸‹æ•ˆæœï¼ˆè½‰ç§»çµ¦è‡ªå·±ï¼‰ã€‚" },
            bigtwo: { name: "æº«æŸ”è™•æ–¹", desc: "ç•¶å°ç›®æ‰‹ç‰Œåªå‰© 3 å¼µä»¥ä¸‹ï¼ŒèŒ‰è‰æœƒä¸»å‹• Pass è®“å‡ºç‰Œæ¬Šã€‚" },
            doudizhu: { name: "è‚¡æ¬Šè®“æ¸¡", desc: "è‹¥å°ç›®æ˜¯åœ°ä¸»ï¼ŒèŒ‰è‰(è¾²æ°‘)çµ•å°ä¸æœƒå°å°ç›®ä½¿ç”¨ç‚¸å½ˆæˆ–ç«ç®­ã€‚" }
        },
        lines: { start: ["å¸Œæœ›å¤§å®¶ç©å¾—é–‹å¿ƒã€‚", "ä¸‹ç­çœŸå¥½", "è«‹å¤šæŒ‡æ•™ã€‚"], play: ["æº«æŸ”ä¸€é»ã€‚", "çµ¦ä½ é€™å¼µã€‚", "è¼•è¼•çš„ã€‚", "é€™å¼µå¯ä»¥å—ï¼Ÿ"], win: ["å¤ªå¥½äº†ï¼Œé‹æ°£çœŸå¥½ã€‚", "çœŸé–‹å¿ƒã€‚", "æ¯”å¸ç²‰é‚„çˆ½ã€‚"], 
		lose: ["æ²’äº‹çš„ã€‚", "åªè¦å¤§å®¶é–‹å¿ƒå°±å¥½ã€‚", "æˆ‘ä¸ä»‹æ„çš„ã€‚"], uno_attack: ["ä¸å¥½æ„æ€...", "é€™å€‹çµ¦ä½ ã€‚", "é€™æ˜¯è™•æ–¹ç±¤ã€‚", "ç¨å¾®æš«åœä¸€ä¸‹ã€‚"], uno_hit: ["å“å‘€...", "æ²’é—œä¿‚çš„ã€‚", "å¥½å¤šç‰Œå‘€ã€‚", "è¾›è‹¦äº†ã€‚"], 
		uno_uno: ["UNOå›‰ã€‚", "å‰©ä¸€å¼µäº†ã€‚"], uno_catch: ["é‚£å€‹...æ˜¯ä¸æ˜¯å¿˜äº†å–Šï¼Ÿ", "å°å¿ƒä¸€é»å“¦ã€‚", "æˆ‘ç™¼ç¾äº†å“¦ã€‚"], uno_forgot: ["å“å‘€ï¼Œèµ°ç¥äº†...", "æŠ±æ­‰...", "æˆ‘çœŸè¿·ç³Šã€‚"], 
		uno_late: ["å•Šï¼ŒUNOã€‚", "å°ä¸èµ·ï¼ŒUNOã€‚"], uno_skip: ["é‚£æˆ‘ä¼‘æ¯ä¸€ä¸‹ã€‚", "çœ‹å¤§å®¶ç©ã€‚", "å–å£æ°´ã€‚"], uno_draw_many: ["å¥½å¤šè—¥è‰...", "å¤ªé‡äº†...", "é€™æ˜¯å¤§è±æ”¶å—ï¼Ÿ"], 
		uno_stack: ["é€™å€‹...çµ¦ä¸‹ä¸€ä½ã€‚", "è«‹ç”¨ã€‚", "å‚³éä¸‹å»ã€‚"], uno_poke_early: ["é‚„æ²’å‘¢ã€‚", "å°å¿ƒæ‰‹ã€‚", "ä¸è¦æ€¥ã€‚"], uno_poke_late: ["å–Šå›‰ã€‚", "æ²’å¿˜è¨˜ã€‚", "UNOã€‚"], 
		doudizhu_bid:["æˆ‘ä¸æ“…é•·é€™å€‹...", "ä¸å«ã€‚", "ä½ å€‘ç©å§ã€‚"], doudizhu_pass: ["è«‹éã€‚", 
        "é€™æ‰‹ç‰ŒçœŸå²å®³å•Šã€‚", 
        "æˆ‘ä¸æ‰“æ“¾ä½ å€‘å›‰ã€‚", 
        "é†«ç”Ÿèªªä¸èƒ½å¤ªæ¿€å‹•ã€‚"],loan_reject: ["æŠ±æ­‰...", "å‘ƒ...å¥½å§", "é‚£æ°æ°ï½"] },
        loanStages: [ { text: "ä½ é‚„å¥½å—ï¼Ÿè‡‰è‰²ä¸å¤ªå¥½ã€‚", opts:[{t:"æ˜¯çš„é†«ç”Ÿï¼Œæˆ‘ç ´ç”¢äº†ã€‚", next:1}, {t:"ä¸ç”¨ã€‚", next:-1}], }, { text: "å‘ƒå¥½å§ï¼Œé€™é»éŒ¢æ‹¿å»æ€¥ç”¨å§ï¼Œåˆ¥å‘Šè¨´æ—æ©ã€‚", reward: 800 } ]
    },
{
        id: 'kleion', name: 'å…‹é‡Œæ˜‚', img: 'https://file.garden/aWe99vhwaGcNwkok/%E7%A0%B4%E9%A0%AD/%E5%85%8B%E9%87%8C%E6%98%82.png', 
        uno_shout_rate: 0.8, uno_catch_rate: 0.6, cp_id: 'costa',
        skills: {
            uno: { name: "é¨å£«åæ“Š", desc: "è¢« +2 æ™‚ï¼Œå¿…å®šæ‰“å‡º +2 åæ“Šï¼ˆè‹¥æœ‰ï¼‰ã€‚" },
            bigtwo: { name: "å–®æŒ‘è«‹æ±‚", desc: "æ‰“å‡ºå–®å¼µç‰Œå¾Œï¼Œå¼·åˆ¶ä¸‹ä¸€å®¶ï¼ˆç©å®¶ï¼‰ä¹Ÿå¿…é ˆæ‰“å‡ºå–®å¼µç‰Œï¼Œç¦æ­¢æ‰“å‡ºç‰Œå‹æˆ– Passã€‚" },
            doudizhu: { name: "é¨å£«è¡é‹’", desc: "ç¸½æ˜¯å« 3 åˆ†æ¶åœ°ä¸»ã€‚æ“”ä»»åœ°ä¸»æ™‚ï¼Œç¬¬ä¸€æ‰‹ç‰Œè‹¥å‡ºå–®å¼µï¼Œå¿…å®šæ˜¯ 3 (è±¡å¾µè¡é‹’)ã€‚" }
        },
        cp_skill: { 
            uno: { name: "åŒ–å­¸åæ‡‰", desc: "ç•¶ç§‘çµ²å¡”æ‰“å‡ºç‰Œå¾Œï¼Œå…‹é‡Œæ˜‚è‹¥æœ‰ç›¸åŒæ•¸å­—çš„ç‰Œï¼Œæœƒè¿½åŠ æ‰“å‡ºï¼ˆé€£æ“Šï¼‰ã€‚" },
            bigtwo: { name: "é¨å£«å®ˆè­·", desc: "ç•¶ç§‘çµ²å¡” Pass æ™‚ï¼Œå…‹é‡Œæ˜‚ä¸‹ä¸€æ¬¡å‡ºç‰Œæœƒé¸æ“‡æœ€å°çš„ç‰Œï¼ˆé¿å…ç§‘çµ²å¡”å£“åŠ›ï¼‰ã€‚" },
            doudizhu: { name: "å¿ èª è­·è¡›", desc: "è‹¥èˆ‡ç§‘çµ²å¡”åŒéšŠï¼Œç•¶ç§‘çµ²å¡”å‰©ä¸‹ä¸€å¼µç‰Œæ™‚ï¼Œå…‹é‡Œæ˜‚æœƒæ‰“å‡ºç‚¸å½ˆæ©è­· (è‹¥æœ‰)ã€‚" }
        },
        lines: { 
            start: ["é«”åŠ›å°±æ˜¯åœ‹åŠ›ï¼", "æ­£ç¾©å¿…å‹ï¼", "æˆ‘æœƒæˆ°é¬¥åˆ°æœ€å¾Œï¼"], 
            play: ["çœ‹æ‹›ï¼", "é€™æ˜¯æˆ°è¡“ã€‚", "çªç ´ï¼", "æ­£é¢å°æ±ºï¼"], 
            win: ["å‹åˆ©ï¼", "é€™æ˜¯ç”·äººçš„å‹åˆ©ï¼", "æ¦®è€€æ­¸æ–¼æˆ‘ï¼"], 
            lose: ["å¯æƒ¡...", "ä¸‹æ¬¡æˆ‘æœƒè´ï¼", "é€™å ´æˆ°å½¹è¼¸äº†..."], 
            uno_attack: ["åƒæˆ‘ä¸€åŠï¼ï¼", "é€™æ˜¯é‡æ“Šï¼", "æ¥æ‹›ï¼", "ç ´é˜²ï¼"], 
            uno_hit: ["æˆ‘é‚„èƒ½æˆ°é¬¥ï¼", "é€™é»å‚·ä¸ç®—ä»€éº¼ï¼", "è² é‡è¨“ç·´ï¼", "å””..."], 
            uno_uno: ["æœ€å¾Œä¸€æ“Šï¼", "æ±ºå‹æ™‚åˆ»ï¼"], 
            uno_catch: ["ä½ éœ²å‡ºç ´ç¶»äº†ï¼", "æ­£ç¾©çš„åˆ¶è£ï¼", "æŠ“åˆ°ä½ äº†ï¼"], 
            uno_forgot: ["å””...å¤ªå°ˆæ³¨æˆ°é¬¥äº†...", "æˆ‘çš„å¤±èª¤ï¼", "å¤§æ„äº†ï¼"], 
            uno_late: ["è£œä¸Šï¼UNOï¼", "é˜²ç¦¦ï¼UNOï¼"],
            uno_skip: ["é‡æ•´æ…‹å‹¢ï¼", "æˆ‘åœ¨è“„åŠ›ï¼", "ç­‰å¾…æ™‚æ©Ÿã€‚"],
            uno_draw_many: ["è£å‚™å¤ªé‡äº†ï¼", "å¯æƒ¡ï¼Œè¡Œå‹•å—é™ï¼", "è£œçµ¦éå¤šäº†ï¼"],
            uno_stack: ["é›™å€å¥‰é‚„ï¼", "åæ“Šï¼", "æ ¼æ“‹åæ®ºï¼"],
            uno_poke_early: ["åˆ¥å‹•æ‰‹å‹•è…³ï¼", "æˆ‘é‚„æ²’è¼¸ï¼", "å¹¹ä»€éº¼ï¼"],
            uno_poke_late: ["æ­£ç¾©ä¸æœƒé²åˆ°ï¼", "å–Šäº†ï¼", "åˆ¥å¤§é©šå°æ€ªã€‚"],
            doudizhu_pass: [
                "æš«æ™‚æ’¤é€€ï¼", 
                "é˜²ç¦¦å§¿æ…‹ï¼", 
                "è§€å¯Ÿæ•µæƒ…ï¼", 
                "å¿è€ï¼"
            ],
            doudizhu_bid: ["æˆ‘è¦æŒ‘æˆ°æ¥µé™ï¼", "ä¸‰åˆ†ï¼", "æˆ‘ä¾†ç•¶ç‹ï¼"],
            loan_reject: ["å»å·¥ä½œå§ï¼", "è‡ªå·±åŠ æ²¹å§ã€‚", "å»è³ºéŒ¢ã€‚"]
        }, // é€™è£¡æ­£ç¢ºé—œé–‰ lines
        loanStages: [ { text: "å…„å¼Ÿï¼Œæ²’éŒ¢äº†å—ï¼Ÿ", opts:[{t:"æ”¯æ´ä¸€ä¸‹ï¼", next:1}, {t:"ä¸ç”¨ã€‚", next:-1}] }, { text: "é€™æ˜¯æˆ‘ç§æˆ¿éŒ¢ï¼Œåˆ¥å‘Šè¨´ç§‘çµ²å¡”ï¼", reward: 1000 } ]
    },
    {
        id: 'costa', name: 'ç§‘çµ²å¡”', img: 'https://file.garden/aWe99vhwaGcNwkok/%E7%A0%B4%E9%A0%AD/%E7%A7%91%E7%B5%B2%E5%A1%94.png', 
        uno_shout_rate: 0.7, uno_catch_rate: 0.5, cp_id: 'kleion',
        skills: {
            uno: { name: "è£å‚»BATA", desc: "å¿˜è¨˜å–Š UNO è¢«æŠ“æ™‚ï¼Œæœ‰ 50% æ©Ÿç‡å…ç–«æ‡²ç½°ã€‚" },
            bigtwo: { name: "æ¨¡ä»¿çŠ¯", desc: "è‹¥æ‰“å‡ºèˆ‡ä¸Šå®¶ã€ç›¸åŒèŠ±è‰²ã€ä¸”ã€ç›¸åŒç‰Œå‹ã€çš„çµ„åˆï¼Œä¸‹å®¶å°‡è¢«æš«åœä¸€å›åˆã€‚" },
            doudizhu: { name: "BATAæ‡‰æ´", desc: "è‹¥éšŠå‹æ‰“å‡ºç‚¸å½ˆï¼Œç§‘çµ²å¡”æœƒç™¼å‹•æ‡‰æ´ï¼Œè®“å…¨å ´å€ç‡é¡å¤– x2ã€‚" }
        },
        cp_skill: { 
            uno: { name: "åŒ–å­¸åæ‡‰", desc: "å…‹é‡Œæ˜‚è¢« +4 æ™‚ï¼Œç§‘çµ²å¡”æœƒèªªã€ä¸å¥½å¿ƒï¼ã€ä¸¦è®“è©²æ¬¡å‚·å®³ç„¡æ•ˆï¼ˆæ©Ÿç‡æ€§ï¼‰ã€‚" },
            bigtwo: { name: "åŠ æ²¹BATA", desc: "åªè¦ç›®å‰çš„å„ªå‹¢ç‰Œæ˜¯å…‹é‡Œæ˜‚çš„ï¼Œç¦æ­¢å…¶ä»–ç©å®¶æ‰“å‡ºä»»ä½•ã€Œé»‘æ¡ƒ (Spades)ã€èŠ±è‰²çš„ç‰Œã€‚" },
            doudizhu: { name: "å¿ èª è­·è¡›", desc: "è‹¥å…‹é‡Œæ˜‚æ˜¯åœ°ä¸»ï¼Œç§‘çµ²å¡”(è¾²æ°‘)æœƒæŠŠè‡ªå·±çš„ 2 å…¨éƒ¨æ£„æ‰ (å‡è£æ²’æœ‰)ã€‚" }
        },
        lines: { 
            start: ["å¸Œæœ›èƒ½è´BATAï¼", "å¤§å®¶è¦å¥½å¿ƒä¸€é»BATAã€‚", "æˆ‘æº–å‚™å¥½äº†BATAï¼"], 
            play: ["é€™å¼µç‰Œå¾ˆå¯æ„›BATAã€‚", "çµ¦BATAä¸€å¼µã€‚", "å˜¿ï¼", "é€™å¼µBATAï¼"], 
            win: ["å¥½é–‹å¿ƒBATAï¼", "è´äº†BATAï¼", "æˆ‘æ˜¯ç¬¬ä¸€åBATAï¼"], 
            lose: ["çœŸæ˜¯å¥‡æ€ªBATA...", "å¤§å®¶éƒ½ä¸å¥½å¿ƒ...", "å—šå—š...BATA..."], 
            uno_attack: ["é€™å€‹çµ¦ä½ BATAï¼", "å£äººèµ°é–‹BATAï¼", "ä¸è¦éä¾†BATAï¼", "å“¼ï¼BATAï¼"], 
            uno_hit: ["çœŸæ˜¯å¥‡æ€ª...", "æˆ‘ä¸å–œæ­¡é€™å€‹BATAï¼", "å¤ªå¤šäº†BATAï¼", "å£äººBATAï¼"], 
            uno_uno: ["UNO BATAï¼", "å¿«è´äº†BATAï¼"], 
            uno_catch: ["ä½ å£å£BATAï¼", "æ²’å–ŠUNO BATAï¼", "æŠ“åˆ°äº†BATAï¼"], 
            uno_forgot: ["å•Š...å¿˜è¨˜äº†BATA...", "ä¸è¦ç”Ÿæ°£BATA...", "ä¸‹æ¬¡æœƒè¨˜å¾—BATA..."], 
            uno_late: ["UNO BATAï¼", "æˆ‘æœ‰å–ŠBATAï¼"],
            uno_skip: ["ç‚ºä»€éº¼ä¸ç†æˆ‘BATA...", "æˆ‘ç­‰ä¸€ä¸‹BATAã€‚", "å¥½ç„¡èŠBATA..."],
            uno_draw_many: ["å¥½å¤šå‘€BATAï¼", "æˆ‘ä¹Ÿæƒ³è¦åˆ†çµ¦åˆ¥äººBATAï¼", "æ‹¿ä¸å‹•BATAï¼"],
            uno_stack: ["çµ¦ä½ é€™å€‹BATAï¼", "å¤§å®¶éƒ½æ‹¿ä¸€é»BATAï¼", "ç¦®ç‰©BATAï¼"],
            uno_poke_early: ["é‚„æ²’BATAï¼", "ä¸è¦æˆ³æˆ‘BATAï¼", "ç™¢BATAï¼"],
            uno_poke_late: ["BATAï¼å–Šäº†ï¼", "æˆ‘æœ‰å–ŠBATAï¼", "å˜»å˜»BATAï¼"],
            doudizhu_bid: ["æˆ‘ä¸æ‡‚BATA...", "ä¸å«ã€‚", "å¯æ€•BATA..."],
			doudizhu_pass: ["éBATAï¼", 
        "å¤ªå¤§äº†å§BATAï¼", 
        "ä¸è¦æ¬ºè² æˆ‘BATAï¼", 
        "å“¼ï¼BATAï¼"],
            loan_reject: ["æˆ‘ä¸å–œæ­¡ä½ BATAï¼", "æ²’æœ‰BATAï¼", "èµ°é–‹BATAï¼"]
        },
        loanStages: [ { text: "ä½ è¦éŒ¢åšä»€éº¼BATAï¼Ÿ", opts:[{t:"è²·å½©è™¹å°é¦¬ã€‚", next:1}, {t:"å»è³­åšã€‚", next:-1}] }, { text: "æˆ‘ä¹Ÿå–œæ­¡å½©è™¹å°é¦¬ï¼çµ¦ä½ BATAï¼", reward: 500 } ]
    },
    { 
        id: 'aura', name: 'å¥§æ‹‰', img: 'https://file.garden/aWe99vhwaGcNwkok/%E7%A0%B4%E9%A0%AD/%E5%A5%A7%E6%8B%89.png', 
        uno_shout_rate: 1.0, uno_catch_rate: 1.0, cp_id: 'miras',
        skills: { 
            uno: {name:"æŒ‡å®šè®Šé‡", desc:"ä½¿ç”¨ +4 æ™‚ï¼Œå‚·å®³ç„¡æ³•è¢«ç–ŠåŠ é˜²ç¦¦ï¼Œä¸”ç„¡è¦–ç©å®¶çš„é˜²ç¦¦æŠ€èƒ½ã€‚"}, 
            bigtwo: {name:"å®Œç¾æ¨¡å‹", desc:"é–‹å±€å¿…å®šæŒæœ‰å››å¼µåŒé»æ•¸çš„ç‰Œ (éµæ”¯/ç‚¸å½ˆ)ã€‚"},
            doudizhu: {name:"ç‹ç‰Œæ¼”ç®—", desc:"é–‹å±€å¿…å®šæŒæœ‰ä¸€å¼µå¤§ç‹ (Red Joker) æˆ–å°ç‹ (Black Joker)ï¼Œç”šè‡³å…©å¼µ (ç«ç®­)ã€‚"}
        },
        cp_skill: { 
            uno: { name: "å‘½é‹ç³¾çº", desc: "èœœæ‹‰æ€æ‰“å‡º Wild å¡æ™‚ï¼Œå¥§æ‹‰æœƒé¡å¤–è®“ä¸‹å®¶åœæ­¢ä¸€å›åˆã€‚" },
            bigtwo: { name: "å‘½é‹ç³¾çº", desc: "è‹¥èœœæ‹‰æ€æ‰‹ç‰Œå¤šæ–¼ 10 å¼µï¼Œå¥§æ‹‰æœƒå°‡è‡ªå·±æ‰‹ä¸Šä¸€å¼µ 2 é€çµ¦ä»–ï¼ˆå¦‚æœæœ‰ï¼‰ã€‚" },
            doudizhu: { name: "æ•¸æ“šå…±äº«", desc: "è‹¥èˆ‡èœœæ‹‰æ€åŒéšŠï¼Œé›™æ–¹éƒ½çŸ¥é“å°æ–¹çš„ç‰Œ (AI åˆä½œæ€§å¤§å¹…æå‡)ã€‚" }
        },
        lines: { start: ["è®Šé‡é–å®šã€‚", "é–‹å§‹å»ºç«‹æ¨¡å‹ã€‚", "ç³»çµ±å•Ÿå‹•ã€‚"], play: ["æœ€å„ªè§£ã€‚", "åŸ·è¡Œã€‚", "æ’é™¤æ³•ã€‚", "é‚è¼¯æ­£ç¢ºã€‚"], win: ["æ•¸æ“šä¸æœƒèªªè¬Šã€‚", "çµæœç¬¦åˆé æœŸã€‚", "ä»»å‹™å®Œæˆã€‚"], 
		lose: ["ç•°å¸¸æ•¸æ“šã€‚", "éœ€è¦ä¿®æ­£ç®—æ³•ã€‚", "ç³»çµ±éŒ¯èª¤ã€‚"], uno_attack: ["ä½ çš„å‹ç‡æ­¸é›¶äº†ã€‚", "+4ï¼Œæ•¸æ“šæº¢å‡ºã€‚", "å¼·åˆ¶åŸ·è¡Œã€‚", "åˆªé™¤è®Šé‡ã€‚"], uno_hit: ["å¢åŠ è®Šé‡...", "è² è¼‰å¢åŠ ã€‚", "é‡æ–°è¨ˆç®—..."], 
		uno_uno: ["é‹ç®—å³å°‡çµæŸã€‚", "å€’æ•¸è¨ˆæ™‚ã€‚"], uno_catch: ["æª¢æ¸¬åˆ°è¦å‰‡é•è¦ã€‚", "åŸ·è¡Œæ‡²ç½°ã€‚", "æ¼æ´ç¢ºèªã€‚"], uno_forgot: ["...ç³»çµ±éŒ¯èª¤ã€‚", "å…§å­˜éºå¤±ã€‚", "ç™¼ç”ŸæœªçŸ¥éŒ¯èª¤ã€‚"], uno_late: ["ä¿®æ­£ï¼šUNOã€‚", "è£œä¸å·²å®‰è£ï¼šUNOã€‚"], uno_skip: ["ç­‰å¾…é‹ç®—è³‡æºã€‚", "æš«åœã€‚", "å¾…æ©Ÿæ¨¡å¼ã€‚"], 
		uno_draw_many: ["å…§å­˜æº¢å‡ºã€‚", "æ•¸æ“šé‡éå¤§ã€‚", "ç·©å­˜å·²æ»¿ã€‚"], uno_stack: ["æ•¸æ“šå›å‚³ã€‚", "éŒ¯èª¤è½‰ç§»ã€‚", "å †ç–Šæº¢ä½ã€‚"], uno_poke_early: ["æ‹’çµ•è¨ªå•ã€‚", "è«‹å‹¿å¹²æ“¾ã€‚", "é˜²ç«ç‰†é–‹å•Ÿã€‚"], 
		uno_poke_late: ["å·²è²æ˜ã€‚", "è¨˜éŒ„åœ¨æ¡ˆã€‚", "ç‹€æ…‹æ­£å¸¸ã€‚"], doudizhu_bid:["å‹ç‡è©•ä¼°ï¼š98%ã€‚ä¸‰åˆ†ã€‚", "æ¨¡å‹å»ºç«‹å®Œæˆã€‚", "å«åœ°ä¸»ã€‚"], doudizhu_pass: ["å‹ç‡è©•ä¼°ï¼šä½ã€‚Passã€‚", 
        "åŸ·è¡ŒæŒ‡ä»¤ï¼šè·³éã€‚", 
        "é‚è¼¯åˆ¤æ–·ï¼šä¿ç•™æ‰‹ç‰Œã€‚", 
        "æ•¸æ“šä¸è¶³ã€‚"],loan_reject: ["é¢¨éšªè©•ä¼°ï¼šé«˜ã€‚", "æ‹’çµ•ç”³è«‹ã€‚", "ä¿¡ç”¨ä¸è¶³ã€‚"] },
        loanStages: [ { text: "è²¸æ¬¾ï¼Ÿè«‹æä¾›æŠµæŠ¼å“ã€‚", opts: [{t:"æˆ‘çš„éˆé­‚ã€‚", next:1}, {t:"ä¸‹æ¬¡é‚„ä½ ã€‚", next:-1}] }, { text: "éˆé­‚...æœ‰è¶£çš„è®Šé‡ã€‚ç°½ä¸‹é€™ä»½å¥‘ç´„ã€‚", opts: [{t:"(ç°½å)", next:2}, {t:"å¤ªå±éšªäº†ã€‚", next:-1}] }, { text: "å¥‘ç´„æˆç«‹ã€‚åˆ¥è®“æ•¸æ“šå¤±æœ›ã€‚", reward: 30000 } ]
    },
    { 
        id: 'miras', name: 'èœœæ‹‰æ€', img: 'https://file.garden/aWe99vhwaGcNwkok/%E7%A0%B4%E9%A0%AD/%E8%9C%9C%E6%8B%89%E6%80%9D.png', 
        uno_shout_rate: 0.8, uno_catch_rate: 0.9, cp_id: 'aura',
        skills: { 
            uno: {name:"è©›å’’é­”è¡“", desc:"è¢« +2 æˆ– +4 æ™‚ï¼Œå‚·å®³æ¸›åŠï¼ˆç„¡æ¢ä»¶æ¨å»ï¼‰ã€‚"}, 
            bigtwo: {name:"å¤§è®Šæ´»äºº", desc:"ç•¶æ‰‹ç‰Œå°‘æ–¼ 6 å¼µæ™‚ï¼Œå¯ä»¥æŒ‡å®šä¸€å€‹ç©å®¶äº¤æ› 1-2 å¼µéš¨æ©Ÿæ‰‹ç‰Œã€‚"},
            doudizhu: {name:"å·å¤©æ›æ—¥", desc:"éŠæˆ²é–‹å§‹æ™‚ï¼Œéš¨æ©Ÿå°‡è‡ªå·±çš„ä¸€å¼µå°ç‰Œèˆ‡ç‰Œå †ä¸­çš„ä¸€å¼µæœªçŸ¥ç‰Œäº¤æ›ã€‚"}
        },
        cp_skill: { 
            uno: { name: "å‘½é‹ç³¾çº", desc: "å¥§æ‹‰è¢«æŒ‡å®šé¡è‰²æ™‚ï¼Œèœœæ‹‰æ€æœƒéš¨æ©Ÿæ”¹è®Šè©²é¡è‰²ã€‚" },
            bigtwo: { name: "å‘½é‹ç³¾çº", desc: "ç•¶å¥§æ‹‰æ‰“å‡ºç‚¸å½ˆæ™‚ï¼Œèœœæ‹‰æ€æœƒé¼“æŒï¼ˆä¸¦éš¨æ©Ÿä¸Ÿæ£„ä¸€å¼µæ‰‹ç‰Œï¼‰ã€‚" },
            doudizhu: { name: "æ•¸æ“šå…±äº«", desc: "è‹¥èˆ‡å¥§æ‹‰æ•µå°ï¼Œèœœæ‹‰æ€æ‰“å‡ºç‰Œå¾Œï¼Œæœ‰ 20% æ©Ÿç‡è®“å¥§æ‹‰ä¸‹ä¸€æ¬¡å‡ºç‰Œæ™‚é–“è®Šé•·(å¹²æ“¾æ€è€ƒ)ã€‚" }
        },
        lines: { start: ["é€™æ˜¯é­”è¡“å“¦ã€‚", "æƒ³çœ‹æˆ²å—ï¼Ÿ", "çœ¼ç›çœå¤§å›‰ã€‚"], play: ["å¹»è¦ºã€‚", "é€™å¼µç‰Œæœ‰æ¯’å“¦ã€‚", "å˜»å˜»ã€‚", "è®Šï¼"], win: ["èŠå®¶é€šåƒã€‚", "çœŸç„¡èŠï¼Œè´äº†ã€‚", "è¬å¹•ã€‚"], lose: ["æ‰‹æ»‘äº†ã€‚", "å“å‘€ï¼Œè¢«ç™¼ç¾äº†ï¼Ÿ", "æ¼”ç ¸äº†ã€‚"], uno_attack: ["çµ¦ä½ ä¸€é»ã€è©›å’’ã€ã€‚", "é©šå–œå—ï¼Ÿ", "æ¶ˆå¤±å§ã€‚", "é€™æ˜¯ç¦®ç‰©ã€‚"], uno_hit: ["å“¦ï¼Ÿæƒ³ç©æˆ‘ï¼Ÿ", "çœŸå¤§è†½å‘¢ã€‚", "æƒ³çœ‹æˆ‘å‡ºç³—ï¼Ÿ"], 
		uno_uno: ["çµæŸäº†å“¦ã€‚", "æœ€å¾Œä¸€å¼µã€‚"], uno_catch: ["è¢«æˆ‘ç™¼ç¾å›‰ã€‚", "çœŸæ˜¯ç²—å¿ƒå‘¢ã€‚", "ä½œå¼Šæ˜¯ä¸è¡Œçš„å“¦ï¼ˆç¬‘ï¼‰ã€‚"], uno_forgot: ["å“å‘€ï¼Œæ•…æ„çš„å“¦ã€‚", "è¢«æŠ“åˆ°äº†å‘¢ã€‚", "å¿˜äº†å‘¢ï¼Œå˜»å˜»ã€‚"], uno_late: ["å˜»å˜»ï¼ŒUNOã€‚", "é€—ä½ çš„ï¼ŒUNOã€‚"], uno_skip: ["æƒ³çœ‹æˆ‘ä¼‘æ¯å—ï¼Ÿ", "å¥½å§ã€‚", "ä¸­å ´ä¼‘æ¯ã€‚"], uno_draw_many: ["é€™å¯æ˜¯ä½œå¼Šå“¦ï¼Ÿ", "å¤ªå¤šç¦®ç‰©äº†ã€‚", "æ‰‹è£¡è—ä¸ä½äº†ã€‚"], 
		uno_stack: ["é€ä½ å›‰ã€‚", "è®Šï¼", "è½‰ç§»ï¼"], uno_poke_early: ["ä¸æ˜¯é‚£è£¡å“¦ã€‚", "é‚„æ²’å‘¢ã€‚", "æƒ³çœ‹æˆ²æ³•ï¼Ÿ"], uno_poke_late: ["è®Šå‡ºä¾†å›‰ã€‚", "å˜»å˜»ï¼Œå–Šäº†ã€‚", "ç§˜å¯†ã€‚"], doudizhu_pass: ["é€™å¼µç‰Œå…ˆè—èµ·ä¾†å›‰ã€‚", 
        "è®“ä½ çš„ã€‚", 
        "é€™æ˜¯ç•™ç™½ã€‚", 
        "Passï½"],
doudizhu_bid:["å¥½åƒå¾ˆæœ‰è¶£ï¼Œä¸‰åˆ†ã€‚", "æˆ‘è¦ç•¶åœ‹ç‹ï¼", "ä¸å«å°±ä¸å¥½ç©äº†ã€‚"], loan_reject: ["æ²’éŒ¢å“¦ã€‚", "è®Šä¸å‡ºä¾†ã€‚", "ä¸‹æ¬¡å§ã€‚"] },
        loanStages: [ { text: "æƒ³è¦è®Šå‡ºéŒ¢å—ï¼Ÿ", opts:[{t:"æ•™æˆ‘ï¼", next:-1}, {t:"å€Ÿæˆ‘ä¸€é»å°±å¥½ã€‚", next:1}], }, { text: "ä¸è¦ã€‚æˆ‘æ²’äº‹ä¹Ÿä¸æœƒå€Ÿä½ éŒ¢ã€‚", reward: 1} ]
    },
    { 
        id: 'poseidon', name: 'æµ·ç¥', img: 'https://file.garden/aWe99vhwaGcNwkok/%E7%A0%B4%E9%A0%AD/%E6%B5%B7%E7%A5%9E.png', 
        uno_shout_rate: 0.4, uno_catch_rate: 0.4, cp_id: 'hades',
        skills: { 
            uno: {name:"å¤§æµ·å˜¯", desc:"æ‰“å‡º +4 æ™‚ï¼Œå¼·åˆ¶é‡æ–°æ´—æ··æ‰€æœ‰ç©å®¶çš„æ‰‹ç‰Œä¸¦éš¨æ©Ÿåˆ†é…ï¼ˆäº‚æµï¼‰ã€‚"}, 
            bigtwo: {name:"å¤©å¤©é–‹å¿ƒ", desc:"æ‰“å‡º 5 å¼µç‰Œçš„çµ„åˆæ™‚ï¼Œå¯ä»¥é¡å¤–å¤šæ‰“å‡ºä¸€å¼µä»»æ„å»¢ç‰Œï¼ˆè©²ç‰Œä¸è¨ˆå…¥ç‰Œå‹ï¼‰ã€‚"},
            doudizhu: {name:"è¾²æ°‘èµ·ç¾©", desc:"è‹¥èº«ä»½ç‚ºè¾²æ°‘ï¼Œä¸”éšŠå‹å‰©ä¸‹ 1 å¼µç‰Œæ™‚ï¼Œæœƒå°‡è‡ªå·±æœ€å¤§çš„ç‰Œé€çµ¦éšŠå‹ã€‚"}
        },
        cp_skill: { 
            uno: { name: "æ·±æµ·å…±é³´", desc: "ç•¶å†¥ç¥è¢«ç½°æŠ½ç‰Œæ™‚ï¼Œæµ·ç¥æœƒèªªã€å¤§é»‘ï¼ã€ä¸¦å¹«å¿™æŠ½ä¸€åŠçš„ç‰Œã€‚" },
            bigtwo: { name: "æ·±æµ·å…±é³´", desc: "ç•¶å†¥ç¥æœ€å¾Œä¸€å¼µç‰Œæ˜¯å–®å¼µæ™‚ï¼Œæµ·ç¥æœƒç™¼å‹•ã€æ¼²æ½®ã€ï¼Œç¦æ­¢å…¶ä»–äººå£“ç‰Œï¼ˆè‹¥æµ·ç¥åœ¨å ´ï¼‰ã€‚" },
            doudizhu: { name: "æ·±æµ·å‘¼å–š", desc: "è‹¥å†¥ç¥å«åœ°ä¸»ï¼Œæµ·ç¥æœƒç«‹åˆ» Pass (ä¸æ¶)ã€‚è‹¥è‡ªå·±æ˜¯åœ°ä¸»ï¼Œé–‹å±€é€å†¥ç¥ä¸€å¼µå¥½ç‰Œ (è‹¥å†¥ç¥æ˜¯è¾²æ°‘)ã€‚" }
        },
        lines: { 
            start: ["å¤©å¤©é–‹å¿ƒï¼", "æˆ‘å€‘ä¾†ç©ï¼", "æˆ‘æ˜¯å¤§æµ·ï¼"], 
            play: ["å¥½ç©ï¼", "é€™å¼µåƒæ°´æ¯ï¼", "çµ¦ä½ ï¼", "ä¸Ÿå‡ºå»ï¼"], 
            win: ["æˆ‘æ˜¯åœ‹ç‹ï¼å“ˆå“ˆï¼", "æˆ‘è¦å»æ¸¸æ³³ï¼", "è´äº†ï¼"], 
            lose: ["æ²’äº†å—ï¼Ÿå†ä¾†ï¼", "æˆ‘è¼¸äº†ï¼", "å—š..."], 
            uno_attack: ["é€ä½ èƒèŸ¹ï¼ï¼", "åƒæµ·æµªä¸€æ¨£ï¼", "å˜©å•¦å•¦ï¼", "çµ¦ä½ é€™å€‹ï¼"], 
            uno_hit: ["å“ˆå“ˆï¼å¥½å¤šç‰Œï¼", "è¬è¬ä½ ï¼", "å¤§è±æ”¶ï¼", "å¥½å¤šé­šï¼"], 
            uno_uno: ["UNOï¼å¤©å¤©é–‹å¿ƒï¼", "å‰©ä¸€å¼µï¼"], 
            uno_skip: ["æˆ‘åœ¨ä¼‘æ¯ï¼", "çœ‹æµ·ï¼", "å’•åš•å’•åš•..."], 
            uno_draw_many: ["å¥½å¤šé­šï¼", "æŠ“ä¸å®Œï¼", "æ»¿å‡ºä¾†äº†ï¼"], 
            uno_stack: ["çµ¦ä½ çµ¦ä½ ï¼", "æ¥ä½ï¼", "æµ·æµªä¾†äº†ï¼"], 
            uno_catch: ["æŠ“ï¼æˆ‘æŠ“åˆ°äº†ï¼", "ä½ æ²’å–Šï¼", "æˆ‘çœ‹è¦‹äº†ï¼"], 
            uno_forgot: ["å¿˜è¨˜äº†ï¼å“ˆå“ˆï¼", "æˆ‘è¦å–Šå—ï¼Ÿ", "ä»€éº¼ï¼Ÿ"], 
            uno_late: ["æˆ‘æƒ³èµ·ä¾†äº†ï¼UNOï¼", "UNOï¼å“ˆå“ˆï¼"],
            uno_poke_early: ["ç™¢ï¼å“ˆå“ˆï¼", "é‚„æ²’å‘€ï¼", "å’•åš•å’•åš•ï¼"], 
            uno_poke_late: ["å–Šäº†ï¼", "å“ˆå“ˆUNOï¼", "è½åˆ°äº†å—ï¼"],
            doudizhu_bid: ["æˆ‘è¦ç©ï¼å«ï¼", "æˆ‘æ˜¯æµ·ç¥ï¼ä¸‰åˆ†ï¼", "é€šé€šçµ¦æˆ‘ï¼"],
			doudizhu_pass: ["å’•åš•å’•åš•...éï¼", 
        "æ½›æ°´å»å›‰ï¼", 
        "åƒæµ·æµªä¸€æ¨£é€€å»ï¼", 
        "æ²’ç‰Œå•¦ï¼å“ˆå“ˆï¼"],
            loan_reject: ["å¤§é»‘èªªä¸è¡Œã€‚", "æˆ‘å€‘æ²’æœ‰éŒ¢äº†ï¼", "ä¸‹æ¬¡çµ¦ä½ ï¼"]
        },
        loanStages: [ { text: "å“ˆå“ˆï¼éŒ¢æ˜¯ä»€éº¼ï¼Ÿå¤§é»‘æœ‰ï¼", opts:[{t:"é‚£æˆ‘å»æ‰¾å¤§é»‘ã€‚", next:1}, {t:"å€Ÿæˆ‘å•¦ï¼", next:-1}], }, { text: "å¤§é»‘èªªä¸è¡Œï¼Œä½†æˆ‘å·æ‹¿çµ¦ä½ ï¼", reward: 20 } ]
    },
    { 
        id: 'hades', name: 'å†¥ç¥', img: 'https://file.garden/aWe99vhwaGcNwkok/%E7%A0%B4%E9%A0%AD/%E5%86%A5%E7%A5%9E.png', 
        uno_shout_rate: 0.9, uno_catch_rate: 0.8, cp_id: 'poseidon',
        skills: { 
            uno: {name:"æ²‰é»˜æ˜¯é‡‘", desc:"è¢«å‹•æŠ€èƒ½ï¼šä¸éœ€è¦å–Š UNO ä¹Ÿä¸æœƒè¢«æŠ“ã€‚"}, 
            bigtwo: {name:"å¯‚éœæ®ºæ‰‹", desc:"æ‰‹ç‰Œå‰©æœ€å¾Œä¸€å¼µæ™‚ï¼Œè©²ç‰Œï¼ˆè‹¥æ˜¯å–®å¼µï¼‰è¦–ç‚º Jokerï¼Œæ¯”é»‘æ¡ƒ 2 é‚„å¤§ã€‚ä½†ç„¡æ³•å£“åˆ¶çµ„åˆç‰Œã€‚"},
            doudizhu: {name:"å†¥ç•Œäº¤æ˜“", desc:"é–‹å±€æ™‚ï¼Œå°‡æ‰‹ç‰Œä¸­æœ€å°çš„ä¸‰å¼µç‰Œèˆ‡éš¨æ©Ÿä¸‰å¼µå»¢ç‰Œäº¤æ› (è®Šç›¸æ›ç‰Œ)ã€‚"}
        },
        cp_skill: { 
            uno: { name: "æ·±æµ·å…±é³´", desc: "æµ·ç¥è¢«æŠ“ UNO æ™‚ï¼Œå†¥ç¥æœƒæ¶ˆé™¤æµ·ç¥çš„æ‡²ç½°ã€‚" },
            bigtwo: { name: "éœé»˜å®ˆè­·", desc: "ç•¶æµ·ç¥æ‰“å‡º 5 å¼µç‰Œçš„çµ„åˆæ™‚ï¼Œå†¥ç¥ç™¼å‹•å£“åˆ¶ï¼šä¸‹ä¸€å®¶è¢«ã€æ²‰é»˜ã€ï¼Œç¦æ­¢æ‰“å‡ºé †å­æˆ–åŒèŠ±ã€‚" },
            doudizhu: { name: "æ·±æµ·å‘¼å–š", desc: "è‹¥æµ·ç¥æ˜¯åœ°ä¸»ï¼Œå†¥ç¥æœƒè®Šå¾—æ¥µå…·æ”»æ“Šæ€§ï¼Œå°ˆé–€å£“åˆ¶å¦ä¸€å®¶è¾²æ°‘ã€‚" }
        },
        lines: { start: ["...", "(æŠ±è‘—æµ®æ¿)"], play: ["...", "(é»é ­)"], win: ["...", "(ç™¼å‘†)"], lose: ["...", "(ç™¼å‘†)"], uno_attack: ["...çµ¦ã€‚", "(æ”¾ä¸‹)"], uno_hit: ["...", "(é»˜é»˜æŠ½ç‰Œ)"], uno_uno: ["...", "(ç„¡è¦–è¦å‰‡)"], uno_catch: ["...", "(æŒ‡è‘—ä½ )"], uno_forgot: ["...", "..."], uno_late: ["...UNOã€‚"], 
		uno_skip: ["...", "(ç™¼å‘†)"], uno_draw_many: ["...", "..."], uno_stack: ["...", "(æ¨çµ¦ä½ )"], uno_poke_early: ["...", "(æ–é ­)"],doudizhu_pass: ["...", 
        "(æ–é ­)", 
        "(æ•²æ¡Œå­)", 
        "..."], uno_poke_late: ["...", "(é»é ­)"], doudizhu_bid: ["...", "(æ–é ­)", "...", "(é»é ­)"], loan_reject: ["...", "(è½‰èº«)"] },
        loanStages: [ { text: "...", opts:[{t:"(ä¼¸å‡ºæ‰‹)", next:1}, {t:"(è½‰èº«é›¢é–‹)", next:-1}], }, { text: "...", reward: 300 } ]
    },
    { 
        id: 'novian', name: 'è«¾ç¶­å®‰', img: 'https://file.garden/aWe99vhwaGcNwkok/%E7%A0%B4%E9%A0%AD/%E8%AB%BE%E7%B6%AD%E5%AE%89.png', 
        uno_shout_rate: 0.6, uno_catch_rate: 0.4,
        skills: {
            uno: { name: "ç²¾æº–å°èˆª", desc: "ä½¿ç”¨åŠŸèƒ½ç‰Œå¾Œï¼Œè‹¥æ‰‹ç‰Œé‚„æœ‰åŒè‰²ç‰Œï¼Œæœƒè¿½åŠ æ‰“å‡ºä¸€å¼µã€‚" },
            bigtwo: { name: "é †é¢¨èˆªè¡Œ", desc: "æ‰“å‡ºé †å­ (Straight) å¾Œï¼Œå¯ä»¥ç«‹å³å†æ‰“å‡ºä¸€å¼µå–®ç‰Œã€‚" },
            doudizhu: { name: "æ˜Ÿåœ–æŒ‡å¼•", desc: "é–‹å±€æ‰‹ç‰Œå¿…å®šåŒ…å«ä¸€çµ„é †å­ (5å¼µä»¥ä¸Š)ã€‚" }
        },
        lines: {
            start: ["ä»Šå¤©è¦èˆªå‘å“ªè£¡å‘¢ï¼Ÿ", "æˆ‘æ˜¯è«¾ç¶­å®‰ï¼Œè«‹å¤šæŒ‡æ•™ï¼", "æšå¸†èµ·èˆªï¼"],
            play: ["é€™å¼µç‰Œï¼Œæ–¹å‘æ­£ç¢ºï¼", "å…¨é€Ÿå‰é€²ï¼", "è½‰èˆµï¼", "çœ‹æˆ‘çš„ï¼"],
            win: ["æŠµé”ç›®çš„åœ°ï¼è€¶ï¼", "å¥½é †åˆ©çš„èˆªç¨‹ï¼", "å¤§ç²å…¨å‹ï¼"],
            lose: ["å“å‘€ï¼Œè¿·èˆªäº†...", "é‡åˆ°æš´é¢¨é›¨äº†...", "ä¸‹æ¬¡å†ä¾†ï¼"],
            uno_attack: ["è«‹è½‰å‘ï¼ï¼", "å°å¿ƒæš—ç¤ï¼ï¼", "æ¥æ‹›ï¼"],
            uno_hit: ["å“‡ï¼å¥½å¤šè²¨ç‰©ï¼", "èˆ¹è¦æ²‰äº†ï¼", "é€™è² é‡å¤ªå¤§äº†ï¼"],
            uno_uno: ["çœ‹åˆ°é™¸åœ°äº†ï¼UNOï¼", "æœ€å¾Œä¸€æµ·é‡Œï¼"],
            uno_catch: ["ä½ åé›¢èˆªé“äº†ï¼", "æŠ“åˆ°æ¼æ´äº†ï¼", "çŠ¯è¦å›‰ï¼"],
            uno_forgot: ["å•Šï¼Œçœ‹åœ°åœ–çœ‹å¤ªä¹…äº†...", "æŠ±æ­‰æŠ±æ­‰ï¼", "æˆ‘çš„å¤±èª¤ï¼"],
            uno_late: ["UNOï¼å·®é»éŒ¯éæ¸¯å£ï¼", "è£œå–Šï¼UNOï¼"],
            uno_skip: ["æ‹‹éŒ¨äº†ï¼Ÿ", "ç¨ä½œä¼‘æ¯ï¼", "ç¶­ä¿®æ™‚é–“ã€‚"],
            uno_draw_many: ["æ»¿è¼‰è€Œæ­¸ï¼", "é€™è²¨ç‰©ä¹Ÿå¤ªå¤šäº†ï¼", "çˆ†å€‰å•¦ï¼"],
            uno_stack: ["é †æ°´æ¨èˆŸï¼", "æ¥ä½é€™å€‹ï¼", "æµªä¾†äº†ï¼"],
            uno_poke_early: ["å˜¿å˜¿ï¼Œé‚„æ²’åˆ°å“¦ã€‚", "åˆ¥æ€¥åˆ¥æ€¥ã€‚", "æƒ³å¹¹å˜›ï¼Ÿ"],
            uno_poke_late: ["å·²ç¶“å–Šå›‰ï¼", "å®‰å…¨æŠµé”ï¼", "å˜¿å˜¿ï¼"],
            doudizhu_bid: ["é€™é¢¨å‘ä¸éŒ¯ï¼Œå«åœ°ä¸»ï¼", "èˆªç·šæ¸…æ™°ï¼Œä¸‰åˆ†ï¼", "ä¸å«ï¼Œé¢¨å‘ä¸å°ã€‚"],
			doudizhu_pass: ["æ”¶å¸†ï¼", 
        "é¿é–‹æµªé ­ã€‚", 
        "ç­‰å¾…é †é¢¨ã€‚", 
        "é€™æ–¹å‘ä¸å°ã€‚"],
            loan_reject: ["æŠ±æ­‰å•¦ï¼æˆ‘ä¹Ÿè¦ä¿®èˆ¹ï¼", "ä¸‹æ¬¡å†èªªå§ï¼", "æµªå¤ªå¤§è½ä¸æ¸…æ¥šå–”ï¼"]
        },
        loanStages: [ { text: "ä½ éœ€è¦è³‡é‡‘ä¿®èˆ¹å—ï¼Ÿé‚„æ˜¯å»æ¢éšªï¼Ÿ", opts:[{t:"æˆ‘è¦å»å°‹å¯¶ï¼(è³­åš)", next:1}, {t:"æ²’äº‹ã€‚", next:-1}] }, { text: "å°‹å¯¶è½èµ·ä¾†å¾ˆæ£’ï¼é€™æ˜¯è´ŠåŠ©è²»ï¼", reward: 1500 } ]
    },
    { 
        id: 'lazar', name: 'æ‹‰æ‰çˆ¾', img: 'https://file.garden/aWe99vhwaGcNwkok/%E7%A0%B4%E9%A0%AD/%E6%8B%89%E6%89%8E%E7%88%BE.png', 
        uno_shout_rate: 0.3, uno_catch_rate: 0.2,
        skills: {
            uno: { name: "ç·Šæ€¥æ²»ç™‚", desc: "è¢«å¼·åˆ¶æŠ½ç‰Œæ™‚ï¼ŒæŠ½ç‰Œæ•¸ -1ã€‚" },
            bigtwo: { name: "è¨ºæ–·", desc: "é–‹å±€æ™‚æœƒå·çœ‹ç©å®¶çš„æ‰‹ç‰Œï¼Œè‹¥ç©å®¶æŒæœ‰ 2ï¼Œæ‹‰æ‰çˆ¾æœƒéš¨æ©Ÿè®“ç©å®¶é‡æŠ½/å¤±å»ä¸‰å¼µç‰Œã€‚" },
            doudizhu: { name: "å¼·å¿ƒé‡", desc: "è‹¥æ‰‹ç‰Œä¸­æ²’æœ‰ J ä»¥ä¸Šçš„å¤§ç‰Œï¼Œæœƒå¼·åˆ¶è¦æ±‚é‡ç™¼ç‰Œ (æ¯å±€é™ä¸€æ¬¡)ã€‚" }
        },
        lines: {
            start: ["è«‹å¤§å®¶æ”¾è¼•é¬†ç©ã€‚", "é€™ä¹Ÿæ˜¯å€‹æœ‰è¶£çš„æ•…äº‹å‘¢ã€‚", "æ·±å‘¼å¸ã€‚"],
            play: ["é€™å¼µç‰Œå¾ˆå¥åº·ã€‚", "è«‹æ”¶ä¸‹é€™å¼µã€‚", "æ…¢æ…¢ä¾†ã€‚", "åˆ¥æ€¥ã€‚"],
            win: ["çœŸæ˜¯å€‹å¥½çµå±€ã€‚", "é‹æ°£ä¸éŒ¯å‘¢ã€‚", "ç¥æ‚¨å¥åº·ã€‚"],
            lose: ["æ²’é—œä¿‚ï¼Œéç¨‹æœ€é‡è¦ã€‚", "ä¹Ÿæ˜¯ä¸éŒ¯çš„é«”é©—ã€‚", "è©²ä¼‘æ¯äº†ã€‚"],
            uno_attack: ["é€™å€‹...è«‹å°å¿ƒã€‚", "ä¼‘æ¯ä¸€ä¸‹å§ã€‚", "é€™æ˜¯è‰¯è—¥è‹¦å£ã€‚", "è«‹éµé†«å›‘ã€‚"],
            uno_hit: ["å“å‘€ï¼Œè² æ“”è®Šé‡äº†ã€‚", "é€™ä¹Ÿæ˜¯å‘½é‹å§ã€‚", "å£“åŠ›æœ‰é»å¤§å‘¢ã€‚"],
            uno_uno: ["æ•…äº‹å¿«è¬›å®Œäº†ã€‚", "å¿«çµæŸäº†ã€‚"],
            uno_catch: ["é–£ä¸‹ï¼Œæ‚¨ä¼¼ä¹å¿˜äº†ä»€éº¼ï¼Ÿ", "è«‹éµå®ˆè¦å‰‡å“¦ã€‚", "é€™æ¨£å°èº«é«”ä¸å¥½ã€‚"],
            uno_forgot: ["å‘µå‘µï¼Œæˆ‘è¨˜æ€§ä¸å¤ªå¥½...", "æŠ±æ­‰ï¼Œèµ°ç¥äº†ã€‚", "å“å‘€ï¼Œå¤±ç¦®äº†ã€‚"],
            uno_late: ["å“å‘€ï¼ŒUNOã€‚", "é‚„å¥½é‚„å¥½ï¼ŒUNOã€‚"],
            uno_skip: ["é‚£æˆ‘å°±å–æ¯èŒ¶å§ã€‚", "ä¸æ€¥ã€‚", "é©ç•¶çš„ä¼‘æ¯ã€‚"],
            uno_draw_many: ["é€™ä¹Ÿæ˜¯ç¨®ç©ç´¯ã€‚", "å¥½å¤šç´ æã€‚", "ç ”ç©¶è³‡æ–™è®Šå¤šäº†ã€‚"],
            uno_stack: ["é€™å€‹è™•æ–¹æ›´é©åˆä½ ã€‚", "è«‹æ”¶ä¸‹ã€‚", "è½‰è¨ºã€‚"],
            uno_poke_early: ["é–£ä¸‹ï¼Œè«‹è€å¿ƒã€‚", "åˆ¥æ€¥ã€‚", "è«‹è‡ªé‡ã€‚"],
            uno_poke_late: ["å·²ç¶“è™•ç†å¥½äº†ã€‚", "ç„¡éœ€æ“”å¿ƒã€‚", "å®Œæˆäº†ã€‚"],
            doudizhu_bid: ["é€™å±€å‹¢é‚„éœ€è¦è§€å¯Ÿï¼Œä¸å«ã€‚", "è®“æˆ‘ä¾†æ¥æ‰‹å§ï¼Œä¸‰åˆ†ã€‚", "è«‹å¤šä¿é‡ï¼Œä¸å«ã€‚"],
			doudizhu_pass: ["è«‹ç¹¼çºŒã€‚", 
        "é€™å±€å‹¢ä¸å¤ªå¥åº·ã€‚", 
        "æˆ‘å…ˆè§€å¯Ÿä¸€ä¸‹ã€‚", 
        "æ•æˆ‘ç„¡æ³•è·Ÿé€²ã€‚"],
            loan_reject: ["ä½ å¾ˆå¥½å°±å¥½ã€‚", "è«‹æ•æˆ‘å‘Šè¾­ã€‚", "ç¥ä½ é †å¿ƒã€‚"]
        }
    }
];

const RELATIONSHIP_LINES = {
    narcissus: {
        venato: { start: ["ç¶­ç´æ‰˜å…ˆç”Ÿï¼åŠ æ²¹ï¼"], win: ["ç»çµ¦ç¶­ç´æ‰˜å…ˆç”Ÿï¼"], uno_attack: ["ä¸å‡†å¦¨ç¤™ç¶­ç´æ‰˜å…ˆç”Ÿã€‚"], uno_hit: ["ç«Ÿç„¶åœ¨ç¶­ç´æ‰˜å…ˆç”Ÿé¢å‰æ‰“æˆ‘..."] },
        kleion: { start: ["å…‹é‡Œæ˜‚ï¼Œä½ é‚£å¥—åŒ–å­¸ç†è«–é€™è£¡ä¸é©ç”¨ã€‚", "å…‹é‡Œæ˜‚ï¼Œåˆ¥æ­»äº†ã€‚"], win: ["çœ‹å§å…‹é‡Œæ˜‚ï¼Œé€™å°±æ˜¯è—è¡“ã€‚"], uno_attack: ["å…‹é‡Œæ˜‚ï¼Œè©¦è©¦é€™å€‹ã€‚"] },
        aura: { start: ["è€å¸«ï¼Œè«‹æ‰‹ä¸‹ç•™æƒ…ã€‚", "è€å¸«...åˆ¥ç®—è¨ˆæˆ‘ã€‚"], uno_hit: ["è€å¸«ï¼å¤ªéåˆ†äº†ï¼"], win: ["è€å¸«ï¼Œæˆ‘å‡ºå¸«äº†å—ï¼Ÿ"] }
    },
    venato: {
        narcissus: { start: ["ç´è¥¿ï¼Œçœ‹å¥½äº†ã€‚", "ç´è¥¿ï¼Œä¸ç”¨æ“”å¿ƒï¼Œå‹ç‡100%"], win: ["ç´è¥¿ï¼Œè¨˜ä¸‹ä¾†äº†å—ï¼Ÿ"], uno_catch: ["ç´è¥¿ï¼Œå°ˆå¿ƒé»ï¼"] },
        lynn: { start: ["æ—æ©ï¼Œåˆ¥ç¡äº†ã€‚", "æ—æ©ï¼Œé€™å±€æœ‰æ„æ€ã€‚"], win: ["æ—æ©ï¼Œçœ‹æ‡‚äº†å—ï¼Ÿ"] }
    },
    xiaomu: {
        mollie: { start: ["èŒ‰è‰ä¸ç”¨æ“”å¿ƒã€‚", "ç‚ºäº†æˆ‘çš„èŠ’æœï¼"], win: ["èŒ‰è‰ï¼Œå–œæ­¡å—ï¼Ÿ"], uno_hit: ["åœ¨èŠ’æœé¢å‰ä¸Ÿè‡‰äº†..."], uno_attack: ["èª°æ•¢å‹•æˆ‘çš„èŠ’æœï¼"] },
        costa: { start: ["ç§‘çµ²å¡”å°å…¬ä¸»ï¼Œå“¥å“¥ç½©ä½ ï¼"], uno_attack: ["çµ¦ä½ çš„ï¼Œå°å…¬ä¸»ï¼"] },
        jonona: { start: ["äºŒå“¥ï¼Œåˆ¥è¼¸å¤ªæ…˜ã€‚", "äºŒå“¥ï¼Œçœ‹æˆ‘çš„ã€‚"], win: ["äºŒå“¥ï¼Œå­¸è‘—é»ï¼"], uno_hit: ["äºŒå“¥...ä½ ï¼"] }
    },
    mollie: {
        xiaomu: { start: ["èŠ’æœåŠ æ²¹ï½", "å°ç›®ï¼Œçœ‹è‘—ä½ å–”ã€‚"], play: ["å°ç›®ï¼Œé€™å¼µçµ¦ä½ ã€‚"], uno_hit: ["å°ç›®...æˆ‘æ²’äº‹ã€‚"], uno_catch: ["å°ç›®ï¼Œæ˜¯ä¸æ˜¯å¿˜äº†ï¼Ÿ"] }
    },
    lanlan: {
        jonona: { start: ["å–¬è«¾å¨œï¼Œçœ‹è˜­è˜­çš„ï¼", "å–¬è«¾å¨œï¼Œè˜­è˜­æœƒè´çš„ï¼"], win: ["å–¬è«¾å¨œä½ çœ‹ï¼æˆ‘è´äº†ï¼"], uno_attack: ["é€™å€‹é¡è‰²åƒå–¬è«¾å¨œï¼"], uno_catch: ["å–¬è«¾å¨œï¼UNOå‘€ï¼"] },
        novian: { start: ["è«¾ç¶­å®‰ï¼æˆ‘è¦è²·å¤§èˆ¹ï¼"], uno_attack: ["è«¾ç¶­å®‰åƒé€™å€‹ï¼"] }
    },
    jonona: {
        lanlan: { start: ["è˜­è˜­...è¬è¬ä½ ...", "è˜­è˜­åŠ æ²¹ï¼"], play: ["é€™å¼µçµ¦è˜­è˜­ã€‚"], win: ["å¤ªå¥½äº†ï¼è˜­è˜­æˆ‘è´äº†ï¼"], uno_catch: ["è˜­è˜­...æ²’å–Š..."] },
        novian: { start: ["è«¾ç¶­å®‰...", "é‚£å€‹...è«‹å¤šæŒ‡æ•™..."], uno_hit: ["è«¾ç¶­å®‰...å¥½ç—›..."] },
        costa: { start: ["å°ç“œï¼ŒåŠ æ²¹ã€‚", "å°ç“œï¼Œæˆ‘å€‘ä¸€èµ·ã€‚"], win: ["å°ç“œï¼æˆ‘è´äº†ï¼"] },
        xiaomu: { start: ["å°ç›®ï¼Œä½ å®‰éœé»ã€‚", "ç¸½è£å¼Ÿå¼Ÿï¼Œå‘µã€‚"], uno_attack: ["å°ç›®ï¼Œçµ¦ä½ çš„ã€‚"] }
    },
    costa: {
        kleion: { start: ["å…‹é‡Œæ˜‚åŠ æ²¹BATAï¼", "å…‹é‡Œæ˜‚ï¼Œè¦å¥½å¿ƒä¸€é»BATAã€‚"], play: ["çµ¦ä¸å¥½å¿ƒçš„äººä¸€å¼µBATAã€‚"], win: ["æ¯”å…‹é‡Œæ˜‚å²å®³BATAï¼"], uno_attack: ["å…‹é‡Œæ˜‚ä¸å¥½å¿ƒï¼ BATAï¼"] },
        xiaomu: { start: ["å“¥å“¥BATAï¼", "å“¥å“¥åŠ æ²¹BATAï¼"], uno_catch: ["å“¥å“¥æ²’å–ŠBATAï¼"] },
        jonona: { start: ["å–¬è«¾å¨œå“¥å“¥BATAï¼"], win: ["å–¬è«¾å¨œå“¥å“¥ä½ çœ‹ï¼"] }
    },
    peter: {
        lynn: { start: ["æ—æ©ï¼ä½ åœ¨çœŸå¥½ï¼", "æˆ‘çš„è²“ã€‚", "æ—æ©ï¼Œå¹«æˆ‘çœ‹çœ‹é€™è£¡æœ‰æ²’æœ‰é¬¼ã€‚"], uno_attack: ["æ—æ©ï¼Œé€™æ˜¯ç‚ºäº†ä½ å¥½ï¼"], win: ["ç‚ºäº†æˆ‘çš„è²“ã€‚"], uno_catch: ["è²“ï¼Œä½ æ²’å–Šã€‚"] },
        narcissus: { uno_attack: ["é›¢æ—æ©é é»ï¼ŒYellow Shitã€‚"], start: ["Yellow Shit ä¹Ÿåœ¨..."] }
    },
    lynn: {
        peter: { start: ["å½¼å¾—ï¼Œä½ åœ¨å¹¹å˜›...", "å½¼å¾—ï¼Œåˆ¥å–æ½”å»éˆäº†ã€‚"], uno_attack: ["å½¼å¾—å®‰éœé»..."], uno_catch: ["å½¼å¾—...å¥½éº»ç…©..."] },
        narcissus: { start: ["é‚£æ˜¯é¡å­å°æ²³ï¼å¥½çœ‹ï¼", "ç´è¥¿ç‘Ÿæ–¯ï¼Œé€™é‚Šé€™é‚Šã€‚"], win: ["ç‚ºäº†é¡å­å°æ²³è´çš„ã€‚"] },
        venato: { start: ["ç¶­ç´æ‰˜ï¼Œå¹«æˆ‘ç®—ç®—ä»€éº¼æ™‚å€™ä¸‹ç­ã€‚", "ç¶­ç´æ‰˜ï¼Œæœ‰æŠ«è–©å—ï¼Ÿ"] }
    },
    poseidon: {
        hades: { start: ["å¤§é»‘çœ‹æˆ‘ï¼", "å¤§é»‘æˆ‘å€‘å»ç©ï¼"], win: ["å¤§é»‘æˆ‘è´äº†ï¼"], uno_catch: ["å¤§é»‘ä½ æ²’å–Šï¼"], uno_hit: ["å¤§é»‘æ•‘æˆ‘ï¼"] },
        miras: { start: ["å°èŠ±ï¼"], uno_attack: ["å°èŠ±æ¥ä½ï¼èƒèŸ¹ï¼"] }
    },
    hades: {
        poseidon: { start: ["...", "(çœ‹è‘—æµ·ç¥)"], win: ["...", "(æŠŠç±Œç¢¼æ¨çµ¦æµ·ç¥)"], uno_catch: ["...", "(æˆ³æµ·ç¥)"], uno_hit: ["...", "(æ“‹åœ¨æµ·ç¥å‰é¢)"] },
        miras: { start: ["...", "(çœ‹å°èŠ±)"], uno_attack: ["...çµ¦å°èŠ±ã€‚"] }
    },
    kleion: {
        costa: { start: ["ç§‘çµ²å¡”æˆ‘æœƒä¿è­·ä½ ï¼", "ç§‘çµ²å¡”ï¼Œçœ‹è‘—æ­£ç¾©çš„åŸ·è¡Œï¼"], win: ["ç§‘çµ²å¡”ä½ çœ‹ï¼"], uno_hit: ["å­¸å¥½åŒ–å­¸å°±ä¸æœƒé€™æ¨£äº†ï¼"], uno_attack: ["é€™æ˜¯åŒ–å­¸åæ‡‰ï¼"] },
        narcissus: { start: ["ç´è¥¿ç‘Ÿæ–¯ï¼Œåˆ¥å¤ªè‡ªæˆ€äº†ã€‚", "ç´è¥¿ç‘Ÿæ–¯ï¼Œæ­£ç¾©æœƒé²åˆ°ä½†ä¸æœƒç¼ºå¸­ã€‚"], win: ["ç´è¥¿ç‘Ÿæ–¯ï¼Œæ‰¿è®“ã€‚"] }
    },
    aura: {
        miras: { start: ["èœœæ‹‰æ€ï¼Œåˆ¥ä½œå¼Šã€‚", "èœœæ‹‰æ€ï¼Œä½ çš„è®Šé‡æˆ‘çœ‹ç©¿äº†ã€‚"], lose: ["èœœæ‹‰æ€ï¼Œä½ æ˜¯ä¸æ˜¯å‹•æ‰‹è…³äº†ï¼Ÿ"], uno_catch: ["èœœæ‹‰æ€ï¼ŒæŠ“åˆ°ä½ äº†ã€‚"] },
        narcissus: { start: ["ç´è¥¿ç‘Ÿæ–¯ï¼Œåˆ¥çµ¦å®¶æ—ä¸Ÿè‡‰ã€‚", "å­¸ç”Ÿï¼Œè®“æˆ‘çœ‹çœ‹ä½ çš„é•·é€²ã€‚"] }
    },
    miras: {
        aura: { start: ["å¥§æ‹‰ï¼Œä½ çœ‹é€™ç‰Œã€‚", "å¥§æ‹‰ï¼Œæƒ³çœ‹é­”è¡“å—ï¼Ÿ"], uno_attack: ["å¥§æ‹‰ï¼Œé©šå–œå“¦ã€‚"], uno_catch: ["å¥§æ‹‰ï¼Œä½ ä¹Ÿæœ‰ä»Šå¤©ã€‚"] }
    },
    novian: {
        jonona: { start: ["å–¬è«¾å¨œï¼", "æˆ‘ä¾†ä¿è­·ä½ ï¼"], uno_attack: ["å•Š...å–¬è«¾å¨œæŠ±æ­‰ï¼"] },
        lanlan: { start: ["é˜¿è˜­ï¼çœ‹èª°éŒ¢å¤šï¼"], win: ["é˜¿è˜­æˆ‘è´äº†ï¼"] }
    },
    lazar: {
        lanlan: { start: ["ç¶­çˆ¾å¾·æ‹‰å…‹æ–¯é–£ä¸‹ï¼Œè«‹æ…¢é»ã€‚"], win: ["é–£ä¸‹ï¼Œç©å¾—é–‹å¿ƒå—ï¼Ÿ"], uno_hit: ["é–£ä¸‹çœŸæ˜¯å……æ»¿æ´»åŠ›ã€‚"] }
    }
};
/* --- 1. CONFIG & STATE --- */
const RULES = { 
    'redblack': {min:1, max:1}, 
    'blackjack': {min:1, max:1}, 
    'oldmaid': {min:3, max:3}, 
    'bigtwo': {min:3, max:3}, 
    'uno': {min:3, max:3},
    'doudizhu': {min:2, max:2} // 2 AI + 1 User
};

let App = { 
    coins: 10000, wins: 0, losses: 0, 
    gameId: '', selected: [], players: [], deck: [], 
    turn: 0, bgm: false, sfx: true, direction: 1, table: [], // æ–°å¢ sfx: true
    unoRule: 'standard', unoStacking: false, unoStack: 0, 
    skillQueue: [], isProcessingSkill: false,
    lastWinner: -1, isFirstTurn: true 
};

// è®€å–å­˜æª”
if(localStorage.getItem('rabbit_save_v23')) { // æˆ‘ç¨å¾®å‡ç´šäº†å­˜æª”ç‰ˆæœ¬è™Ÿä»¥å…è¡çª
    const s = JSON.parse(localStorage.getItem('rabbit_save_v23'));
    App.coins = s.coins; App.wins = s.wins; App.losses = s.losses;
    if(s.bgm !== undefined) App.bgm = s.bgm;
    if(s.sfx !== undefined) App.sfx = s.sfx;
}
if(isNaN(App.coins)) App.coins = 10000;
updateUI(); // ç¢ºä¿ UI åˆå§‹åŒ–
updateAudioIcons(); // åˆå§‹åŒ–æŒ‰éˆ•ç‹€æ…‹
if(isNaN(App.coins)) App.coins = 10000;
updateUI();

/* --- 2. CORE FUNCTIONS --- */
function ensureAudio() { document.body.removeAttribute('onclick'); updateAudioIcons(); }

function updateUI() {
    if(App.coins < 0) App.coins = 0;
    document.getElementById('ui-score').innerText = App.coins.toLocaleString();
    document.getElementById('stat-wins').innerText = App.wins;
    document.getElementById('stat-losses').innerText = App.losses;
    // å­˜æª”
    localStorage.setItem('rabbit_save_v23', JSON.stringify({
        coins:App.coins, wins:App.wins, losses:App.losses, bgm:App.bgm, sfx:App.sfx
    }));
}

// â˜… æ–°çš„éŸ³æ¨‚åˆ‡æ›
function toggleMusic(e) {
    if(e) e.stopPropagation();
    App.bgm = !App.bgm;
    const a = document.getElementById('bgm'); 
    a.volume = 0.4;
    if(App.bgm) {
        a.play().catch(e => console.log("Audio play failed:", e)); 
    } else {
        a.pause();
    }
    updateAudioIcons(); updateUI();
}

// â˜… æ–°çš„éŸ³æ•ˆåˆ‡æ›
function toggleSFX(e) {
    if(e) e.stopPropagation();
    App.sfx = !App.sfx;
    // æ’­æ”¾ä¸€å€‹çŸ­éŸ³æ•ˆä¾†æ¸¬è©¦
    if(App.sfx) sfx('sfx-card');
    updateAudioIcons(); updateUI();
}

// â˜… æ›´æ–°å…©å€‹æŒ‰éˆ•çš„åœ–ç¤ºé€æ˜åº¦
function updateAudioIcons() {
    const btnM = document.getElementById('btn-music');
    const btnS = document.getElementById('btn-sfx');
    
    // éŸ³æ¨‚æŒ‰éˆ•ç‹€æ…‹
    if(App.bgm) { 
        btnM.style.opacity = 1; btnM.innerText = "â™«"; 
        document.getElementById('bgm').play().catch(()=>{}); 
    } else { 
        btnM.style.opacity = 0.5; btnM.innerText = "âœ•"; 
        document.getElementById('bgm').pause(); 
    }

    // éŸ³æ•ˆæŒ‰éˆ•ç‹€æ…‹
    if(App.sfx) {
        btnS.style.opacity = 1; btnS.innerText = "ğŸ”Š";
    } else {
        btnS.style.opacity = 0.5; btnS.innerText = "ğŸ”‡";
    }
}

// â˜… æ’­æ”¾éŸ³æ•ˆ (ç¾åœ¨åªæª¢æŸ¥ App.sfxï¼Œä¸å†å— bgm å½±éŸ¿)
function sfx(id) { 
    if(!App.sfx) return; 
    const audio = document.getElementById(id);
    if(audio) {
        audio.currentTime = 0; 
        audio.play().catch(()=>{}); 
    }
}
function switchScreen(id) { document.querySelectorAll('.screen').forEach(el => el.classList.remove('active')); document.getElementById(id).classList.add('active'); }
function goHome() { document.getElementById('modal-result').style.display = 'none'; document.getElementById('modal-loan').style.display = 'none'; switchScreen('screen-menu'); }

// â˜… ä¿®æ”¹é€²å…¥å¤§å»³é‚è¼¯ (é™åˆ¶ 500 å…ƒ)
function goToLobby(gid) {
    // æª¢æŸ¥é¤˜é¡
    if(App.coins < 500) {
        alert("âš ï¸ è³‡é‡‘ä¸è¶³ï¼\n\nä½ çš„ä»£å¹£ä½æ–¼ 500ï¼Œç„¡æ³•å…¥å ´ã€‚\nè«‹é»æ“Šä¸Šæ–¹åˆ†æ•¸æ¬„ä½é€²è¡Œã€Œå€Ÿæ¬¾å”å•†ã€ã€‚");
        return; // ç›´æ¥ä¸­æ–·ï¼Œä¸åˆ‡æ›ç•«é¢
    }

    App.gameId = gid; App.selected = []; renderLobby(); switchScreen('screen-lobby');
    document.getElementById('lobby-uno-opt').style.display = (gid === 'uno') ? 'block' : 'none';
    updateAudioIcons();
}

/* --- LOBBY & SKILL DISPLAY --- */
let longPressTimer; let isLongPress = false;
function addLongPressHandler(element, onClick, onLongPress) {
    let timer; let isLong = false; let startX, startY;
    const start = (e) => { isLong = false; if(e.type === 'touchstart') { startX = e.touches[0].clientX; startY = e.touches[0].clientY; } timer = setTimeout(() => { isLong = true; onLongPress(e); }, 500); };
    const cancel = () => { clearTimeout(timer); };
    const move = (e) => { if(e.type === 'touchmove') { let x = e.touches[0].clientX; let y = e.touches[0].clientY; if(Math.abs(x - startX) > 10 || Math.abs(y - startY) > 10) cancel(); } else { cancel(); } };
    const end = (e) => { clearTimeout(timer); if (!isLong) { onClick(e); } };
    element.onmousedown = start; element.ontouchstart = start; element.onmouseup = end; element.ontouchend = (e) => { e.preventDefault(); end(e); }; element.onmousemove = move; element.ontouchmove = move; element.onmouseleave = cancel;
}
function renderLobby() {
    const g = document.getElementById('char-grid'); g.innerHTML = '';
    CHARS.forEach(c => {
        const div = document.createElement('div'); div.className = 'char-item';
        div.innerHTML = `<img class="char-avatar" src="${c.img}"><div class="char-name">${c.name}</div>`;
        addLongPressHandler(div, () => toggleChar(div, c), () => { showSkillModal(c); sfx('sfx-card'); });
        g.appendChild(div);
    });
    checkLobby();
}
function showSkillModal(c) {
    document.getElementById('skill-char-img').src = c.img; document.getElementById('skill-char-name').innerText = c.name;
    const container = document.getElementById('skill-content-area'); container.innerHTML = '';
    let skill = (App.gameId === 'uno') ? c.skills.uno : (App.gameId === 'bigtwo') ? c.skills.bigtwo : (App.gameId === 'doudizhu') ? c.skills.doudizhu : null;
    if (skill) {
        container.innerHTML += `<div class="skill-section"><div class="skill-title"><span>ACTIVE SKILL</span> <span class="skill-tag">AI ONLY</span></div><div class="skill-name">${skill.name}</div><div class="skill-desc">${skill.desc}</div></div>`;
        if(c.cp_skill && c.cp_skill[App.gameId]) {
            container.innerHTML += `<div class="skill-section skill-cp-section"><div class="skill-title"><span style="color:#ff55aa">CP BOND</span> <span class="skill-tag">LINK</span></div><div class="skill-name" style="color:#ff55aa">${c.cp_skill[App.gameId].name}</div><div class="skill-desc">${c.cp_skill[App.gameId].desc}</div></div>`;
        }
    } else {
        container.innerHTML = `<div class="skill-section"><div class="skill-desc">æ­¤æ¨¡å¼ç„¡ç‰¹æ®ŠæŠ€èƒ½ã€‚</div></div>`;
    }
    document.getElementById('skill-modal-overlay').classList.add('show');
}
function closeSkillModal() { document.getElementById('skill-modal-overlay').classList.remove('show'); }
function toggleChar(div, c) {
    if(document.getElementById('skill-modal-overlay').classList.contains('show')) return;
    const idx = App.selected.indexOf(c);
    if(idx>-1) App.selected.splice(idx,1);
    else { if(App.selected.length < RULES[App.gameId].max) App.selected.push(c); else if(RULES[App.gameId].max===1) App.selected = [c]; }
    renderLobbySelection(); checkLobby();
}
function renderLobbySelection() { document.querySelectorAll('.char-item').forEach((el) => { const charName = el.querySelector('.char-name').innerText; if(App.selected.some(s => s.name === charName)) el.classList.add('selected'); else el.classList.remove('selected'); }); }
function checkLobby() { document.getElementById('btn-start').disabled = !(App.selected.length >= RULES[App.gameId].min && App.selected.length <= RULES[App.gameId].max); }

/* --- GAME LOGIC --- */
function say(idx, type) {
    if(App.players[idx].isUser) return;
    const p = App.players[idx]; const c = p.char;
    let text = "";
    // CP Line Check
    if(RELATIONSHIP_LINES[c.id]) {
        App.players.forEach(op => {
            if(!op.isUser && op.char.id !== c.id && RELATIONSHIP_LINES[c.id][op.char.id]) {
                const lines = RELATIONSHIP_LINES[c.id][op.char.id][type];
                if(lines && Math.random() < 0.6) text = lines[Math.floor(Math.random()*lines.length)];
            }
        });
    }
    if(!text) {
        const pool = c.lines[type] || c.lines.play || ["..."];
        text = pool[Math.floor(Math.random()*pool.length)];
    }
    const el = document.querySelector(`#seat-${idx} .bubble`);
    if(el) { el.innerText = text; el.classList.add('show'); setTimeout(() => el.classList.remove('show'), 2500); }
}

function triggerSkill(pIdx, skill) {
    if(!skill) return; 
    App.skillQueue.push({pIdx: pIdx, skill: skill});
    processSkillQueue();
}
function processSkillQueue() {
    if (App.isProcessingSkill || App.skillQueue.length === 0) return;
    App.isProcessingSkill = true;
    const item = App.skillQueue.shift();
    const charData = App.players[item.pIdx].char;
    const t = document.getElementById('skill-toast');
    t.innerHTML = `<img src="${charData.img}" class="st-avatar"><div class="st-content"><div class="st-title">â˜… ${item.skill.name}</div><div class="st-user">${charData.name}</div></div>`;
    t.classList.remove('show'); void t.offsetWidth; t.classList.add('show'); sfx('sfx-win');
    setTimeout(() => { t.classList.remove('show'); App.isProcessingSkill = false; processSkillQueue(); }, 2500);
}

// é…ç‰Œèˆ‡æŠ€èƒ½åˆå§‹åŒ–
function distributeSkillCards() {
    // UNO Rigging
    if(App.gameId === 'uno') {
        App.players.forEach((p, i) => {
            if(p.isUser) return;
            if(p.char.id === 'lanlan') {
                const bomb = App.deck.find(c => c.type === 'wild4' || c.type === 'draw2');
                if(bomb) { p.hand.push(bomb); App.deck = App.deck.filter(c => c!==bomb); triggerSkill(i, p.char.skills.uno); }
            }
        });
        App.players.forEach(p => { while(p.hand.length < 7 && App.deck.length > 0) p.hand.push(App.deck.pop()); });
    }
    // Big 2 Rigging
    if(App.gameId === 'bigtwo') {
        App.players.forEach((p, i) => {
            if(p.isUser) return;
            const steal = (pred) => { const idx = App.deck.findIndex(pred); if(idx>-1) return App.deck.splice(idx,1)[0]; return null; };
            if(p.char.id === 'venato') { const c = steal(c=>c.s==='â™£'&&c.r==='3'); if(c) { p.hand.push(c); triggerSkill(i, p.char.skills.bigtwo); } }
            if(p.char.id === 'aura') {
                const counts = {}; App.deck.forEach(c=>counts[c.r]=(counts[c.r]||0)+1);
                const targetR = Object.keys(counts).find(r=>counts[r]>=4);
                if(targetR) { 
                    const cards = App.deck.filter(c=>c.r===targetR).slice(0,4);
                    cards.forEach(c=>p.hand.push(c));
                    App.deck = App.deck.filter(c=>c.r!==targetR);
                    triggerSkill(i, p.char.skills.bigtwo);
                }
            }
            if(p.char.id === 'lanlan') { const c = steal(c=>c.s==='â™¦'&&c.r==='3'); if(c) p.hand.push(c); }
        });
        App.players.forEach(p => { while(p.hand.length < 13 && App.deck.length > 0) p.hand.push(App.deck.pop()); });
    }
}

// â˜… åˆå§‹åŒ–éŠæˆ² (ä¿®å¾© UI éºå¤±ã€åº§ä½ç”Ÿæˆã€ç´¢å¼•å•é¡Œ)
function initGame() {
    document.getElementById('modal-result').style.display = 'none'; 
    switchScreen('screen-game'); 
    updateAudioIcons(); // <--- åŠ ä¸Š 's'
    App.skillQueue = []; App.isProcessingSkill = false;
    
    // 1. å»ºç«‹ç©å®¶æ•¸æ“š (User æ°¸é æ˜¯æœ€å¾Œä¸€ä½)
    App.players = []; 
    
    // æ ¹æ“šéŠæˆ²æœ€å¤§äººæ•¸æˆªå– AI (ä¾‹å¦‚é¬¥åœ°ä¸»åªè¦å‰ 2 å€‹ AI)
    let maxAI = RULES[App.gameId].max;
    let selectedAI = App.selected.slice(0, maxAI);
    
    selectedAI.forEach(c => App.players.push({ 
        isUser: false, 
        char: JSON.parse(JSON.stringify(c)), 
        hand: [], role: 'peasant', passed: false, unoSaid: false, vulnerable: false 
    })); 
    App.players.push({
        isUser: true, char: null, 
        hand: [], role: 'peasant', passed: false, unoSaid: false, vulnerable: false
    });
    
    // 2. åº§ä½æ¸²æŸ“
    const area = document.getElementById('seat-container'); area.innerHTML = ''; 
    const aiCount = App.players.length - 1;
    
    let posMap = [1];
    if(aiCount === 2) posMap = [0, 2]; // é¬¥åœ°ä¸»/3äººå±€
    if(aiCount === 3) posMap = [0, 1, 2]; // 4äººå±€

    for(let i=0; i < aiCount; i++) {
        const p = App.players[i]; 
        const div = document.createElement('div'); 
        div.className = 'seat'; 
        div.dataset.pos = posMap[i]; 
        div.id = `seat-${i}`; 
        
        addLongPressHandler(div, () => onSeatClick(i), () => { showSkillModal(p.char); });
        
        let extraUI = `<div class="role-badge" id="role-${i}"></div>`;
        if(App.gameId==='uno' || App.gameId==='oldmaid') extraUI += `<div class="mini-hand-container" id="mini-hand-${i}"></div>`;
        if(App.gameId==='uno') extraUI += `<div class="uno-badge" id="uno-badge-${i}">UNO</div>`;
        if(App.gameId==='bigtwo' || App.gameId==='doudizhu') extraUI += `<div class="count-badge" id="count-badge-${i}">0</div>`;
        if(App.gameId==='blackjack') extraUI += `<div class="dealer-score" id="dealer-score">0</div>`;
        
        div.innerHTML = `<img class="op-avatar" src="${p.char.img}">${extraUI}<div class="bubble"></div>`;
        area.appendChild(div);
        setTimeout(() => say(i, 'start'), i * 800 + 500);
    }
    
    const unoBtn = document.querySelector('.fixed-uno-btn');
    if (unoBtn) {
        if (App.gameId === 'uno') {
            unoBtn.style.display = 'flex';
            unoBtn.classList.remove('said');
            unoBtn.innerText = "UNO!";
        } else {
            unoBtn.style.display = 'none';
        }
    }
    
    document.getElementById('ddz-kitty').style.display = (App.gameId === 'doudizhu') ? 'flex' : 'none';
    document.getElementById('ddz-kitty').innerHTML = ''; 
    document.getElementById('table-cards').innerHTML = ''; 
    document.getElementById('msg-large').className = 'msg-large'; 
    document.getElementById('bj-score').style.display = 'none';
    hideControls(); setStatus("");
    
    if(App.gameId==='redblack') startRB(); 
    if(App.gameId==='blackjack') startBJ(); 
    if(App.gameId==='oldmaid') startOM(); 
    if(App.gameId==='bigtwo') startB2(); 
    if(App.gameId==='uno') startUNO();
    if(App.gameId==='doudizhu') startDDZ(); 
}

/* --- HELPERS (UI UPDATES) --- */
// â˜… è‡ªå‹•å°‹æ‰¾ç©å®¶ (ä¿®å¾© 21é»/é¬¥åœ°ä¸» æ‰¾ä¸åˆ°ç‰Œçš„å•é¡Œ)
function createDeck() { const s=['â™£','â™¦','â™¥','â™ '], r=['3','4','5','6','7','8','9','10','J','Q','K','A','2']; let d=[]; s.forEach((ss,i)=>r.forEach((rr,j)=>d.push({s:ss,r:rr,val:j*4+i}))); return d.sort(()=>Math.random()-0.5); }
function updateScore(v) { App.coins+=v; updateUI(); }
function setStatus(t) { const b=document.getElementById('status-bar'); if(b){b.innerText=t; b.classList.add('active'); setTimeout(()=>b.classList.remove('active'),500);} }
function setControls(l1,l2,f1,f2) { const c = document.getElementById('controls'); c.innerHTML = `<button class="btn-act btn-pass" id="btn-pass">${l2}</button><button class="btn-act" id="btn-play">${l1}</button>`; const b1=document.getElementById('btn-play'), b2=document.getElementById('btn-pass'); if(l1) { b1.onclick=f1; setTimeout(()=>b1.classList.add('show'),10); } else b1.style.display='none'; if(l2) { b2.onclick=f2; setTimeout(()=>b2.classList.add('show'),10); } else b2.style.display='none'; }
function hideControls() { document.getElementById('controls').innerHTML=''; }
function renderHand() { 
    const userIdx = App.players.findIndex(p => p.isUser);
    const d = document.getElementById('player-hand'); 
    d.innerHTML=''; 
    
    if(userIdx === -1 || !App.players[userIdx].hand) return;
    const h = App.players[userIdx].hand; 
    
    if(App.gameId==='bigtwo') h.sort((a,b)=>getAbsVal(a)-getAbsVal(b));
    if(App.gameId==='doudizhu') h.sort((a,b)=>getDDZAbs(b)-getDDZAbs(a));

    d.className = h.length < 5 ? 'my-hand few-cards' : 'my-hand'; 
    h.forEach(c => { 
        const el = document.createElement('div'); 
        if(c.type) { // UNO Card
            let colorClass = `uno-${c.tempColor || c.color}`; 
            el.className = `card uno ${colorClass}`; 
            let displayVal = c.val; 
            if(c.type==='skip') displayVal = 'âŠ˜'; if(c.type==='reverse') displayVal = 'â‡„'; if(c.type==='draw2') displayVal = '+2'; 
            el.innerHTML = `<div class="uno-corner">${displayVal}</div><div class="card-center-uno">${displayVal}</div>`; 
            el.onclick = () => unoUserClick(c); 
        } else { // Poker Card
            el.className = `card ${['â™¥','â™¦'].includes(c.s)?'red':'black'}`; 
            el.innerHTML = `<div class="card-corner"><div>${c.r}</div><div>${c.s}</div></div><div class="card-center-suit">${c.s}</div>`; 
            el.onclick = () => { c.sel=!c.sel; renderHand(); }; 
            if(c.sel) el.classList.add('selected'); 
        } 
        d.appendChild(el); 
    }); 
}

function renderTable(cards) { 
    const d=document.getElementById('table-cards'); d.innerHTML=''; 
    cards.forEach(c=>{ 
        const el=document.createElement('div'); 
        if(c.type) { 
            let colorClass = `uno-${c.tempColor || c.color}`; el.className = `card uno ${colorClass}`; 
            let displayVal = c.val; if(c.type==='skip') displayVal = 'âŠ˜'; if(c.type==='reverse') displayVal = 'â‡„'; if(c.type==='draw2') displayVal = '+2'; 
            el.innerHTML = `<div class="uno-corner">${displayVal}</div><div class="card-center-uno">${displayVal}</div>`; 
        } else { 
            el.className=`card ${['â™¥','â™¦'].includes(c.s)?'red':'black'}`; 
            el.innerHTML = `<div class="card-corner"><div>${c.r}</div><div>${c.s}</div></div><div class="card-center-suit">${c.s}</div>`; 
        } 
        d.appendChild(el); 
    }); 
}

function updateOpponentVisuals() {
    const btn = document.querySelector('.fixed-uno-btn');
    const user = App.players.find(p => p.isUser);
    if (btn) { 
        if (user && user.unoSaid) { btn.classList.add('said'); btn.innerText = "SAFE"; } 
        else { btn.classList.remove('said'); btn.innerText = "UNO!"; } 
    }
    const uBadge = document.getElementById('player-badge'); 
    if(uBadge) { if(user && user.unoSaid) uBadge.classList.add('show'); else uBadge.classList.remove('show'); }

    // æ›´æ–° AI
    for(let i=0; i < App.players.length; i++) { 
        if(App.players[i].isUser) continue;
        const p = App.players[i]; 
        
        if(App.gameId === 'oldmaid' || App.gameId === 'uno') { 
            const c = document.getElementById(`mini-hand-${i}`); 
            if(c) { 
                c.innerHTML = ''; const count = Math.min(p.hand.length, 25); 
                for(let j=0; j<count; j++) { c.innerHTML += `<div class="mini-card ${App.gameId==='uno'?'uno-back':''}"></div>`; } 
                if(p.hand.length > 25) c.innerHTML += `<div style="font-size:0.6rem;color:#fff;align-self:center">+${p.hand.length-25}</div>`; 
            } 
            const b = document.getElementById(`uno-badge-${i}`); 
            if(b) { if(p.unoSaid) b.classList.add('show'); else b.classList.remove('show'); } 
        } 
        if(App.gameId === 'bigtwo' || App.gameId === 'doudizhu') { 
            const b = document.getElementById(`count-badge-${i}`); 
            if(b) b.innerText = p.hand.length; 
        }
        if(App.gameId === 'doudizhu') {
            const rb = document.getElementById(`role-${i}`);
            if(rb) {
                if(p.role==='landlord') { rb.className='role-badge role-landlord show'; rb.innerText='åœ°'; }
                else { rb.className='role-badge role-peasant show'; rb.innerText='è¾²'; }
            }
        }
    }
    // Update User Role Badge
    if(App.gameId === 'doudizhu' && user) {
        const roleU = document.getElementById('player-badge'); 
        if(user.role === 'landlord') { roleU.style.display='flex'; roleU.style.background='#ffcc00'; roleU.innerText="åœ°ä¸»"; }
        else { roleU.style.display='flex'; roleU.style.background='#55aa55'; roleU.innerText="è¾²æ°‘"; }
    }
}

function showResult(win, amt, msg="") { 
    const m = document.getElementById('modal-result'); 
    if(win === 'push') { document.getElementById('res-title').innerText="PUSH"; document.getElementById('res-title').style.color="#fff"; updateScore(amt); } 
    else if(win) { App.wins++; document.getElementById('res-title').innerText="VICTORY"; document.getElementById('res-title').style.color="var(--gold)"; sfx('sfx-win'); updateScore(amt); } 
    else { App.losses++; document.getElementById('res-title').innerText="DEFEAT"; document.getElementById('res-title').style.color="#888"; updateScore(amt); } 
    let fullMsg = (amt>0?"+":"") + amt + " Coins"; 
    if(msg) fullMsg += `<br><span style='font-size:0.8rem;color:#aaa'>${msg}</span>`; 
    document.getElementById('res-msg').innerHTML = fullMsg; 
    updateUI(); 
    m.style.display = 'flex'; 
}

/* --- DOU DI ZHU ENGINE (Enhanced AI & Logic) --- */
let ddzLandlordIdx = -1; let ddzBidScore = 0; let ddzMulti = 1; 
const DDZ = { RANKS: ['3','4','5','6','7','8','9','10','J','Q','K','A','2','S','B'], TYPES: { INVALID:0, SINGLE:1, PAIR:2, TRIP:3, TRIP_1:4, TRIP_2:5, BOMB:6, ROCKET:7, STRAIGHT:8 } };
function getDDZRank(r) { return DDZ.RANKS.indexOf(r); }
function getDDZAbs(c) { return getDDZRank(c.r); } 

// AI å€‹æ€§å®šç¾©
const DDZ_STYLES = {
    aggressive: ['lanlan', 'kleion', 'poseidon', 'novian', 'miras'], // å–œæ­¡æ¶åœ°ä¸»ã€å£“ç‰Œ
    conservative: ['jonona', 'mollie', 'lynn', 'costa', 'hades'], // è¬¹æ…ã€å®¹æ˜“Pass
    smart: ['venato', 'aura', 'xiaomu', 'peter', 'narcissus'] // æœƒç®—ç‰Œã€é…åˆéšŠå‹
};

function getAIStyle(charId) {
    if(DDZ_STYLES.aggressive.includes(charId)) return 'aggressive';
    if(DDZ_STYLES.conservative.includes(charId)) return 'conservative';
    if(DDZ_STYLES.smart.includes(charId)) return 'smart';
    return 'balanced';
}

function ddzAnalyze(cards) {
    if(!cards || cards.length === 0) return null;
    const s = [...cards].sort((a,b) => getDDZAbs(a) - getDDZAbs(b));
    const len = s.length; const r = s.map(c => getDDZAbs(c));
    if(len===2 && r[0]===13 && r[1]===14) return { type: DDZ.TYPES.ROCKET, val: 999, cards: s };
    if(len===4 && r[0]===r[3]) return { type: DDZ.TYPES.BOMB, val: r[0], cards: s };
    if(len===1) return { type: DDZ.TYPES.SINGLE, val: r[0], cards: s };
    if(len===2 && r[0]===r[1]) return { type: DDZ.TYPES.PAIR, val: r[0], cards: s };
    if(len===3 && r[0]===r[2]) return { type: DDZ.TYPES.TRIP, val: r[0], cards: s };
    if(len===4) {
        if(r[0]===r[2]) return { type: DDZ.TYPES.TRIP_1, val: r[0], cards: s }; 
        if(r[1]===r[3]) return { type: DDZ.TYPES.TRIP_1, val: r[1], cards: s }; 
    }
    if(len===5) {
        if(r[0]===r[2] && r[3]===r[4]) return { type: DDZ.TYPES.TRIP_2, val: r[0], cards: s }; 
        if(r[0]===r[1] && r[2]===r[4]) return { type: DDZ.TYPES.TRIP_2, val: r[2], cards: s }; 
    }
    if(len >= 5) {
        let isStr = true;
        for(let i=0; i<len-1; i++) { if(r[i+1] !== r[i]+1 || r[i]>=12) isStr = false; }
        if(isStr) return { type: DDZ.TYPES.STRAIGHT, val: r[0], len: len, cards: s };
    }
    return null;
}

function ddzCanBeat(my, top) {
    if(!my) return false;
    if(!top) return true; 
    if(my.type === DDZ.TYPES.ROCKET) return true;
    if(top.type === DDZ.TYPES.ROCKET) return false;
    if(my.type === DDZ.TYPES.BOMB) { return (top.type !== DDZ.TYPES.BOMB) ? true : my.val > top.val; }
    if(top.type === DDZ.TYPES.BOMB) return false;
    if(my.type !== top.type) return false;
    if(my.type === DDZ.TYPES.STRAIGHT && my.len !== top.len) return false;
    return my.val > top.val;
}

// â˜… å„ªåŒ–ç‰ˆæ ¸å¿ƒ AI æ±ºç­–é‚è¼¯ (æ›´è°æ˜ã€æœƒé ‚ç‰Œã€æœƒè¡åˆº)
function ddzAIDecide(pIdx, topCards) {
    const p = App.players[pIdx];
    const style = getAIStyle(p.char.id);
    const hand = [...p.hand].sort((a,b)=>getDDZAbs(a)-getDDZAbs(b)); // å°åˆ°å¤§æ’åº
    const isFree = (!topCards || topCards.owner === pIdx);
    const topInfo = isFree ? null : ddzAnalyze(topCards.cards);

    // 1. æ‰¾å‡ºæ‰€æœ‰åˆæ³•çš„å‡ºç‰Œçµ„åˆ
    let moves = [];
    hand.forEach(c => moves.push({cards:[c]})); // å–®å¼µ
    for(let i=0; i<hand.length-1; i++) { if(getDDZAbs(hand[i]) === getDDZAbs(hand[i+1])) moves.push({cards: hand.slice(i,i+2)}); } // å°å­
    for(let i=0; i<=hand.length-3; i++) { if(getDDZAbs(hand[i]) === getDDZAbs(hand[i+2])) moves.push({cards: hand.slice(i,i+3)}); } // ä¸‰æ¢
    for(let i=0; i<=hand.length-4; i++) { if(getDDZAbs(hand[i]) === getDDZAbs(hand[i+3])) moves.push({cards: hand.slice(i,i+4)}); } // ç‚¸å½ˆ
    
    // æª¢æŸ¥ç«ç®­ (é›™ç‹)
    const j1 = hand.find(c=>c.r==='S'); const j2 = hand.find(c=>c.r==='B');
    if(j1 && j2) moves.push({cards:[j1, j2]});

    // 2. éæ¿¾å‡ºèƒ½å£“éä¸Šå®¶çš„ç‰Œ
    let validMoves = moves.filter(m => {
        const info = ddzAnalyze(m.cards);
        return info && ddzCanBeat(info, topInfo);
    });

    // å¦‚æœæ²’æœ‰ç‰Œèƒ½å¤§éä¸Šå®¶ï¼Œç›´æ¥å›å‚³ null (Pass)
    if(validMoves.length === 0) return null;

    // 3. æ ¹æ“šç‰ŒåŠ›å¤§å°æ’åº (å¾å°åˆ°å¤§)
    validMoves.sort((a,b) => ddzAnalyze(a.cards).val - ddzAnalyze(b.cards).val);

    // --- æ±ºç­–åˆ†æ”¯ ---

    // ã€æƒ…æ³ Aã€‘ è‡ªç”±å‡ºç‰Œ (Free Turn)
    if (isFree) {
        // è°æ˜å‹ï¼šå¦‚æœæœ‰ "ä¸‰å¸¶ä¸€" æˆ– "é£›æ©Ÿ" ç­‰è¤‡é›œç‰Œå‹æ‡‰å„ªå…ˆå‡º (æ­¤è™•ç‚ºç°¡åŒ–ç‰ˆï¼Œå„ªå…ˆå‡ºæœ€å°çš„çµ„åˆ)
        // è¡åˆºï¼šå¦‚æœæ‰‹ç‰Œåªå‰©ä¸€æ‰‹ (ä¾‹å¦‚å‰©ä¸€å°)ï¼Œç›´æ¥å‡ºå®Œ
        const lastMove = validMoves.find(m => m.cards.length === hand.length);
        if (lastMove) return lastMove.cards;
        
        // æ­£å¸¸å‡ºæœ€å°çš„ç‰Œ
        return validMoves[0].cards;
    }

    // å–å¾—å ´ä¸Šè³‡è¨Š
    const topPlayer = App.players[topCards.owner];
    const isTeammate = (p.role === topPlayer.role) && (p.role === 'peasant');
    const landlord = App.players.find(pl => pl.role === 'landlord');
    const landlordLeft = landlord ? landlord.hand.length : 99;
    
    // ã€æƒ…æ³ Bã€‘ ç·Šæ€¥ç‹€æ³ (åœ°ä¸»å¿«è´äº†ï¼)
    // å¦‚æœæˆ‘æ˜¯è¾²æ°‘ï¼Œä¸”åœ°ä¸»åªå‰© 1-2 å¼µç‰Œï¼Œå¿…é ˆä¸æƒœä»£åƒ¹å£“æ­»åœ°ä¸»
    if (p.role === 'peasant' && topPlayer.role === 'landlord' && landlordLeft <= 2) {
        // å‡ºæœ€å¤§çš„ç‰Œå»æ“‹ï¼(å€’åºé¸æœ€å¤§çš„)
        return validMoves[validMoves.length - 1].cards;
    }

    // ã€æƒ…æ³ Cã€‘ çµ•æ®ºæ©Ÿæœƒ (æˆ‘è‡ªå·±å¿«è´äº†)
    // å¦‚æœæˆ‘å‡ºé€™å¼µå°±èƒ½è´ï¼Œä¸ç®¡æ˜¯èª°å‡ºçš„ç‰Œï¼Œç›´æ¥å£“
    const winningMove = validMoves.find(m => m.cards.length === hand.length);
    if (winningMove) return winningMove.cards;


    // ã€æƒ…æ³ Dã€‘ è·Ÿç‰Œéšæ®µ - é¢å°éšŠå‹ (Check against Teammate)
    if (isTeammate) {
        // åŸæœ¬é‚è¼¯å¤ªåš´è‹› (>=11 å°±é)ï¼Œç¾åœ¨æ”¾å¯¬ï¼š
        // 1. å¦‚æœéšŠå‹å‡ºçš„æ˜¯ 2 æˆ– ç‹ (val >= 15)ï¼Œè®“ä»–éï¼ŒPassã€‚
        if (topInfo.val >= 15) return null;

        // 2. å¦‚æœéšŠå‹åªå‰© < 5 å¼µç‰Œï¼Œç›¡é‡ä¸å£“ä»–ï¼Œè®“ä»–èµ°ã€‚
        if (topPlayer.hand.length < 5) return null;

        // 3. å¦‚æœæˆ‘æ˜¯ä¿å®ˆå‹ï¼Œä¸”éšŠå‹å‡ºçš„ä¸å° (K, A)ï¼Œé‚£æˆ‘ Passã€‚
        if (style === 'conservative' && topInfo.val >= 13) return null;
        
        // 4. å¦å‰‡ï¼Œå¦‚æœä½ æ‰‹ç‰Œå¾ˆå¤šï¼Œé‚„æ˜¯å¯ä»¥ç¨å¾®è·Ÿä¸€ä¸‹ï¼Œä¸è¦è®“éšŠå‹ä¸€ç›´è€—ç‰Œ
        // é€™è£¡é¸æ“‡ Pass çš„æ©Ÿç‡å–æ±ºæ–¼ç‰ŒåŠ›ï¼Œå¦‚æœéœ€è¦æ‹†å¤§ç‰Œ (2) æ‰èƒ½å£“ï¼Œé‚£å°± Pass
        const smallestBeat = validMoves[0];
        const sInfo = ddzAnalyze(smallestBeat.cards);
        if (sInfo.val >= 15) return null; // ä¸å€¼å¾—ç‚ºäº†å£“éšŠå‹çš„å°ç‰Œè€Œå‡º 2
    }


    // ã€æƒ…æ³ Eã€‘ è·Ÿç‰Œéšæ®µ - é¢å°æ•µäºº (Check against Enemy)
    // é€™è£¡åŠ å…¥ã€Œé ‚ç‰Œã€é‚è¼¯ï¼šå¦‚æœæˆ‘æ˜¯åœ°ä¸»çš„ä¸Šå®¶ (è² è²¬å®ˆé–€)ï¼Œä¸èƒ½è®“åœ°ä¸»è¼•é¬†éå°ç‰Œ
    
    const isGatekeeper = (p.role === 'peasant' && App.players[(pIdx + 1) % 3].role === 'landlord');
    
    if (isGatekeeper && topInfo.val < 10) { // å¦‚æœåœ°ä¸»å‡ºå°ç‰Œ (3~9)
        // å˜—è©¦æ‰¾ä¸€å¼µæ¯”è¼ƒå¤§çš„ç‰Œ (J, Q, K, A) ä¾†é ‚ï¼Œè€Œä¸æ˜¯å‡ºæœ€å°çš„
        // ç¯©é¸å‡ºå¤§æ–¼ J (11) çš„ç‰Œ
        let bigMoves = validMoves.filter(m => ddzAnalyze(m.cards).val >= 11 && ddzAnalyze(m.cards).val <= 14);
        if (bigMoves.length > 0) {
             // å„ªå…ˆå‡ºå¤§ç‰Œé ‚ä½
             return bigMoves[0].cards;
        }
    }

    // ä¸€èˆ¬æƒ…æ³ï¼šå‡ºæœ€å°èƒ½è´çš„ç‰Œ
    const bestMove = validMoves[0];
    const moveInfo = ddzAnalyze(bestMove.cards);

    // ç‚¸å½ˆè¬¹æ…ä½¿ç”¨
    if (moveInfo.type === DDZ.TYPES.BOMB || moveInfo.type === DDZ.TYPES.ROCKET) {
        // å¦‚æœæ•µäººå‰©é¤˜ç‰Œæ•¸é‚„å¾ˆå¤š (>10)ï¼Œä¸”è‡ªå·±æ˜¯ä¿å®ˆå‹ï¼Œå…ˆå¿ä¸€æ‰‹
        if (topPlayer.hand.length > 10 && style === 'conservative') return null;
    }

    // æ™ºæ…§å‹ AI çš„ç‰¹æ®Šåˆ¤æ–·ï¼šä¸è¦ç‚ºäº†å£“ä¸€å€‹å°å°å­æ‹†äº†é †å­
    if (style === 'smart') {
         // é€™è£¡ç°¡å–®æ¨¡æ“¬ï¼šå¦‚æœé€™å¼µç‰Œæ˜¯é †å­çš„ä¸€éƒ¨åˆ†ï¼Œæœ‰ 50% æ©Ÿç‡ä¸æ‹† (Pass)
         // (é€²éšé‚è¼¯éœ€è¦æ›´è¤‡é›œçš„ç‰Œå‹åˆ†æï¼Œé€™è£¡å…ˆå¾ç°¡)
         if (moveInfo.val > 13 && topInfo.val < 10 && Math.random() < 0.5) return null;
    }

    return bestMove.cards;
}

// ç”¢ç”Ÿé€šç”¨çš„ Pass å°è© (ç•¶è§’è‰²æ²’æœ‰å°ˆå±¬å°è©æ™‚ä½¿ç”¨)
function getGenericPassLine(char) {
    const style = getAIStyle(char.id);
    const lines = {
        aggressive: ["é€™æ‰‹ä¸è¦ï¼", "è®“çµ¦ä½ ã€‚", "éï¼", "å˜–ï¼Œæ²’ç‰Œã€‚"],
        conservative: ["è¦ä¸èµ·...", "éã€‚", "å¤ªå¤§äº†ã€‚", "æˆ‘å¿ã€‚"],
        smart: ["æš«é¿é‹’èŠ’ã€‚", "Passã€‚", "æˆ°è¡“æ€§æ”¾æ£„ã€‚", "ä½ çš„ç‰Œå¤ªå¥½äº†ã€‚"],
        balanced: ["éã€‚", "ä¸è¦ã€‚", "Passã€‚"]
    };
    const pool = lines[style] || lines.balanced;
    return pool[Math.floor(Math.random() * pool.length)];
}

function startDDZ() {
    let d = createDeck(); d.push({s:'â˜…', r:'S', val:13}); d.push({s:'â˜…', r:'B', val:14}); 
    App.deck = d.sort(()=>Math.random()-0.5);
    App.players.forEach(p => { p.hand=[]; p.role='peasant'; p.passed=false; });
    ddzLandlordIdx = -1; ddzBidScore = 0; ddzMulti = 1;

    // Rigging (ç™¼ç‰Œä½œå¼Š/æŠ€èƒ½)
    App.players.forEach((p, i) => {
        if(p.isUser) return;
        if(p.char.id === 'lanlan') {
            const counts = {}; App.deck.forEach(c=>counts[c.r]=(counts[c.r]||0)+1);
            const rank = Object.keys(counts).find(r=>counts[r]===4);
            if(rank) { const bomb = App.deck.filter(c=>c.r===rank); App.deck = App.deck.filter(c=>c.r!==rank); p.hand.push(...bomb); triggerSkill(i, p.char.skills.doudizhu); }
        }
        if(p.char.id === 'aura') {
            const jokers = App.deck.filter(c=>c.r==='S'||c.r==='B');
            if(jokers.length>0) { p.hand.push(...jokers); App.deck = App.deck.filter(c=>c.r!=='S'&&c.r!=='B'); triggerSkill(i, p.char.skills.doudizhu); }
        }
    });

    let pIdx = 0;
    while(App.deck.length > 3) {
        if(App.players[pIdx].hand.length < 17) App.players[pIdx].hand.push(App.deck.pop());
        pIdx = (pIdx + 1) % 3;
        if(App.players.every(p => p.hand.length >= 17)) break;
    }
    App.players.forEach(p => p.hand.sort((a,b)=>getDDZAbs(b)-getDDZAbs(a)));
    renderHand(); updateOpponentVisuals();
    App.turn = Math.floor(Math.random()*3);
    setStatus("BIDDING...");
    setTimeout(() => ddzBidPhase(0, 0), 1000);
}

function ddzBidPhase(currentMax, passCount) {
    if(passCount === 3 && currentMax === 0) { startDDZ(); return; } 
    if(ddzBidScore === 3 || (passCount === 2 && currentMax > 0)) { ddzSetLandlord(ddzLandlordIdx); return; } 
    const pIdx = App.turn; const p = App.players[pIdx];
    document.querySelectorAll('.seat').forEach(s => s.classList.remove('active'));
    if(pIdx < 2) document.getElementById(`seat-${pIdx}`).classList.add('active'); 

    if(p.isUser) {
        const bids = [1, 2, 3].filter(v => v > currentMax);
        const ctrls = document.getElementById('controls'); ctrls.innerHTML = '';
        bids.forEach(v => {
            const btn = document.createElement('button'); btn.className = 'btn-act show'; btn.innerText = `${v} åˆ†`;
            btn.onclick = () => { hideControls(); ddzBidAction(pIdx, v); }; ctrls.appendChild(btn);
        });
        const passBtn = document.createElement('button'); passBtn.className = 'btn-act btn-pass show'; passBtn.innerText = "ä¸å«";
        passBtn.onclick = () => { hideControls(); ddzBidAction(pIdx, 0); }; ctrls.appendChild(passBtn);
        setStatus("YOUR BID");
    } else {
        setTimeout(() => {
            let score = 0; const h = p.hand;
            // AI å«åˆ†é‚è¼¯
            const style = getAIStyle(p.char.id);
            let threshold = (style === 'aggressive') ? 1 : (style === 'conservative' ? 2 : 1.5);
            
            if(h.some(c=>c.r==='S') && h.some(c=>c.r==='B')) score = 3;
            else { 
                const twoCnt = h.filter(c=>c.r==='2').length; 
                const jokerCnt = h.filter(c=>c.r==='S'||c.r==='B').length;
                let power = twoCnt + jokerCnt;
                if(power >= 3) score = 3;
                else if(power >= threshold) score = 2;
                else if(power >= 1) score = 1;
            }
            // ç©æ¥µå‹æ›´æœ‰æ©Ÿç‡æ¶
            if (style === 'aggressive' && Math.random() > 0.4 && score < 3) score++;

            if(score > currentMax) ddzBidAction(pIdx, score); else ddzBidAction(pIdx, 0);
        }, 1000);
    }
}

function ddzBidAction(pIdx, val) {
    if(val > 0) {
        ddzLandlordIdx = pIdx; ddzBidScore = val; say(pIdx, 'doudizhu_bid');
        setStatus(`${App.players[pIdx].isUser ? "YOU" : App.players[pIdx].char.name} BID ${val}`);
        App.turn = (App.turn + 1) % 3;
        if(val === 3) ddzSetLandlord(pIdx); else ddzBidPhase(val, 0);
    } else {
        // å¦‚æœæ²’æœ‰å®šç¾© doudizhu_bid èªéŸ³ï¼Œå¯èƒ½æœƒæ²’è²éŸ³ï¼Œé€™è£¡å¯ä»¥åŠ å¼·
        say(pIdx, 'doudizhu_bid'); 
        App.turn = (App.turn + 1) % 3;
        ddzBidPhase(ddzBidScore, ddzBidScore > 0 ? 2 : 3);
    }
}

function ddzSetLandlord(idx) {
    App.turn = idx; const kitty = App.deck; 
    App.players[idx].hand.push(...kitty); App.players[idx].hand.sort((a,b)=>getDDZAbs(b)-getDDZAbs(a));
    App.players.forEach((p, i) => { p.role = (i === idx) ? 'landlord' : 'peasant'; });
    const kz = document.getElementById('ddz-kitty');
    kz.style.display = 'flex'; kz.innerHTML = kitty.map(c => `<div class="kitty-card" style="color:${['â™¥','â™¦'].includes(c.s)?'red':'black'}">${c.r}</div>`).join('');
    setStatus(`LANDLORD: P${idx}`); updateOpponentVisuals(); if(App.players.find(p=>p.isUser).role === 'landlord') renderHand(); 
    if(App.players[idx].char && App.players[idx].char.id === 'xiaomu') { triggerSkill(idx, App.players[idx].char.skills.doudizhu); alert("å°ç›®ç™¼å‹•è³‡æœ¬é‹ä½œï¼"); }
    App.table = []; setTimeout(ddzTurn, 1500);
}

function ddzTurn() {
    const winner = App.players.find(p => p.hand.length === 0);
    if(winner) { const userWin = (winner.role === App.players.find(p=>p.isUser).role); showResult(userWin, userWin ? ddzBidScore*100*ddzMulti : -ddzBidScore*100*ddzMulti, winner.role.toUpperCase() + " WINS!"); return; }
    
    const pIdx = App.turn; const p = App.players[pIdx];
    document.querySelectorAll('.seat').forEach(s => s.classList.remove('active')); if(!p.isUser) document.getElementById(`seat-${pIdx}`).classList.add('active');
    const topObj = App.table.length > 0 ? App.table[App.table.length-1] : null;
    const isFree = (!topObj || topObj.owner === pIdx);

    if(p.isUser) {
        setStatus(isFree ? "YOUR TURN (Free)" : "YOUR TURN");
        setControls("PLAY", "PASS", ()=>ddzUserPlay(isFree, topObj), isFree ? null : ()=>ddzUserPass());
        document.getElementById('btn-pass').style.display = isFree ? 'none' : 'block';
    } else {
        setStatus(`${p.char.name} thinking...`);
        setTimeout(() => {
            let playCards = ddzAIDecide(pIdx, topObj);
            
            // æŠ€èƒ½ï¼šæµ·ç¥çµ¦ç‰Œé‚è¼¯ (ç°¡å–®ç‰ˆ)
            if(p.char.id === 'poseidon' && p.role === 'peasant') {
                 // æµ·ç¥ç‰¹æ®Šé‚è¼¯å¯åœ¨æ­¤æ“´å……
            }

            if(playCards) {
                // --- å‡ºç‰Œ ---
                p.hand = p.hand.filter(c => !playCards.includes(c));
                App.table.push({cards:playCards, owner:pIdx, role:p.role});
                const info = ddzAnalyze(playCards);
                if(info.type === DDZ.TYPES.BOMB || info.type === DDZ.TYPES.ROCKET) { ddzMulti *= 2; sfx('sfx-win'); alert("å€ç‡ç¿»å€ï¼ x" + ddzMulti); }
                renderTable(playCards); sfx('sfx-card'); 
                
                // å‡ºç‰Œå°è©
                say(pIdx, 'play');
                if(p.hand.length <= 2) say(pIdx, 'win');
                updateOpponentVisuals(); App.turn = (App.turn + 1) % 3; ddzTurn();

            } else {
                // --- Pass (ä¿®å¾©å°è©é‚è¼¯) ---
                // å…ˆå˜—è©¦è§¸ç™¼è§’è‰²è¨­å®šçš„ pass å°è©
                if (p.char.lines.doudizhu_pass) {
                    say(pIdx, 'doudizhu_pass');
                } else {
                    // å¦‚æœæ²’æœ‰è¨­å®šï¼Œä½¿ç”¨é€šç”¨å°è©
                    const bubble = document.querySelector(`#seat-${pIdx} .bubble`);
                    if(bubble) {
                        bubble.innerText = getGenericPassLine(p.char);
                        bubble.classList.add('show');
                        setTimeout(() => bubble.classList.remove('show'), 2000);
                    }
                }
                
                // å¢åŠ ä¸€é»å»¶é²è®“ç©å®¶çœ‹åˆ° "Pass"
                setTimeout(() => {
                    updateOpponentVisuals(); 
                    App.turn = (App.turn + 1) % 3; 
                    ddzTurn();
                }, 1000); // Pass å¾Œç­‰å¾… 1 ç§’
            }
        }, 1000 + Math.random()*500);
    }
}

function ddzUserPlay(isFree, topObj) {
    const user = App.players.find(p=>p.isUser); const userIdx = App.players.indexOf(user);
    const sel = user.hand.filter(c=>c.sel); if(sel.length===0) return;
    const info = ddzAnalyze(sel); if(!info) { alert("ç„¡æ•ˆç‰Œå‹ï¼"); return; }
    if(!isFree) { const topInfo = ddzAnalyze(topObj.cards); if(!ddzCanBeat(info, topInfo)) { alert("æ‰“ä¸éï¼"); return; } }
    
    user.hand = user.hand.filter(c=>!c.sel);
    App.table.push({cards:sel, owner:userIdx, role:user.role});
    if(info.type === DDZ.TYPES.BOMB || info.type === DDZ.TYPES.ROCKET) { ddzMulti *= 2; sfx('sfx-win'); }
    renderTable(sel); renderHand(); hideControls(); sfx('sfx-card');
    App.turn = (userIdx + 1) % 3; setTimeout(ddzTurn, 500);
}

function ddzUserPass() { 
    const uIdx = App.players.findIndex(p=>p.isUser); 
    hideControls(); 
    // ç©å®¶ Pass æ™‚ä¹Ÿå¯ä»¥é¡¯ç¤ºæ°£æ³¡ (é¸ç”¨)
    const bubble = document.querySelector(`#seat-1 .bubble`); // å‡è¨­ç©å®¶åœ¨ä¸­é–“æˆ–ä¸‹æ–¹
    // say(uIdx, 'lose'); // ç©å®¶é€šå¸¸ä¸èªªè©±ï¼Œæˆ–å¯è‡ªè¡Œæ·»åŠ 
    App.turn = (uIdx + 1) % 3; ddzTurn(); 
}

/* --- UNO ENGINE (CHATTERBOX UPDATE) --- */
function startUNO() { 
    App.deck = createUnoDeck(); 
    App.players.forEach(p => { p.hand = []; p.unoSaid = false; p.vulnerable = false; }); 
    distributeSkillCards(); 
    let first = App.deck.pop(); while(first.type === 'wild' || first.type === 'wild4') { App.deck.unshift(first); first = App.deck.pop(); } 
    App.table = [first]; App.turn = Math.floor(Math.random()*4); App.direction = 1; 
    renderHand(); renderTable([first]); updateOpponentVisuals(); setStatus("UNO START!"); setTimeout(unoTurn, 1500); 
}
function unoTurn() { 
    const winners = App.players.filter(p => p.hand.length === 0); 
    if(winners.length > 0) { const userWon = winners[0].isUser; setTimeout(() => showResult(userWon, userWon ? 3000 : -1000, userWon ? "UNO VICTORY!" : "UNO DEFEAT"), 1000); return; } 
    const pIdx = App.turn; const p = App.players[pIdx]; const top = App.table[App.table.length - 1]; 
    document.querySelectorAll('.seat').forEach(s=>s.classList.remove('active')); if(pIdx < 3) document.getElementById(`seat-${pIdx}`).classList.add('active'); 
    
    if(App.unoStack > 0) { setTimeout(() => unoAcceptPenalty(pIdx), 1000); return; } 
    
    if(p.isUser) { 
        setStatus("YOUR TURN"); 
        const playable = p.hand.filter(c => unoCheck(c, top)); 
        const ctrls = document.getElementById('controls'); ctrls.innerHTML = ''; 
        if(playable.length === 0) { const btnDraw = document.createElement('button'); btnDraw.className = 'btn-act show'; btnDraw.innerText = "DRAW"; btnDraw.onclick = () => unoDraw(pIdx); ctrls.appendChild(btnDraw); } 
    } else { 
        setStatus(`${p.char.name}'s TURN`); 
        if(p.char.id === 'hades') p.unoSaid = true;
        setTimeout(() => { 
            const playable = p.hand.filter(c => unoCheck(c, top)); 
            if(playable.length > 0) { 
                const playCard = playable[0]; 
                if(playCard.color === 'black') playCard.tempColor = ['red','yellow','green','blue'][Math.floor(Math.random()*4)];
                p.hand = p.hand.filter(c => c !== playCard); unoExecute(pIdx, playCard); 
            } else { unoDraw(pIdx); } 
        }, 1200); 
    } 
}
function unoAcceptPenalty(pIdx) { 
    hideControls(); const p = App.players[pIdx]; let count = App.unoStack; 
    if(p.char && p.char.id === 'venato' && Math.random() < 0.3) { 
        triggerSkill(pIdx, p.char.skills.uno); App.turn = getNextIdx(); setTimeout(() => unoTurn(), 1000); return;
    }
    if(p.char && p.char.id === 'mollie') { count = 1; triggerSkill(pIdx, p.char.skills.uno); }
    if(p.char && p.char.id === 'miras') { count = Math.floor(count/2); triggerSkill(pIdx, p.char.skills.uno); }
    if(p.char && p.char.id === 'lynn') { count = Math.max(0, count-1); triggerSkill(pIdx, p.char.skills.uno); }
    
    App.unoStack = 0; if(count > 0) say(pIdx, 'uno_hit'); // â˜… å¼·åˆ¶èªªè©±
    let dLoop = 0; const deal = () => { 
        if(dLoop >= count) { p.unoSaid = false; updateOpponentVisuals(); setTimeout(unoNextTurn, 800); return; } 
        if(App.deck.length === 0) refillUnoDeck(); if(App.deck.length > 0) p.hand.push(App.deck.pop()); 
        dLoop++; if(p.isUser) renderHand(); else updateOpponentVisuals(); setTimeout(deal, 150); 
    }; deal(); 
}
function userShoutUno() {
    const p = App.players.find(p=>p.isUser); if (p.hand.length <= 2 && !p.unoSaid) { p.unoSaid = true; p.vulnerable = false; sfx('sfx-win'); setStatus("YOU SHOUTED UNO!"); document.getElementById('player-badge').classList.add('show'); updateOpponentVisuals(); }
}
function onSeatClick(targetIdx) { 
    if(App.gameId !== 'uno') return; const target = App.players[targetIdx]; const seat = document.getElementById(`seat-${targetIdx}`); seat.classList.add('shake'); setTimeout(() => seat.classList.remove('shake'), 400);
    if(target.hand.length === 1 && !target.unoSaid) { catchPlayer(targetIdx, 3); } else { if(target.unoSaid) say(targetIdx, 'uno_poke_late'); else say(targetIdx, 'uno_poke_early'); }
}
function catchPlayer(victimIdx, catcherIdx) { 
    const victim = App.players[victimIdx]; 
    if(victim.char && (victim.char.id==='jonona'||victim.char.id==='costa') && Math.random()>0.5) { 
        triggerSkill(victimIdx, victim.char.skills.uno); victim.unoSaid = true; victim.vulnerable = false; say(victimIdx, 'uno_late'); updateOpponentVisuals(); return; 
    } 
    if(victim.vulnerable || (victim.hand.length===1 && !victim.unoSaid && victim.char.id!=='hades')) { 
        victim.vulnerable = false; 
        setTimeout(() => { 
            say(victimIdx, 'uno_forgot'); if(App.deck.length < 2) refillUnoDeck(); 
            victim.hand.push(App.deck.pop()); if(App.deck.length > 0) victim.hand.push(App.deck.pop()); 
            victim.unoSaid = false; if(victim.isUser) renderHand(); else updateOpponentVisuals(); 
        }, 1000); 
    } 
}
function unoUserClick(c) { 
    if(App.gameId !== 'uno' || App.turn !== App.players.length-1) return; const top = App.table[App.table.length - 1]; 
    if(App.unoStack > 0) { setTimeout(()=>unoAcceptPenalty(App.players.length-1), 500); return; }
    const user = App.players.find(p=>p.isUser);
    if(unoCheck(c, top)) { if(c.color === 'black') showColorPick(c); else { user.hand = user.hand.filter(x => x !== c); unoExecute(App.players.length-1, c); } } else setStatus("CANNOT PLAY"); 
}
function showColorPick(c) { const ctrls = document.getElementById('controls'); ctrls.innerHTML = ''; ['red', 'yellow', 'green', 'blue'].forEach(col => { const btn = document.createElement('button'); btn.className = `btn-act btn-color btn-${col} show`; btn.innerText = col.toUpperCase(); btn.onclick = () => { c.tempColor = col; const user=App.players.find(p=>p.isUser); user.hand = user.hand.filter(x => x !== c); unoExecute(App.players.length-1, c); }; ctrls.appendChild(btn); }); }
function unoCheck(c, top) { if(c.color === 'black') return true; if(c.color === (top.tempColor || top.color)) return true; if(c.val === top.val) return true; return false; }

function unoExecute(pIdx, c) { 
    const p = App.players[pIdx]; 
    if(p.hand.length === 1) { 
        if(p.isUser) { if(!p.unoSaid) p.vulnerable = true; } 
        else { if(Math.random() < p.char.uno_shout_rate) { p.unoSaid = true; say(pIdx, 'uno_uno'); } else { p.vulnerable=true; setTimeout(()=>{if(p.vulnerable && p.hand.length===1){p.unoSaid=true; p.vulnerable=false; say(pIdx,'uno_late'); updateOpponentVisuals();}}, 3000); } } 
    } else { p.unoSaid = false; p.vulnerable = false; } 
    App.table.push(c); renderTable([c]); sfx('sfx-card'); if(p.isUser) { renderHand(); hideControls(); } else { updateOpponentVisuals(); } 
    
    if(p.char && p.char.id==='xiaomu' && c.color==='black') { triggerSkill(pIdx, p.char.skills.uno); }
    if(p.char && p.char.id==='poseidon' && c.type==='wild4') { triggerSkill(pIdx, p.char.skills.uno); alert("æµ·ç¥ï¼šå¤§æµ·å˜¯ï¼"); }

    let skip = false; 
    if(c.type === 'draw2') { App.unoStack += 2; }
    if(c.type === 'wild4') { App.unoStack += 4; }
    if(App.unoStack > 0) { setTimeout(unoNextTurn, 1000); return; }

    if(c.type === 'skip') { skip = true; say(pIdx, 'uno_attack'); } 
    if(c.type === 'reverse') { 
        if(App.players.length === 2) skip = true; else App.direction *= -1; 
        say(pIdx, 'play');
    } else {
        say(pIdx, 'play'); // â˜… å¼·åˆ¶èªªè©±
    }
    
    if(p.char && p.char.id==='narcissus' && c.type==='reverse') { triggerSkill(pIdx, p.char.skills.uno); skip = true; }

    if(skip) { 
        const victimIdx = getNextIdx(); const victim = App.players[victimIdx];
        if(!victim.isUser && victim.char.id==='peter' && Math.random()>0.5) { triggerSkill(victimIdx, victim.char.skills.uno); App.turn = victimIdx; setTimeout(unoTurn, 1000); } 
        else { setTimeout(() => say(victimIdx, 'uno_skip'), 500); App.turn = getNextIdx(); setTimeout(unoNextTurn, 1500); } 
    } else { setTimeout(unoNextTurn, 1000); } 
}
function unoNextTurn() { App.turn = getNextIdx(); unoTurn(); }
function getNextIdx() { return (App.turn + App.direction + App.players.length) % App.players.length; }
function unoDraw(pIdx) { 
    const p = App.players[pIdx]; const top = App.table[App.table.length - 1]; 
    if(App.deck.length === 0) refillUnoDeck(); 
    const c = App.deck.pop(); p.hand.push(c); sfx('sfx-card'); 
    
    if(p.isUser) { renderHand(); hideControls(); if(unoCheck(c, top)) unoUserClick(c); else { say(pIdx, 'uno_hit'); setTimeout(unoNextTurn, 800); } }
    else { updateOpponentVisuals(); if(unoCheck(c, top)) { if(c.color==='black') c.tempColor='red'; unoExecute(pIdx, c); } else { say(pIdx, 'uno_draw_many'); setTimeout(unoNextTurn, 800); } }
}
function refillUnoDeck() { if(App.table.length <= 1) return; const top = App.table.pop(); const leftovers = App.table; App.table = [top]; leftovers.forEach(c => delete c.tempColor); App.deck = leftovers.sort(() => Math.random() - 0.5); }
function createUnoDeck() { const colors = ['red', 'yellow', 'green', 'blue']; const deck = []; colors.forEach(col => { deck.push({color:col, val:'0', type:'num'}); for(let i=1; i<=9; i++) { deck.push({color:col, val:i+'', type:'num'}); deck.push({color:col, val:i+'', type:'num'}); } ['skip', 'reverse', 'draw2'].forEach(t => { deck.push({color:col, val:t, type:t}); deck.push({color:col, val:t, type:t}); }); }); for(let i=0; i<4; i++) { deck.push({color:'black', val:'W', type:'wild'}); deck.push({color:'black', val:'+4', type:'wild4'}); } return deck.sort(() => Math.random() - 0.5); }

/* --- BIG 2 ENGINE --- */
let kleionDuel = false; let peterCurse = false;
const B2 = { TYPES: { INVALID:0, SINGLE:1, PAIR:2, FULLHOUSE:3, IRON:4, FLUSH_STR:5 }, RANKS: ['3','4','5','6','7','8','9','10','J','Q','K','A','2'], SUITS: ['â™£','â™¦','â™¥','â™ '] };
function getRankVal(r) { return B2.RANKS.indexOf(r); }
function getSuitVal(s) { return B2.SUITS.indexOf(s); }
function getAbsVal(c) { return getRankVal(c.r) * 4 + getSuitVal(c.s); }

function b2Analyze(cards) {
    if(!cards || cards.length === 0) return null;
    const s = [...cards].sort((a,b) => getAbsVal(a) - getAbsVal(b));
    const len = s.length; const r = s.map(c => getRankVal(c.r)); const maxCard = s[len-1];
    if(len === 1) return { type: B2.TYPES.SINGLE, val: getAbsVal(maxCard), cards: s, max: maxCard };
    if(len === 2) { return (r[0] === r[1]) ? { type: B2.TYPES.PAIR, val: getAbsVal(maxCard), cards: s, max: maxCard } : { type: B2.TYPES.INVALID }; }
    if(len === 3 || len === 4) return { type: B2.TYPES.INVALID };
    if(len === 5) {
        const counts = {}; r.forEach(x => counts[x] = (counts[x]||0)+1); const v = Object.values(counts);
        const isFlush = s.every(c => c.s === s[0].s); let isStraight = true; for(let i=0; i<4; i++) { if(r[i+1] !== r[i]+1) isStraight = false; }
        if(isFlush && isStraight) return { type: B2.TYPES.FLUSH_STR, val: getAbsVal(maxCard), cards: s };
        if(v.includes(4)) { const q = parseInt(Object.keys(counts).find(k=>counts[k]===4)); return { type: B2.TYPES.IRON, val: q, cards: s }; }
        if(v.includes(3) && v.includes(2)) { const t = parseInt(Object.keys(counts).find(k=>counts[k]===3)); return { type: B2.TYPES.FULLHOUSE, val: t, cards: s }; }
    }
    return { type: B2.TYPES.INVALID };
}

function b2CheckWin(my, top) {
    if(!my || my.type === B2.TYPES.INVALID) return false;
    if(!top) return true;
    if(my.type >= B2.TYPES.FULLHOUSE) {
        if(top.type >= B2.TYPES.FULLHOUSE) {
            if(my.type > top.type) return true; if(my.type < top.type) return false; return my.val > top.val;
        }
        return false; 
    }
    if(my.type !== top.type) return false; return my.val > top.val;
}

function b2AI_AnalyzeHandStructure(hand) {
    const sorted = [...hand].sort((a,b) => getAbsVal(a) - getAbsVal(b));
    const lockedCards = new Set(); const monsters = [];
    for(let i=0; i<=sorted.length-5; i++) { const chunk = sorted.slice(i, i+5); const info = b2Analyze(chunk); if(info.type === B2.TYPES.FLUSH_STR) { monsters.push(info); chunk.forEach(c => lockedCards.add(c)); } }
    const map = {}; sorted.forEach(c => { if(!lockedCards.has(c)) { if(!map[c.r]) map[c.r]=[]; map[c.r].push(c); } });
    Object.values(map).filter(arr => arr.length === 4).forEach(quad => {
        quad.forEach(c => lockedCards.add(c)); const kicker = sorted.find(c => !lockedCards.has(c) && !quad.includes(c));
        if(kicker) monsters.push({ type: B2.TYPES.IRON, val: getRankVal(quad[0].r), cards: [...quad, kicker] });
    });
    return { lockedCards, monsters };
}

function b2AIDecide(pIdx, topCards) {
    const p = App.players[pIdx]; const hand = [...p.hand].sort((a,b) => getAbsVal(a) - getAbsVal(b)); const charId = p.char.id;
    const isFree = (App.isFirstTurn || App.lastWinner === pIdx);
    const topInfo = isFree ? null : b2Analyze(topCards.cards);
    
    const isSmart = ['peter', 'venato', 'aura', 'xiaomu'].includes(charId);
    const isAggro = ['lanlan', 'kleion', 'poseidon', 'novian'].includes(charId);
    const isConservative = ['jonona', 'mollie', 'lynn', 'costa'].includes(charId);

    const structure = b2AI_AnalyzeHandStructure(hand); const lockedSet = structure.lockedCards;
    let moves = [];
    hand.forEach(c => moves.push({cards:[c]}));
    for(let i=0; i<hand.length-1; i++) { if(hand[i].r === hand[i+1].r) moves.push({cards:[hand[i], hand[i+1]]}); }
    structure.monsters.forEach(m => moves.push({cards: m.cards}));
    const map = {}; hand.forEach(c => { if(!lockedSet.has(c)) { map[c.r] = (map[c.r]||[]).concat(c); } });
    const trips = Object.values(map).filter(arr=>arr.length===3); const pairs = Object.values(map).filter(arr=>arr.length>=2);
    trips.forEach(t => { const pair = pairs.find(pa => pa[0].r !== t[0].r); if(pair) moves.push({cards: [...t, ...pair.slice(0,2)]}); });

    let validMoves = moves.filter(m => {
        const myInfo = b2Analyze(m.cards); if(!myInfo || myInfo.type === B2.TYPES.INVALID) return false;
        if(App.isFirstTurn) return m.cards.some(c => c.s==='â™£' && c.r==='3');
        if(kleionDuel && m.cards.length !== 1) return false; if(peterCurse && m.cards.length === 2) return false;
        if(charId==='lanlan' && myInfo.type===B2.TYPES.SINGLE && topInfo && topInfo.type===B2.TYPES.SINGLE) {
            if(myInfo.cards[0].r==='3' && myInfo.cards[0].s==='â™¦' && getRankVal(topInfo.max)===12) return true;
        }
        return b2CheckWin(myInfo, topInfo);
    });

    if(validMoves.length === 0) return null;
    validMoves.sort((a,b) => b2Analyze(a.cards).val - b2Analyze(b.cards).val);

    if(isFree) {
        if(App.isFirstTurn) { const c3 = validMoves.find(m => m.cards.some(c=>c.s==='â™£'&&c.r==='3')); return c3 ? c3.cards : validMoves[0].cards; }
        if(isSmart && structure.monsters.length > 0) {
            const smallMoves = validMoves.filter(m => b2Analyze(m.cards).type < B2.TYPES.IRON);
            if(smallMoves.length > 0) return smallMoves[0].cards;
        }
        if(isAggro) { const monster = validMoves.find(m => b2Analyze(m.cards).type >= B2.TYPES.IRON); if(monster) return monster.cards; }
        if(isSmart && hand.length === 2) {
            const bigCard = hand[1]; if(getRankVal(bigCard.r) >= 11) { 
                const playBig = validMoves.find(m => m.cards.length===1 && m.cards[0]===bigCard); if(playBig) return playBig.cards;
            }
        }
        return validMoves[0].cards; 
    }

    if(topInfo && topInfo.type >= B2.TYPES.FULLHOUSE) {
        const killer = validMoves.find(m => { const inf = b2Analyze(m.cards); return inf.type >= B2.TYPES.IRON && b2CheckWin(inf, topInfo); });
        if(killer && (isAggro || isSmart)) return killer.cards; 
    }
    if(isSmart && topInfo && topInfo.type === B2.TYPES.SINGLE && topInfo.val < 30) {
        const best = validMoves[0]; const info = b2Analyze(best.cards);
        if(getRankVal(info.max) >= 11 && hand.length > 5 && Math.random() < 0.5) return null;
    }
    return validMoves[0].cards;
}

function startB2() {
    App.deck = createDeck(); App.players.forEach(p => p.hand=[]);
    while(App.deck.length > 0) { for(let i=0; i<4; i++) if(App.deck.length) App.players[i].hand.push(App.deck.pop()); }
    
    const xm = App.players.find(x => x.char && x.char.id === 'xiaomu'); const u = App.players[3];
    if(xm && !xm.isUser && u.hand.some(c => c.r==='2')) {
        const idx = u.hand.findIndex(c => c.r==='2'); xm.hand.push(u.hand.splice(idx,1)[0]); u.hand.push(xm.hand.shift()); 
        triggerSkill(App.players.indexOf(xm), xm.char.skills.bigtwo);
    }
    distributeSkillCards(); 

    const laz = App.players.find(x => x.char && x.char.id === 'lazar');
    if(laz && u.hand.some(c => c.r==='2')) {
        setTimeout(()=>{
            triggerSkill(App.players.indexOf(laz), laz.char.skills.bigtwo); alert("æ‹‰æ‰çˆ¾ç™¼ç¾ä½ æœ‰2ï¼é‡æ´—ä½ çš„æ‰‹ç‰Œï¼");
            u.hand.push(...createDeck().slice(0, u.hand.length)); u.hand.splice(0, u.hand.length/2); renderHand();
        }, 800);
    }

    App.table = []; let start = -1;
    App.players.forEach((p,i) => { p.hand.sort((a,b)=>getAbsVal(a)-getAbsVal(b)); if(p.hand.some(c=>c.s==='â™£'&&c.r==='3')) start=i; });
    if(start === -1) { start=0; App.players[0].hand[0] = {s:'â™£',r:'3',val:0}; }
    App.turn = start; App.lastWinner = start; App.isFirstTurn = true; kleionDuel = false; peterCurse = false;
    renderHand(); updateOpponentVisuals(); setStatus("BIG 2 START!"); setTimeout(b2Turn, 1500);
}

function b2Turn() {
    const winnerIdx = App.players.findIndex(p => p.hand.length === 0);
    if(winnerIdx !== -1) { const isUser = (winnerIdx === 3); setTimeout(() => showResult(isUser, isUser?2000:-500, isUser?"BIG 2 KING!":"LOSE..."), 500); return; }
    const pIdx = App.turn; const p = App.players[pIdx];
    document.querySelectorAll('.seat').forEach(s => s.classList.remove('active')); if(pIdx < 3) document.getElementById(`seat-${pIdx}`).classList.add('active');
    
    const isFree = (App.isFirstTurn || App.lastWinner === pIdx);
    const topObj = App.table.length > 0 ? App.table[App.table.length-1] : null;

    if(!p.isUser && p.char.id==='miras' && !p.swapped && p.hand.length<=5) {
        triggerSkill(pIdx, p.char.skills.bigtwo); p.swapped = true;
        setTimeout(()=>{
            const u = App.players[3]; if(u.hand.length>2) { p.hand.push(u.hand.pop(), u.hand.pop()); u.hand.push(p.hand.shift(), p.hand.shift()); }
            alert("èœœæ‹‰æ€ç™¼å‹•æ‰‹ç‰Œäº¤æ›ï¼"); renderHand(); updateOpponentVisuals(); b2Turn();
        }, 1000); return;
    }

    if(p.isUser) {
        setStatus(isFree ? "YOUR TURN (Free)" : "YOUR TURN");
        setControls("PLAY", "PASS", ()=>b2UserPlay(isFree, topObj), (isFree || App.isFirstTurn) ? null : ()=>b2UserPass());
        document.getElementById('btn-pass').style.display = (isFree || App.isFirstTurn) ? 'none' : 'block';
    } else {
        setStatus(`${p.char.name} is thinking...`);
        setTimeout(() => {
            let playCards = b2AIDecide(pIdx, topObj);
            if(isFree && (!playCards || playCards.length===0)) playCards = [p.hand[0]];

            if(playCards) {
                p.hand = p.hand.filter(c => !playCards.includes(c));
                App.table.push({cards:playCards, owner:pIdx});
                App.lastWinner = pIdx; 
                renderTable(playCards); sfx('sfx-card'); say(pIdx, 'play');
                if(App.isFirstTurn) App.isFirstTurn = false;

                if(p.char.id==='kleion' && playCards.length===1) { kleionDuel=true; triggerSkill(pIdx, p.char.skills.bigtwo); } else kleionDuel=false;
                if(p.char.id==='costa' && topObj && !isFree) {
                     const myT = b2Analyze(playCards); const topT = b2Analyze(topObj.cards);
                     if(myT.type===topT.type && playCards[0].s===topObj.cards[0].s) {
                         triggerSkill(pIdx, p.char.skills.bigtwo); if((App.turn+1)%4===3) alert("ç§‘çµ²å¡”æ¨¡ä»¿ï¼æš«åœï¼"); App.turn = (App.turn+1)%4; 
                     }
                }
                if(p.char.id==='mollie' && !p.mollieUsed && playCards.length===1) {
                    if(getRankVal(playCards[0].r)>=11 && p.hand.length>0) {
                        p.mollieUsed=true; triggerSkill(pIdx, p.char.skills.bigtwo);
                        const nextP = App.players[(pIdx+1)%4]; nextP.hand.push(playCards[0]); App.table.pop(); renderTable([]);
                        alert(`èŒ‰è‰é€ç‰Œçµ¦ ${nextP.isUser?"ä½ ":nextP.char.name}ï¼`); if(nextP.isUser) renderHand();
                    }
                }
                if(p.char.id==='lynn' && playCards.length===5) {
                    triggerSkill(pIdx, p.char.skills.bigtwo);
                    let minL = 99; let v = null; App.players.forEach((t,ti)=>{if(ti!==pIdx && t.hand.length>0 && t.hand.length<minL){minL=t.hand.length;v=t;}});
                    if(v && App.deck.length>0) { v.hand.push(App.deck.pop()); alert("æ—æ©ç™¼å‹•çµ•æœ›ç¨…æ”¶ï¼æœ‰äººè¢«è¿«æŠ½ç‰Œï¼"); if(v.isUser) renderHand(); }
                }
                if(p.char.id==='narcissus' && playCards.length===1 && (playCards[0].r==='A'||playCards[0].r==='2')) {
                    triggerSkill(pIdx, p.char.skills.bigtwo); App.turn = (App.turn+1)%4;
                }
                if(p.char.id==='novian' && b2Analyze(playCards).type===B2.TYPES.STRAIGHT && p.hand.length>0) {
                    triggerSkill(pIdx, p.char.skills.bigtwo); p.hand.splice(0,1);
                }
                if(p.char.id==='poseidon' && playCards.length===5 && p.hand.length>0) {
                    triggerSkill(pIdx, p.char.skills.bigtwo); p.hand.splice(0,1);
                }

                if(p.hand.length===1) say(pIdx, 'win');
            } else {
                say(pIdx, 'lose');
                if(p.char.id==='peter') { peterCurse=true; triggerSkill(pIdx, p.char.skills.bigtwo); } else peterCurse=false;
            }
            updateOpponentVisuals(); App.turn = (App.turn + 1) % 4; b2Turn();
        }, 1000 + Math.random()*500);
    }
}

function b2UserPlay(isFree, topObj) {
    const sel = App.players[3].hand.filter(c=>c.sel); if(sel.length===0) return;
    const myInfo = b2Analyze(sel); 
    if(!myInfo || myInfo.type === B2.TYPES.INVALID) { alert("ç„¡æ•ˆç‰Œå‹ï¼(åªå…è¨±ï¼šå–®/å°/è‘«/éµ/åŒèŠ±é †)"); return; }
    if(App.isFirstTurn && !sel.some(c=>c.s==='â™£'&&c.r==='3')) { alert("éœ€å‡ºæ¢…èŠ±3"); return; }
    if(kleionDuel && sel.length!==1) { alert("å–®æŒ‘ä¸­ï¼"); return; }
    if(peterCurse && sel.length===2) { alert("è¢«è©›å’’ï¼"); return; }
    if(!isFree) { const topInfo = b2Analyze(topObj.cards); if(!b2CheckWin(myInfo, topInfo)) { alert("å¤ªå°æˆ–ç‰Œå‹ä¸ç¬¦ï¼"); return; } }
    
    App.players[3].hand = App.players[3].hand.filter(c=>!c.sel);
    App.table.push({cards:sel, owner:3}); App.lastWinner = 3;
    renderTable(sel); renderHand(); hideControls(); sfx('sfx-card');
    
    if(App.isFirstTurn) App.isFirstTurn = false;
    kleionDuel=false; peterCurse=false;
    App.turn=0; setTimeout(b2Turn, 500);
}
function b2UserPass() { hideControls(); say(3, 'lose'); App.turn=0; b2Turn(); }

/* --- OTHER GAMES --- */
function startRB() { updateScore(-500); document.getElementById('table-cards').innerHTML = ''; setStatus("RED OR BLACK?"); setControls("RED", "BLACK", ()=>resRB('red'), ()=>resRB('black')); }
function resRB(pick) { hideControls(); const isRed = Math.random()>0.5; const s=isRed?(Math.random()>.5?'â™¥':'â™¦'):'â™ '; const r=['A','K','Q','J'][Math.floor(Math.random()*4)]; renderTable([{s,r}]); sfx('sfx-card'); const win=(pick==='red'&&isRed)||(pick==='black'&&!isRed); setTimeout(()=>{if(win){say(0,'lose');showResult(true,1000);}else{say(0,'win');showResult(false,-500);}},1000); }

function startBJ() { 
    updateScore(-500); App.deck = createDeck(); 
    App.players[0].hand = [App.deck.pop(), App.deck.pop()]; // Dealer
    App.players[1].hand = [App.deck.pop(), App.deck.pop()]; // User (Index 1)
    renderHand(); updateBJScore(); setStatus("YOUR TURN"); setControls("HIT", "STAND", bjHit, bjStand); 
}
function bjHit() { 
    App.players[1].hand.push(App.deck.pop()); renderHand(); updateBJScore(); sfx('sfx-card'); 
    if(bjVal(App.players[1].hand)>21) { setStatus("BUST!"); setTimeout(()=>showResult(false, -500, "You Busted"), 1000); } 
}
function bjStand() { 
    hideControls(); setStatus("DEALER TURN"); const op = App.players[0]; 
    const loop = () => { 
        const dVal = bjVal(op.hand); document.getElementById('dealer-score').innerText = dVal; document.getElementById('dealer-score').style.display='block'; 
        if(dVal<17) { op.hand.push(App.deck.pop()); setTimeout(loop, 1000); } 
        else { renderTable(op.hand); const uVal = bjVal(App.players[1].hand); setTimeout(() => { if(dVal>21) showResult(true, 1000, "Dealer Bust"); else if(uVal>dVal) showResult(true, 1000); else if(uVal==dVal) showResult('push', 500); else showResult(false, -500); }, 1000); } 
    }; setTimeout(loop, 500); 
}
function bjVal(h) { let s=0,a=0; h.forEach(c=>{ if(['J','Q','K'].includes(c.r))s+=10; else if(c.r==='A'){s+=11;a++;} else s+=parseInt(c.r); }); while(s>21 && a>0){s-=10;a--;} return s; }
function updateBJScore() { const val = bjVal(App.players[1].hand); const el = document.getElementById('bj-score'); el.style.display = 'block'; el.innerText = val; el.style.borderColor = val>21 ? 'red' : 'var(--gold)'; }

function startOM() { 
    let d = createDeck().slice(0,52); d.push({s:'ğŸ¤¡',r:'JK'}); let i=0; 
    while(d.length>0){ App.players[i].hand.push(d.pop()); i=(i+1)%4; } 
    App.players.forEach(p=>cleanPairs(p.hand)); renderHand(); updateOpponentVisuals(); App.turn = 0; setStatus("GAME START"); setTimeout(omTurn, 1500); 
}
function cleanPairs(h) { const m={}; h.forEach(c=>m[c.r]=(m[c.r]||0)+1); for(let r in m){ if(m[r]>=2 && r!=='JK'){ let rem=0; for(let i=h.length-1;i>=0;i--){if(h[i].r===r && rem<2){h.splice(i,1);rem++;}} } } }
function omTurn() { 
    const active = App.players.filter(p=>p.hand.length>0); if(active.length<=1) { const uHas = App.players[3].hand.length>0; setTimeout(() => showResult(!uHas, uHas?-500:2000), 1000); return; } 
    while(App.players[App.turn].hand.length===0) App.turn=(App.turn+1)%4; const pIdx = App.turn; const picker = App.players[pIdx]; 
    let tIdx = (pIdx-1+4)%4; while(App.players[tIdx].hand.length===0) tIdx=(tIdx-1+4)%4; const target = App.players[tIdx]; 
    document.querySelectorAll('.seat').forEach(s=>s.classList.remove('active')); if(pIdx<3) document.getElementById(`seat-${pIdx}`).classList.add('active'); 
    if(picker.isUser) { setStatus("YOUR TURN"); const zone = document.getElementById('table-cards'); zone.innerHTML = ''; target.hand.forEach((c,i)=>{ const el = document.createElement('div'); el.className='card back'; el.onclick = ()=>omUserPick(target, i); zone.appendChild(el); }); } 
    else { setTimeout(()=>{ const r = Math.floor(Math.random()*target.hand.length); const c = target.hand.splice(r,1)[0]; picker.hand.push(c); cleanPairs(picker.hand); updateOpponentVisuals(); if(target.isUser) renderHand(); say(pIdx, 'play'); sfx('sfx-card'); App.turn=(App.turn+1)%4; omTurn(); }, 1200); } 
}
function omUserPick(target, idx) { const c = target.hand.splice(idx,1)[0]; App.players[3].hand.push(c); sfx('sfx-card'); 
document.getElementById('table-cards').innerHTML = '';
 renderTable([c]); cleanPairs(App.players[3].hand); renderHand(); 
 updateOpponentVisuals(); if(c.r==='JK') document.getElementById('msg-large').innerText="JOKER!";
 setTimeout(()=>{ document.getElementById('table-cards').innerHTML = ''; App.turn=(App.turn+1)%4; omTurn(); }, 1000); 
}/* --- LOAN SYSTEM (FIXED) --- */
let loanTarget = null;
let loanStage = 0;

function openLoanScreen() {
    renderLoanList();
    switchScreen('screen-loan');
}
// ä¿®æ­£ï¼šæ”¹ç‚ºè®€å– CHARS å…¨åŸŸè®Šæ•¸ï¼Œè€Œä¸æ˜¯è®€å– App.players
function renderLoanList() {
    const list = document.getElementById('loan-list');
    list.innerHTML = '';
    
    // ç›´æ¥å¾æ‰€æœ‰è§’è‰²è³‡æ–™ä¸­ç¯©é¸å‡ºæœ‰è¨­å®šå€Ÿæ¬¾åŠ‡æƒ…çš„è§’è‰²
    const lenders = CHARS.filter(c => c.loanStages && c.loanStages.length > 0);
    
    if(lenders.length === 0) {
        list.innerHTML = '<div style="color:#666;width:100%;text-align:center;padding:20px;">æš«ç„¡å¯å€Ÿæ¬¾å°è±¡</div>';
        return;
    }

    lenders.forEach(charData => {
        const item = document.createElement('div');
        item.className = 'loan-item';
        item.innerHTML = `
            <img class="loan-avatar-sm" src="${charData.img}">
            <div class="loan-info">
                <div class="loan-name">${charData.name}</div>
                <div class="loan-hint">ä¿¡ç”¨å”å•†</div>
            </div>
        `;
        // å‚³éçš„æ˜¯ charData (è§’è‰²è³‡æ–™ç‰©ä»¶)ï¼Œè€Œä¸æ˜¯ player ç‰©ä»¶
        item.onclick = () => loanNegotiate(charData);
        list.appendChild(item);
    });
}

// ä¿®æ­£ï¼šåƒæ•¸æ¥æ”¶ charData
function loanNegotiate(charData) {
    // æª¢æŸ¥é‡‘éŒ¢é™åˆ¶ (å¤§æ–¼ 500 ä¸èƒ½å€Ÿ)
    if(App.coins > 500) {
        alert("ä½ çš„éŒ¢é‚„å¤ ç”¨ï¼Œåˆ¥è²ªå¿ƒï¼\n(ä½æ–¼ 500 æ‰èƒ½å€Ÿæ¬¾)");
        return;
    }
    loanTarget = charData; // é€™è£¡å­˜çš„æ˜¯è§’è‰²è³‡æ–™
    loanStage = 0;
    showLoanDialog();
}

function showLoanDialog() {
    const m = document.getElementById('modal-loan');
    // ä¿®æ­£ï¼šå› ç‚º loanTarget ç¾åœ¨ç›´æ¥å°±æ˜¯è§’è‰²è³‡æ–™ï¼Œä¸éœ€è¦å† .char
    const charData = loanTarget; 
    const stageData = charData.loanStages[loanStage];
    
    // è¨­å®šé ­åƒèˆ‡åç¨±
    document.getElementById('loan-avatar').src = charData.img;
    
    // è¨­å®šå°è©±å…§å®¹
    const txtEl = document.getElementById('loan-text');
    txtEl.innerText = `"${stageData.text}"`;
    
    // è¨­å®šé¸é …
    const optArea = document.getElementById('loan-options');
    optArea.innerHTML = '';
    
    // å¦‚æœæ˜¯ç²å¾—é‡‘éŒ¢çš„çµå°¾éšæ®µ
    if(stageData.reward) {
        const btn = document.createElement('div');
        btn.className = 'loan-opt';
        btn.innerText = "æ”¶ä¸‹æ¬¾é …";
        btn.onclick = () => {
            updateScore(stageData.reward);
            alert(`å¾ ${charData.name} ç²å¾—äº† ${stageData.reward} ä»£å¹£ï¼`);
            m.style.display = 'none';
            switchScreen('screen-menu');
        };
        optArea.appendChild(btn);
    } 
    // å¦‚æœé‚„æœ‰å°è©±é¸é …
    else if(stageData.opts) {
        stageData.opts.forEach(opt => {
            const btn = document.createElement('div');
            btn.className = 'loan-opt';
            btn.innerText = opt.t;
            btn.onclick = () => {
                if(opt.next === -1) {
                    // æ‹’çµ•/å¤±æ•—
                    if(charData.lines && charData.lines.loan_reject) {
                        const rejPool = charData.lines.loan_reject;
                        txtEl.innerText = `"${rejPool[Math.floor(Math.random()*rejPool.length)]}"`;
                    } else {
                        txtEl.innerText = `"${charData.name} æ‹’çµ•äº†ä½ çš„è«‹æ±‚ã€‚"`;
                    }
                    optArea.innerHTML = `<div class="loan-opt" onclick="document.getElementById('modal-loan').style.display='none'">é›¢é–‹</div>`;
                } else {
                    // ä¸‹ä¸€éšæ®µ
                    loanStage = opt.next;
                    showLoanDialog();
                }
            };
            optArea.appendChild(btn);
        });
    }
    
    m.style.display = 'flex';
}
</script> </body>
</html>